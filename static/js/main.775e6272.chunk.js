(this.webpackJsonpsplitthecost=this.webpackJsonpsplitthecost||[]).push([[0],{222:function(e,t,n){},223:function(e,t,n){},237:function(e,t){},239:function(e,t){},250:function(e,t){},252:function(e,t){},277:function(e,t){},279:function(e,t){},280:function(e,t){},285:function(e,t){},287:function(e,t){},306:function(e,t){},318:function(e,t){},321:function(e,t){},324:function(e,t,n){"use strict";n.r(t);var a,s=n(2),c=n(0),r=n(18),i=n.n(r),l=(n(222),n(7)),o=(n(223),n(10)),u=n(51),d=n.n(u),j=n(75),b=n(78);!function(e){e[e.Unsaved=1]="Unsaved",e[e.Saving=2]="Saving",e[e.Saved=3]="Saved"}(a||(a={}));var O=n(369),h=n(370),m=n(328),x=n(371),f=n(385),p=n(107),v=n.n(p),g=n(102),y=n(384);function N(e){return e.length>=1&&e.length<=20&&/^[a-zA-Z'-\s.()]+$/.test(e)}function S(e){return e.length>=3&&e.length<=41&&/^[0-9a-zA-Z!@#'-\s]+$/.test(e)}function C(e){return e.length>=5&&e.length<=20&&/^[0-9a-zA-Z]+$/.test(e)}function k(e){return e.length>=4&&e.length<=25&&/^[0-9a-zA-Z!@#$?]+$/.test(e)}function w(e,t,n){if(n)return"#dedede";var a=["#AD1457","#F9A825","#1565C0","#4527A0","#D84315","#4E342E","#00838F","#0277BD","#EF6C00","#424242"];return a[t%a.length]}function U(e,t,n){e.key.toLowerCase()===t&&n()}var M=function(e){var t=e.user,n=e.userIdx,a=e.tooltipPlacement,r=e.onClick,i=e.iconOnHover,o=e.disabled,u=e.className,d=Object(c.useState)(!1),j=Object(l.a)(d,2),b=j[0],O=j[1];return Object(s.jsx)(y.a,{className:u,arrow:!0,title:t.displayName,placement:a,onClick:r,children:Object(s.jsx)(f.a,{className:"avatar",style:{backgroundColor:w(0,n,o),cursor:r?"pointer":"default"},children:Object(s.jsx)("span",{onMouseEnter:function(){return O(!0)},onMouseLeave:function(){return O(!1)},children:b&&i||t.initials})})})},I=n(68),D=n(383),E=n(366),P=n(382),T=n(367),B=n(368),A=n(364),L=n(54),F=n.n(L),W=function(e){var t=e.title,n=e.subtitle,a=e.onClose;return Object(s.jsxs)(A.a,{className:"modalTitle",children:[t,n&&Object(s.jsxs)(s.Fragment,{children:[" ","| ",Object(s.jsx)("b",{children:"".concat(n)})]}),a&&Object(s.jsx)(m.a,{className:"modalClose",size:"small",onClick:a,children:Object(s.jsx)(F.a,{})})]})},R=n(386),H=function(e){var t=e.user,n=e.userIdx,a=e.onRemove,c=e.onClick,r=e.className;return Object(s.jsx)("span",{onClick:c&&function(){return c(t)},children:Object(s.jsx)(R.a,{className:"chip ".concat(r," ").concat(c&&"linkCursor"),avatar:Object(s.jsx)(f.a,{className:"smallAvatar",style:{backgroundColor:w(0,n)},children:t.initials}),label:t.displayName,onDelete:a&&function(){return a(t)}},t.id)})},z=function(e){var t=e.open,n=e.setOpen,a=e.entry,r=Object(c.useContext)(et),i=r.sheetState,o=r.sheetDispatch,u=Object(c.useState)(a.exclude),d=Object(l.a)(u,2),j=d[0],b=d[1];function O(){a.exclude!==j&&o({type:"updateExcludedUsers",exclude:j,entry:a}),m()}function h(e){j.includes(e)?b(j.filter((function(t){return t!==e}))):b([].concat(Object(I.a)(j),[e]))}function m(){b(a.exclude),n(!1)}return Object(c.useEffect)((function(){b(a.exclude)}),[a.exclude]),Object(s.jsxs)(D.a,{fullWidth:!0,disableBackdropClick:!0,maxWidth:"xs",onClose:m,open:t,onKeyPress:function(e){return U(e,"enter",O)},PaperProps:{className:"modal"},children:[Object(s.jsx)(W,{title:"Included Friends",subtitle:a.item,onClose:m}),Object(s.jsxs)(E.a,{className:"excludeModalContent",children:[Object(s.jsx)("div",{className:"excludeModalColumn",children:Object.entries(i.users).map((function(e,t){var n=e[1];return t%2===0&&Object(s.jsxs)("div",{className:"excludeModalUser",children:[Object(s.jsx)(P.a,{checked:!j.includes(n.id),color:"primary",onClick:function(){return h(n.id)}}),Object(s.jsx)(H,{user:n,userIdx:Object.keys(i.users).indexOf(n.id),onClick:function(){return h(n.id)}})]},n.id)}))}),Object(s.jsx)("div",{className:"excludeModalColumn",children:Object.entries(i.users).map((function(e,t){var n=e[1];return t%2===1&&Object(s.jsxs)("div",{className:"excludeModalUser",children:[Object(s.jsx)(P.a,{checked:!j.includes(n.id),color:"primary",onClick:function(){return h(n.id)}}),Object(s.jsx)(H,{user:n,userIdx:Object.keys(i.users).indexOf(n.id),onClick:function(){return h(n.id)}})]},n.id)}))})]}),Object(s.jsxs)(T.a,{className:"modalActions",children:[Object(s.jsx)(B.a,{className:"rightMarginSmall",color:"primary",onClick:function(){return b([])},children:"Include All"}),Object(s.jsx)(B.a,{className:"modalConfirmButton rightMarginSmall",onClick:O,children:"Confirm"})]})]})},$=n(66),K=n.n($),G=n(50),Y=n(380),Z=function(e){var t=e.open,n=e.setOpen,a=e.entry,r=Object(c.useContext)(et),i=r.sheetState,o=r.sheetDispatch,u=Object(c.useState)(a.user),d=Object(l.a)(u,2),j=d[0],b=d[1];function O(){j&&j!==a.user&&(o({type:"updateEntry",entry:a,section:"user",value:j}),m())}function h(e){b(e)}function m(){b(a.user),n(!1)}return Object(c.useEffect)((function(){b(a.user)}),[a.user]),Object(s.jsxs)(D.a,{fullWidth:!0,disableBackdropClick:!0,maxWidth:"xs",onClose:m,open:t,onKeyPress:function(e){return U(e,"enter",O)},PaperProps:{className:"modal"},children:[Object(s.jsx)(W,{title:"Who Paid?",subtitle:a.item,onClose:m}),Object(s.jsxs)(E.a,{className:"excludeModalContent",children:[Object(s.jsx)("div",{className:"excludeModalColumn",children:Object.entries(i.users).map((function(e,t){var n=e[1];return t%2===0&&Object(s.jsxs)("div",{className:"excludeModalUser",children:[Object(s.jsx)(Y.a,{checked:j===n.id,onClick:function(){return h(n.id)}}),Object(s.jsx)(H,{user:n,userIdx:Object.keys(i.users).indexOf(n.id),onClick:function(){return h(n.id)}})]},n.id)}))}),Object(s.jsx)("div",{className:"excludeModalColumn",children:Object.entries(i.users).map((function(e,t){var n=e[1];return t%2===1&&Object(s.jsxs)("div",{className:"excludeModalUser",children:[Object(s.jsx)(Y.a,{checked:j===n.id,onClick:function(){return h(n.id)}}),Object(s.jsx)(H,{user:n,userIdx:Object.keys(i.users).indexOf(n.id),onClick:function(){return h(n.id)}})]},n.id)}))})]}),Object(s.jsx)(T.a,{className:"modalActions",children:Object(s.jsx)(B.a,{className:"modalConfirmButton rightMarginSmall",onClick:O,children:"Confirm"})})]})},X=function(e){var t=e.entry,n=e.open,a=e.setOpen,r=Object(c.useContext)(et).sheetDispatch;function i(){a(!1)}function l(){r({type:"removeEntry",entryId:t.id}),a(!1)}return Object(s.jsxs)(D.a,{fullWidth:!0,disableBackdropClick:!0,maxWidth:"xs",onClose:i,open:n,onKeyPress:function(e){return U(e,"enter",l)},PaperProps:{className:"modal"},children:[Object(s.jsx)(W,{title:"Remove Entry",onClose:i}),Object(s.jsxs)(E.a,{children:["Are you sure you want to remove ",Object(s.jsx)("b",{children:t.item})," from this sheet?"]}),Object(s.jsx)(T.a,{className:"modalActions",children:Object(s.jsx)(B.a,{className:"modalConfirmButton rightMarginSmall",onClick:l,children:"Confirm"})})]})},q=function(e){var t=e.entry,n=e.rowIdx,a=Object(c.useContext)(et),r=a.sheetState,i=a.sheetDispatch,o=Object(c.useState)(!t.item&&!t.cost&&!t.note),u=Object(l.a)(o,2),d=u[0],j=u[1],b=Object(c.useState)(!1),p=Object(l.a)(b,2),y=p[0],N=p[1],S=Object(c.useState)(!1),C=Object(l.a)(S,2),k=C[0],w=C[1],U=Object(c.useState)(t.item),I=Object(l.a)(U,2),D=I[0],E=I[1],P=Object(c.useState)(t.note),T=Object(l.a)(P,2),B=T[0],A=T[1],L=Object(c.useState)(!1),F=Object(l.a)(L,2),W=F[0],R=F[1],H=Object(c.useState)(!1),$=Object(l.a)(H,2),Y=$[0],q=$[1],V=Object(c.useState)(!1),J=Object(l.a)(V,2),Q=J[0],_=J[1];function ee(e,n,a){switch(n){case"item":i({type:"updateEntry",entry:t,section:"item",value:e}),j(!D&&!t.cost&&!B);break;case"cost":i({type:"updateEntry",entry:t,section:"cost",value:e,local:a}),j(!D&&!Number(e)&&!B);break;case"note":i({type:"updateEntry",entry:t,section:"note",value:e}),j(!D&&!t.cost&&!B)}}return Object(s.jsxs)(G.b.div,{animate:{x:0,opacity:1},initial:{x:-2e3,opacity:0},transition:{type:"tween",duration:.5},children:[Object(s.jsxs)(O.a,{className:n%2?"lightRow":"darkRow",container:!0,spacing:0,children:[Object(s.jsx)(O.a,{item:!0,xs:3,children:Object(s.jsxs)("div",{className:"entryDiv",onMouseOver:function(){return N(!0)},onMouseLeave:function(){return N(!1)},children:[Object(s.jsx)(M,{className:"leftMargin",user:r.users[t.user],userIdx:Object.keys(r.users).indexOf(r.users[t.user].id),tooltipPlacement:"top",disabled:d,onClick:r.readOnly?void 0:function(){return q(!0)},iconOnHover:Object(s.jsx)(K.a,{})}),Object(s.jsx)(h.a,{className:"sideMargins",disableUnderline:!0,fullWidth:!0,readOnly:r.readOnly,value:D,placeholder:d?"Enter item name here":void 0,onFocus:function(){return j(!1)},onChange:function(e){return E(e.target.value)},onBlur:function(e){ee(e.target.value,"item")}}),!r.readOnly&&y&&Object(s.jsx)(m.a,{className:"iconButton largeIconButton rightMargin",onClick:function(){return _(!0)},children:Object(s.jsx)(v.a,{})})]})}),Object(s.jsx)(O.a,{item:!0,xs:1,children:Object(s.jsx)("div",{className:"entryDiv",children:Object(s.jsx)(h.a,{className:"sideMargins",disableUnderline:!0,fullWidth:!0,readOnly:r.readOnly,value:t.cost.toFixed(2),onFocus:function(){return j(!1)},onChange:function(e){ee(e.target.value,"cost",!0)},onBlur:function(e){ee(e.target.value,"cost")},startAdornment:Object(s.jsx)(x.a,{position:"start",children:"$"}),inputComponent:g.a,inputProps:{decimalScale:2,allowNegative:!1,thousandSeparator:",",allowLeadingZeros:!0}})})}),Object(s.jsx)(O.a,{item:!0,xs:2,children:Object(s.jsxs)("div",{className:"entryDiv",onMouseOver:function(){return w(!0)},onMouseLeave:function(){return w(!1)},children:[t.exclude.map((function(e,n){return n<3?Object(s.jsx)(M,{className:"leftMarginSmall",user:r.users[e],userIdx:Object.keys(r.users).indexOf(r.users[e].id),tooltipPlacement:"top"},e):3===n&&t.exclude.length>n?Object(s.jsx)(f.a,{className:"leftMarginSmall",children:"+".concat(t.exclude.length-3)},e):null})),!r.readOnly&&k&&Object(s.jsx)(m.a,{className:"iconButton largeIconButton leftMarginSmall",onClick:function(){return R(!0)},children:Object(s.jsx)(K.a,{})})]})}),Object(s.jsx)(O.a,{item:!0,xs:6,children:Object(s.jsx)("div",{className:"entryDiv",children:Object(s.jsx)(h.a,{className:"sideMargins",disableUnderline:!0,fullWidth:!0,readOnly:r.readOnly,value:B,placeholder:d?"Include a note here":void 0,onFocus:function(){return j(!1)},onChange:function(e){return A(e.target.value)},onBlur:function(e){ee(e.target.value,"note")}})})})]}),Object(s.jsx)(z,{open:W,setOpen:R,entry:t}),Object(s.jsx)(Z,{open:Y,setOpen:q,entry:t}),Object(s.jsx)(X,{open:Q,setOpen:_,entry:t})]})},V=function(){return Object(s.jsxs)(O.a,{className:"gridHeader",container:!0,spacing:0,children:[Object(s.jsx)(O.a,{item:!0,xs:3,children:Object(s.jsx)("span",{className:"leftMargin",children:"ITEM"})}),Object(s.jsx)(O.a,{item:!0,xs:1,children:Object(s.jsx)("span",{className:"leftMargin",children:"COST"})}),Object(s.jsx)(O.a,{item:!0,xs:2,children:Object(s.jsx)("span",{className:"leftMargin",children:"EXCLUDE"})}),Object(s.jsx)(O.a,{item:!0,xs:6,children:Object(s.jsx)("span",{className:"leftMargin",children:"NOTE"})})]})},J=function(){var e=Object(c.useContext)(jt).userState,t=Object(c.useContext)(et).sheetState,n=0;return Object(s.jsxs)("div",{className:"entries",children:[Object(s.jsx)(V,{}),e.authenticated&&t.entries.map((function(t){var a,c;return(t.user===(null===(a=e.curUser)||void 0===a?void 0:a.id)||t.createdBy===(null===(c=e.curUser)||void 0===c?void 0:c.id)||t.item||t.cost||t.note)&&Object(s.jsx)(q,{entry:t,rowIdx:n++},t.id)}))]})},Q=n(199),_=n.n(Q),ee=n(198),te=n.n(ee),ne=function(e){var t=e.saveState;return Object(s.jsx)("span",{id:"autosaveMessage",children:t===a.Unsaved?Object(s.jsx)(s.Fragment,{}):t===a.Saving?Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(te.a,{fontSize:"small"}),Object(s.jsx)("p",{className:"leftMarginSmall",children:"Saving..."})]}):Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(_.a,{fontSize:"small"}),Object(s.jsx)("p",{className:"leftMarginSmall",children:"Saved to Cloud"})]})})},ae=function(e){var t=e.saveState,n=Object(c.useContext)(et).sheetState;return Object(s.jsx)(O.a,{container:!0,spacing:0,children:Object(s.jsxs)(O.a,{className:"header",item:!0,xs:12,children:[Object(s.jsxs)("span",{className:"leftMargin",children:["split the cost | ",Object(s.jsx)("b",{children:n.title})]}),Object(s.jsx)(ne,{saveState:t})]})})},se=n(378),ce=function(e){var t=e.open,n=e.setOpen,a=Object(c.useContext)(et),r=a.sheetState,i=a.sheetDispatch,o=Object(c.useState)(""),u=Object(l.a)(o,2),d=u[0],j=u[1],b=Object(c.useState)(!0),O=Object(l.a)(b,2),h=O[0],m=O[1],x=Object(c.useState)(""),f=Object(l.a)(x,2),p=f[0],v=f[1],g=Object(c.useState)(!0),y=Object(l.a)(g,2),S=y[0],C=y[1],k=Object(c.useState)(!0),w=Object(l.a)(k,2),M=w[0],I=w[1];function P(){j(""),v(""),m(!0),C(!0),I(!0)}function A(){P(),n(!1)}function L(){r.numUsers>10||!function(e,t){var n=e.trim().toLocaleLowerCase(),a=t.trim().toLocaleLowerCase(),s=N(n),c=N(a);if(m(s),C(c),!s||!c)return!1;var i=!0;return Object.entries(r.users).forEach((function(e){var t=e[1];t.firstName.toLocaleLowerCase()===n&&t.lastName.toLocaleLowerCase()===a&&(i=!1)})),I(i),i}(d,p)||(i({type:"addUser",firstName:d.trim(),lastName:p.trim(),email:""}),P(),n(!1))}return Object(s.jsxs)(D.a,{fullWidth:!0,disableBackdropClick:!0,maxWidth:"xs",onClose:A,open:t,onKeyPress:function(e){return U(e,"enter",L)},PaperProps:{className:"modal"},children:[Object(s.jsx)(W,{title:"Add a Friend",onClose:A}),Object(s.jsx)(E.a,{children:Object(s.jsxs)("div",{className:"modalInputRow",children:[Object(s.jsx)(se.a,{className:"halfWidthModalInput",autoFocus:!0,label:"First Name",value:d,onChange:function(e){return j(e.target.value)},error:!h||!M,helperText:h?!M&&"Duplicate users not allowed.":"Please enter a valid name."}),Object(s.jsx)(se.a,{className:"halfWidthModalInput",label:"Last Name",value:p,onChange:function(e){return v(e.target.value)},error:!S||!M,helperText:S?!M&&"Duplicate users not allowed.":"Please enter a valid name."})]})}),Object(s.jsx)(T.a,{className:"modalActions",children:Object(s.jsx)(B.a,{className:"modalConfirmButton rightMarginSmall",onClick:L,children:"Confirm"})})]})},re=n(108),ie=n.n(re),le=n(372),oe=n(373),ue=n(134),de=(n(229),n(327),ue.a.initializeApp({apiKey:"AIzaSyCdGdwOcnXkNjD7-wLbhWQuXXdn4nUqHc8",authDomain:"split-the-cost-176bf.firebaseapp.com",projectId:"split-the-cost-176bf",storageBucket:"split-the-cost-176bf.appspot.com",messagingSenderId:"887247853169",appId:"1:887247853169:web:de028bf83a3c0f8ba6add0"})),je={toFirestore:function(e){return{id:e.id,timestamp:e.timestamp,lastAccessed:e.lastAccessed,lastEdited:e.lastEdited,title:e.title,entries:e.entries,users:e.users,numUsers:e.numUsers,createdBy:e.createdBy,readOnly:!!e.readOnly&&e.readOnly,customLink:e.customLink?e.customLink:"",password:e.password?e.password:""}},fromFirestore:function(e,t){var n=e.data(t);return{id:n.id,timestamp:n.timestamp,lastAccessed:n.lastAccessed,lastEdited:n.lastEdited,title:n.title,entries:n.entries,users:n.users,numUsers:n.numUsers,createdBy:n.createdBy,local:!1,readOnly:n.readOnly,customLink:n.customLink,password:n.password?n.password:""}}},be=(de.auth(),de.firestore()),Oe=(new ue.a.auth.GoogleAuthProvider,n(92)),he=n.n(Oe),me=n(201),xe=n.n(me),fe=n(200),pe=n.n(fe),ve=n(22),ge=function(e){var t=e.open,n=e.setOpen,a=Object(c.useContext)(et),r=a.sheetState,i=a.sheetDispatch,o=Object(ve.f)(),u=Object(c.useState)(r.title),j=Object(l.a)(u,2),h=j[0],x=j[1],f=Object(c.useState)(!1),p=Object(l.a)(f,2),g=p[0],y=p[1],N=Object(c.useState)(!0),w=Object(l.a)(N,2),U=w[0],M=w[1],I=Object(c.useState)(r.customLink?r.customLink:r.id),P=Object(l.a)(I,2),T=P[0],B=P[1],A=Object(c.useState)(!1),L=Object(l.a)(A,2),R=L[0],H=L[1],z=Object(c.useState)(!0),$=Object(l.a)(z,2),G=$[0],Y=$[1],Z=Object(c.useState)(!0),X=Object(l.a)(Z,2),q=X[0],V=X[1],J=Object(c.useState)(r.readOnly),Q=Object(l.a)(J,2),_=Q[0],ee=Q[1],te=Object(c.useState)(""),ne=Object(l.a)(te,2),ae=ne[0],ce=ne[1],re=Object(c.useState)(!1),ie=Object(l.a)(re,2),ue=ie[0],de=ie[1],je=Object(c.useState)(!0),Oe=Object(l.a)(je,2),me=Oe[0],fe=Oe[1],ge=Object(c.useState)(!1),ye=Object(l.a)(ge,2),Ne=ye[0],Se=ye[1],Ce=Object(c.useState)(""),ke=Object(l.a)(Ce,2),we=ke[0],Ue=ke[1],Me=Object(c.useState)(!0),Ie=Object(l.a)(Me,2),De=Ie[0],Ee=Ie[1],Pe=Object(c.useState)(""),Te=Object(l.a)(Pe,2),Be=Te[0],Ae=Te[1],Le=Object(c.useState)(!1),Fe=Object(l.a)(Le,2),We=Fe[0],Re=Fe[1],He=Object(c.useState)(!1),ze=Object(l.a)(He,2),$e=ze[0],Ke=ze[1];function Ge(){n(!1),Ze(),Ve(),_e(),at()}function Ye(){g?function(){if(h.trim()===r.title)return void Ze();if(!S(h.trim()))return void M(!1);y(!1),M(!0),i({type:"changeSheetTitle",title:h.trim()})}():y(!0)}function Ze(){y(!1),M(!0),x(r.title)}function Xe(){R?function(){qe.apply(this,arguments)}():H(!0)}function qe(){return(qe=Object(b.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=T.trim())!==r.customLink&&t!==r.id){e.next=4;break}return Ve(),e.abrupt("return");case 4:if(n=C(t),Y(n),n){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,be.collection("customLinks").doc(t).get();case 10:if(!e.sent.exists){e.next=14;break}return V(!1),e.abrupt("return");case 14:return e.next=16,be.collection("sheets").doc(t).get();case 16:if(!e.sent.exists){e.next=20;break}return V(!1),e.abrupt("return");case 20:H(!1),Y(!0),V(!0),i({type:"changeSheetLink",link:t}),o.push("/sheet/".concat(T));case 25:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ve(){H(!1),Y(!0),V(!0),B(r.customLink?r.customLink:r.id)}function Je(e){i({type:"updateReadOnly",readOnly:e.target.checked})}function Qe(){ue?function(){if(!ae)return void _e();if(fe(k(ae)),!k(ae))return;if(Ee(ae===we),ae!==we)return;console.log("UPDATING PASSWORD TO "+ae),i({type:"updateSheetPassword",password:ae}),_e()}():de(!0)}function _e(){de(!1),Ee(!0),fe(!0),ce(""),Ue("")}function tt(){We?function(){nt.apply(this,arguments)}():Re(!0)}function nt(){return(nt=Object(b.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Be.trim()){e.next=3;break}return at(),e.abrupt("return");case 3:if(Be===r.title){e.next=6;break}return Ke(!0),e.abrupt("return");case 6:i({type:"deleteSheet"}),o.push("/"),at();case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function at(){Ke(!1),Re(!1),Ae("")}return Object(c.useEffect)((function(){x(r.title),B(r.customLink?r.customLink:r.id),ee(r.readOnly)}),[r.title,r.customLink,r.id,r.readOnly]),Object(s.jsxs)(D.a,{fullWidth:!0,disableBackdropClick:!0,maxWidth:"sm",onClose:Ge,open:t,PaperProps:{className:"modal"},children:[Object(s.jsx)(W,{title:"Settings",onClose:Ge}),Object(s.jsx)(E.a,{className:"modalContent",children:Object(s.jsxs)(O.a,{container:!0,spacing:0,alignItems:"center",children:[Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(O.a,{className:"bottomMargin",item:!0,xs:8,children:Object(s.jsx)(se.a,{fullWidth:!0,inputRef:function(e){return e&&g&&e.focus()},value:h,error:!U,label:"Sheet Title",onChange:function(e){return x(e.target.value)},helperText:U?"":"Title must be between 3-40 characters (select special characters are allowed).",InputProps:{readOnly:!g,disableUnderline:!g}})}),Object(s.jsxs)(O.a,{container:!0,item:!0,xs:4,justify:"flex-end",children:[g&&Object(s.jsx)(m.a,{onClick:Ze,children:Object(s.jsx)(F.a,{})}),Object(s.jsx)(m.a,{onClick:Ye,children:g?Object(s.jsx)(he.a,{}):Object(s.jsx)(K.a,{})})]})]}),!r.local&&Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(O.a,{className:"bottomMargin",item:!0,xs:8,children:Object(s.jsx)(se.a,{fullWidth:!0,inputRef:function(e){return e&&R&&e.focus()},value:T,error:!G||!q,label:"Custom Sheet Link",onChange:function(e){return B(e.target.value)},helperText:G?q?"":"This custom link is already in use.":"Link must be between 5-20 characters and contain only letters and numbers.",InputProps:{readOnly:!R,disableUnderline:!R,startAdornment:Object(s.jsx)("b",{children:"splitthecost.net/#/"})}})}),Object(s.jsxs)(O.a,{container:!0,item:!0,xs:4,justify:"flex-end",children:[R&&Object(s.jsx)(m.a,{onClick:Ve,children:Object(s.jsx)(F.a,{})}),Object(s.jsx)(m.a,{onClick:Xe,children:R?Object(s.jsx)(he.a,{}):Object(s.jsx)(K.a,{})})]})]}),Object(s.jsx)(O.a,{item:!0,xs:12,children:Object(s.jsx)(le.a,{control:Object(s.jsx)(oe.a,{checked:_,onChange:Je,color:"primary"}),label:"Read Only"})}),!r.local&&Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(O.a,{className:"bottomMargin",item:!0,xs:8,children:Object(s.jsx)(se.a,{fullWidth:!0,value:ae,error:!me,label:"Sheet Password",placeholder:"Enter new sheet password here",onChange:function(e){return ce(e.target.value)},helperText:me?"":"Password must be between 5-25 characters and can only contain these special characters (!, @, #, $, %).",InputProps:{readOnly:!ue,disableUnderline:!ue,type:Ne?"default":"password"}})}),Object(s.jsxs)(O.a,{container:!0,item:!0,xs:4,justify:"flex-end",children:[Object(s.jsx)(m.a,{onClick:function(){return Se(!Ne)},children:Ne?Object(s.jsx)(pe.a,{}):Object(s.jsx)(xe.a,{})}),ue&&Object(s.jsx)(m.a,{onClick:_e,children:Object(s.jsx)(F.a,{})}),Object(s.jsx)(m.a,{onClick:Qe,children:ue?Object(s.jsx)(he.a,{}):Object(s.jsx)(K.a,{})})]}),ue&&Object(s.jsx)(O.a,{className:"bottomMargin",item:!0,xs:8,children:Object(s.jsx)(se.a,{fullWidth:!0,value:we,error:!De,placeholder:"Confirm password",onChange:function(e){return Ue(e.target.value)},helperText:De?"":"Passwords don't match.",InputProps:{readOnly:!ue,disableUnderline:!ue,type:Ne?"default":"password"}})})]}),!r.local&&Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(O.a,{className:"bottomMargin",item:!0,xs:8,children:Object(s.jsx)(se.a,{fullWidth:!0,inputRef:function(e){return e&&We&&e.focus()},value:Be,placeholder:"Enter sheet name to confirm deletion.",error:$e,label:"Delete Sheet",onChange:function(e){return Ae(e.target.value)},helperText:$e?"Please enter the sheet name correctly (".concat(r.title,")"):"",InputProps:{readOnly:!We,disableUnderline:!We}})}),Object(s.jsxs)(O.a,{container:!0,item:!0,xs:4,justify:"flex-end",children:[We&&Object(s.jsx)(m.a,{onClick:at,children:Object(s.jsx)(F.a,{})}),Object(s.jsx)(m.a,{onClick:tt,children:We?Object(s.jsx)(he.a,{}):Object(s.jsx)(v.a,{})})]})]})]})})]})},ye=function(e){var t=e.removeUser,n=e.open,a=e.setOpen,r=Object(c.useContext)(et),i=r.sheetState,l=r.sheetDispatch;function o(){a(!1)}function u(){t.id!==i.createdBy&&l({type:"removeUser",userId:t.id}),a(!1)}return Object(s.jsxs)(D.a,{fullWidth:!0,disableBackdropClick:!0,maxWidth:"xs",onClose:o,open:n,onKeyPress:function(e){return U(e,"enter",u)},PaperProps:{className:"modal"},children:[Object(s.jsx)(W,{title:"Remove Friend",onClose:o}),Object(s.jsxs)(E.a,{children:["Are you sure you want to remove ",Object(s.jsx)("b",{children:t.displayName})," and all associated entries from this sheet?"]}),Object(s.jsx)(T.a,{className:"modalActions",children:Object(s.jsx)(B.a,{className:"modalConfirmButton rightMarginSmall",onClick:u,children:"Confirm"})})]})},Ne=function(e){var t=e.open,n=e.setOpen,a=Object(ve.f)(),r=Object(c.useContext)(et),i=r.sheetState,o=r.sheetDispatch,u=Object(c.useState)(""),d=Object(l.a)(u,2),j=d[0],b=d[1];function h(){n(!1)}return Object(c.useEffect)((function(){b(i.local?"GENERATE":"COPY")}),[i.local]),Object(s.jsxs)(D.a,{fullWidth:!0,disableBackdropClick:!0,maxWidth:"xs",onClose:h,open:t,PaperProps:{className:"modal"},children:[Object(s.jsx)(W,{title:"Share Sheet",onClose:h}),Object(s.jsx)(E.a,{className:"modalContent bottomMargin",children:Object(s.jsxs)(O.a,{container:!0,spacing:0,alignItems:"center",children:[Object(s.jsx)(O.a,{item:!0,xs:8,children:i.local?"Generate link to share with friends?":Object(s.jsxs)(s.Fragment,{children:["splitthecost.com/sheet/",Object(s.jsx)("b",{children:i.customLink?i.customLink:i.id})]})}),Object(s.jsx)(O.a,{item:!0,xs:1}),Object(s.jsx)(O.a,{container:!0,item:!0,xs:3,justify:"flex-end",children:Object(s.jsx)(B.a,{fullWidth:i.local,onClick:i.local?function(){o({type:"saveSheet"}),a.push("/sheet/".concat(i.id))}:function(){navigator.clipboard.writeText("splitthecost.net/#/sheet/".concat(i.id)),b("COPIED")},children:j})})]})})]})},Se=n(202),Ce=n.n(Se),ke=n(203),we=n.n(ke),Ue=function(){var e,t=Object(c.useContext)(jt).userState,n=Object(c.useContext)(et).sheetState,a=Object(c.useState)(!1),r=Object(l.a)(a,2),i=r[0],o=r[1],u=Object(c.useState)(!1),d=Object(l.a)(u,2),j=d[0],b=d[1],h=Object(c.useState)(!1),x=Object(l.a)(h,2),f=x[0],p=x[1],v=Object(c.useState)(!1),g=Object(l.a)(v,2),N=g[0],S=g[1],C=Object(c.useState)(),k=Object(l.a)(C,2),w=k[0],U=k[1];function M(){o(!0)}function I(e){U(e),b(!0)}return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsxs)(O.a,{className:"usersBar",container:!0,spacing:0,children:[Object(s.jsx)(O.a,{item:!0,container:!0,xs:11,alignItems:"center",children:t.authenticated&&Object(s.jsxs)(s.Fragment,{children:[t.curUser&&Object(s.jsx)(H,{className:"leftMargin bottomMargin",user:t.curUser,userIdx:Object.keys(n.users).indexOf(t.curUser.id)}),Object.entries(n.users).map((function(e){var a=e[1];return(!t.curUser||a.id!==t.curUser.id)&&Object(s.jsx)(H,{className:"leftMargin bottomMargin",user:a,userIdx:Object.keys(n.users).indexOf(a.id),onRemove:!n.readOnly&&t.curUser&&n.createdBy!==a.id?I:void 0},a.id)})),!n.readOnly&&t.curUser&&Object.keys(n.users).length<=10&&Object(s.jsx)(y.a,{arrow:!0,title:"Add Friend",placement:"right",children:Object(s.jsx)(m.a,{className:"iconButton smallIconButton leftMargin bottomMargin",onClick:M,children:Object(s.jsx)(ie.a,{})})})]})}),Object(s.jsxs)(O.a,{item:!0,container:!0,xs:1,justify:"flex-end",alignItems:"center",children:[Object(s.jsx)(m.a,{className:"iconButton smallIconButton rightMargin bottomMargin",onClick:function(){S(!0)},children:Object(s.jsx)(Ce.a,{id:"shareIcon"})}),(null===(e=t.curUser)||void 0===e?void 0:e.id)===n.createdBy&&Object(s.jsx)(m.a,{className:"iconButton smallIconButton rightMargin bottomMargin",onClick:function(){p(!0)},children:Object(s.jsx)(we.a,{})})]})]}),Object(s.jsx)(ce,{open:i,setOpen:o}),Object(s.jsx)(ge,{open:f,setOpen:p}),w&&Object(s.jsx)(ye,{removeUser:w,open:j,setOpen:b}),Object(s.jsx)(Ne,{open:N,setOpen:S})]})},Me=function(){return Object(s.jsxs)(O.a,{className:"gridHeader roundedTop",container:!0,spacing:0,children:[Object(s.jsx)(O.a,{item:!0,xs:2}),Object(s.jsx)(O.a,{item:!0,xs:5,children:Object(s.jsx)("span",{className:"leftMargin",children:"TOTAL SPENT"})}),Object(s.jsx)(O.a,{item:!0,xs:5,children:Object(s.jsx)("span",{className:"leftMargin",children:"TOTAL OWED"})})]})},Ie=function(e){var t=e.user,n=e.data,a=e.idx,r=Object(c.useContext)(et).sheetState;return Object(s.jsxs)(O.a,{className:"".concat(a%2?"lightRow":"darkRow"," ").concat(a===r.numUsers-1&&"roundedBottom"),container:!0,spacing:0,children:[Object(s.jsx)(O.a,{className:"sideDialogRow",item:!0,xs:2,children:Object(s.jsx)(M,{className:"leftMargin",user:t,userIdx:Object.keys(r.users).indexOf(t.id),tooltipPlacement:"left"})}),Object(s.jsx)(O.a,{className:"sideDialogRow",item:!0,xs:5,children:Object(s.jsx)(h.a,{className:"sideMargins",readOnly:!0,disableUnderline:!0,fullWidth:!0,value:n?null===n||void 0===n?void 0:n.totalSpent.toFixed(2):0,startAdornment:Object(s.jsx)(x.a,{position:"start",children:"$"})})}),Object(s.jsx)(O.a,{className:"sideDialogRow",item:!0,xs:5,children:Object(s.jsx)(s.Fragment,{children:Object(s.jsx)(h.a,{readOnly:!0,disableUnderline:!0,fullWidth:!0,className:"sideMargins",value:n?null===n||void 0===n?void 0:n.totalOwed.toFixed(2):0,startAdornment:Object(s.jsx)(x.a,{position:"start",children:"$"})})})})]})},De=function(){var e=Object(c.useContext)(et).sheetState,t=Object(c.useContext)(jt).userState,n=Object(c.useState)({}),a=Object(l.a)(n,2),r=a[0],i=a[1],o=0;return Object(c.useEffect)((function(){i(function(e,t){var n={};return Object.entries(t).forEach((function(e){var t=e[1];n[t.id]={totalSpent:0,totalOwed:0}})),e.forEach((function(e){n[e.user].totalSpent+=e.cost;var a=Object.keys(t).filter((function(t){return!e.exclude.includes(t)})),s=e.cost/a.length;a.forEach((function(t){t!==e.user&&(n[t].totalOwed+=s)}))})),n}(e.entries,e.users))}),[e]),Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(Me,{}),t.curUser&&Object(s.jsx)(Ie,{user:t.curUser,data:r[t.curUser.id],idx:o++}),Object.entries(e.users).map((function(e){var n,a=e[1];return a.id!==(null===(n=t.curUser)||void 0===n?void 0:n.id)&&Object(s.jsx)(Ie,{user:a,data:r[a.id],idx:o++},a.id)}))]})},Ee=n(205),Pe=n.n(Ee),Te=n(204),Be=n.n(Te),Ae=n(379),Le=n(374),Fe=n(376),We=function(){return Object(s.jsxs)(O.a,{className:"gridHeader roundedTop",container:!0,spacing:0,children:[Object(s.jsx)(O.a,{item:!0,xs:8,children:Object(s.jsx)("span",{className:"leftMargin",children:"TRANSACTIONS"})}),Object(s.jsx)(O.a,{item:!0,xs:4,children:Object(s.jsx)("span",{className:"leftMargin",children:"TOTAL"})})]})},Re=function(e){var t=e.user,n=e.data,a=e.idx,r=Object(c.useContext)(et).sheetState,i=Object(c.useContext)(jt).userState,l=n?n.theyOwe-n.youOwe:0,o=l<0?i.curUser:t,u=l<0?t:i.curUser;return Object(s.jsxs)(O.a,{className:"".concat(a%2?"lightRow":"darkRow"," ").concat(a===r.numUsers-2&&"roundedBottom"),container:!0,spacing:0,children:[Object(s.jsx)(O.a,{className:"sideDialogRow",item:!0,xs:2,children:Object(s.jsx)(M,{className:"leftMargin",user:o,userIdx:Object.keys(r.users).indexOf(o.id),tooltipPlacement:"left"})}),Object(s.jsx)(O.a,{className:"sideDialogRow",item:!0,xs:4,children:0===l?Object(s.jsx)("div",{className:"leftMargin evenArrow",children:Object(s.jsx)("span",{children:"EVEN"})}):Object(s.jsx)("div",{className:"arrow ".concat(l<0?"redArrow":"greenArrow"),children:Object(s.jsx)("span",{className:"leftMarginSmall",children:l<0?"YOU OWE":"OWES YOU"})})}),Object(s.jsx)(O.a,{className:"sideDialogRow",item:!0,xs:2,children:Object(s.jsx)(M,{user:u,userIdx:Object.keys(r.users).indexOf(u.id),tooltipPlacement:"top"})}),Object(s.jsx)(O.a,{className:"sideDialogRow",item:!0,xs:4,children:Object(s.jsx)(h.a,{className:"sideMargins",readOnly:!0,disableUnderline:!0,fullWidth:!0,inputComponent:g.a,inputProps:{decimalScale:2,allowNegative:!1,thousandSeparator:","},value:Math.abs(l).toFixed(2),startAdornment:Object(s.jsx)(x.a,{position:"start",children:"$"})})})]})},He=function(){var e=Object(c.useContext)(et).sheetState,t=Object(c.useContext)(jt).userState,n=Object(c.useState)(),a=Object(l.a)(n,2),r=a[0],i=a[1],o=0;return Object(c.useEffect)((function(){t.curUser&&i(function(e,t,n){var a={user:e,totalSpent:0,totalOwed:0,userBreakdown:{}};return Object.entries(n).forEach((function(t){var n=t[1];n!==e&&(a.userBreakdown[n.id]={theyOwe:0,youOwe:0})})),t.forEach((function(t){var s=Object.keys(n).length-t.exclude.length;t.user===e.id?(a.totalSpent+=t.cost,Object.keys(n).filter((function(e){return!t.exclude.includes(e)&&e!==t.user})).forEach((function(e){a.userBreakdown[e].theyOwe+=t.cost/s}))):t.exclude.includes(e.id)||(a.totalOwed+=t.cost/s,a.userBreakdown[t.user].youOwe+=t.cost/s)})),a}(t.curUser,e.entries,e.users))}),[t.curUser,e]),!t.curUser||!r||e.numUsers<2?Object(s.jsx)("div",{className:"noBreakdownData",children:"No data to break down. \ud83e\udd74"}):Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(We,{}),Object.entries(e.users).map((function(e){var n=e[1];return n.id!==t.curUser.id&&Object(s.jsx)(Re,{user:n,data:r.userBreakdown[n.id],idx:o++},n.id)}))]})},ze=n(138),$e=n(375),Ke=function(){var e=Object(c.useState)(!0),t=Object(l.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)("ov"),i=Object(l.a)(r,2),o=i[0],u=i[1];return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(G.a,{children:n&&Object(s.jsx)(G.b.div,{className:"sideDialog",animate:{x:0,opacity:1},initial:{x:600,opacity:0},exit:{x:600,opacity:0},transition:{duration:.3},children:Object(s.jsxs)(ze.a,{value:o,children:[Object(s.jsxs)(Ae.a,{value:o,onChange:function(e,t){u(t)},indicatorColor:"primary",textColor:"primary",children:[Object(s.jsx)(Le.a,{className:"sideDialogTab",value:"ov",label:"OVERVIEW"}),Object(s.jsx)(Le.a,{className:"sideDialogTab",value:"bd",label:"BREAKDOWN"})]}),Object(s.jsx)(G.b.div,{animate:"ov"===o?{opacity:1}:{opacity:0},transition:{duration:.7},children:Object(s.jsx)($e.a,{className:"sideDialogContent",value:"ov",children:Object(s.jsx)(De,{})})}),Object(s.jsx)(G.b.div,{animate:"bd"===o?{opacity:1}:{opacity:0},transition:{duration:.7},children:Object(s.jsx)($e.a,{className:"sideDialogContent",value:"bd",children:Object(s.jsx)(He,{})})})]})})}),Object(s.jsx)(G.b.div,{className:"sideDialogFab",animate:n?{x:-440}:{x:0},transition:{duration:.3},children:Object(s.jsx)(Fe.a,{variant:"extended",size:"medium",onClick:function(){a(!n)},children:n?Object(s.jsx)(Be.a,{}):Object(s.jsx)(Pe.a,{})})})]})},Ge=function(){var e=Object(c.useContext)(et).sheetDispatch,t=Object(c.useContext)(jt).userState;return Object(s.jsx)("div",{className:"addItemFabDiv",children:Object(s.jsxs)(Fe.a,{className:"addItemFab",variant:"extended",size:"medium",onClick:function(){e({type:"addEntry",createdBy:t.curUser.id,item:"",cost:0,exclude:[],note:""})},children:[Object(s.jsx)(ie.a,{}),Object(s.jsx)("span",{className:"leftMarginSmall",children:"Add Expense"})]})})},Ye=n(65);function Ze(e,t){switch(t.type){case"addEntry":return function(e,t){var n={id:Object(Ye.a)(),timestamp:new Date(Date.now()).toUTCString(),lastEdited:Date.now(),item:t.item?t.item:"",cost:t.cost?t.cost:0,exclude:t.exclude?t.exclude:[],note:t.note?t.note:"",user:t.createdBy,createdBy:t.createdBy},a=Object(o.a)(Object(o.a)({},e),{},{entries:[].concat(Object(I.a)(e.entries),[n]),lastEdited:Date.now(),readOnly:!1});return Xe(a,t.local),a}(e,t);case"removeEntry":return function(e,t){var n=e.entries.filter((function(e){return e.id!==t.entryId})),a=Object(o.a)(Object(o.a)({},e),{},{entries:n,lastEdited:Date.now()});return Xe(a,t.local),a}(e,t);case"updateEntry":return function(e,t){var n=t.entry,a=t.value,s=Object(o.a)(Object(o.a)({},n),{},{lastEdited:Date.now()});if("item"===t.section){if(n.item===a)return e;s=Object(o.a)(Object(o.a)({},s),{},{item:a})}else if("cost"===t.section)s=Object(o.a)(Object(o.a)({},s),{},{cost:Number(a.replaceAll(",",""))});else if("user"===t.section){if(n.user===a)return e;s=Object(o.a)(Object(o.a)({},s),{},{user:a})}else{if(n.note===a)return e;s=Object(o.a)(Object(o.a)({},s),{},{note:a})}var c=Object(I.a)(e.entries);return c[c.indexOf(n)]=s,Object(o.a)(Object(o.a)({},e),{},{entries:c,lastEdited:Date.now()})}(e,t);case"addUser":return function(e,t){if(e.numUsers>=10)return e;var n=!1;if(Object.entries(e.users).forEach((function(e){var a=e[1];a.firstName===t.firstName&&a.lastName===t.lastName&&(n=!0)})),n)return e;var a={id:Object(Ye.a)(),firstName:t.firstName,lastName:t.lastName,initials:"".concat(t.firstName.charAt(0)).concat(t.lastName.charAt(0)).toLocaleUpperCase(),displayName:"".concat(t.firstName," ").concat(t.lastName),email:t.email},s=Object(o.a)(Object(o.a)({},e),{},{users:Object(o.a)(Object(o.a)({},e.users),{},Object(j.a)({},a.id,a)),numUsers:e.numUsers+1,lastEdited:Date.now()});return Xe(s,t.local),s}(e,t);case"removeUser":return function(e,t){if(1===e.numUsers)return e;var n=Object(o.a)({},e.users);delete n[t.userId];var a=e.entries.filter((function(e){return e.createdBy!==t.userId&&e.user!==t.userId}));a.forEach((function(e,n){if(e.exclude.includes(t.userId)){var s=e.exclude.filter((function(e){return t.userId!==e})),c=Object(o.a)(Object(o.a)({},e),{},{exclude:s});a[n]=c}}));var s=Object(o.a)(Object(o.a)({},e),{},{entries:a,users:n,numUsers:e.numUsers-1,lastEdited:Date.now()});return Xe(s,t.local),s}(e,t);case"updateExcludedUsers":return function(e,t){var n=Object(o.a)(Object(o.a)({},t.entry),{},{exclude:t.exclude}),a=Object(I.a)(e.entries);a[a.indexOf(t.entry)]=n;var s=Object(o.a)(Object(o.a)({},e),{},{entries:a,lastEdited:Date.now()});return Xe(s,t.local),s}(e,t);case"removeExcludedUser":return function(e,t){var n=Object(o.a)(Object(o.a)({},t.entry),{},{exclude:t.entry.exclude.filter((function(e){return e!==t.userId}))}),a=Object(I.a)(e.entries);a[a.indexOf(t.entry)]=n;var s=Object(o.a)(Object(o.a)({},e),{},{entries:a,lastEdited:Date.now()});return Xe(s,t.local),s}(e,t);case"changeSheetTitle":return function(e,t){if(e.title===t.title)return e;var n=Object(o.a)(Object(o.a)({},e),{},{title:t.title,lastEdited:Date.now()});return Xe(n),n}(e,t);case"changeSheetLink":return function(e,t){if(!t.link||e.customLink===t.link||t.link.length<5)return e;var n=Object(o.a)(Object(o.a)({},e),{},{customLink:t.link,lastEdited:Date.now()});Xe(n),e.customLink&&be.collection("customLinks").doc(e.customLink).delete();var a={sheetId:e.id};return be.collection("customLinks").doc(t.link).set(a),n}(e,t);case"updateSheetPassword":return function(e,t){if(e.local)return e;var a=n(143),s=10;return a.hash(t.password,s,(function(t,n){t||Xe(Object(o.a)(Object(o.a)({},e),{},{password:n}))})),e}(e,t);case"saveSheet":return function(e,t){if(!e.local)return e;var n=Object(o.a)(Object(o.a)({},e),{},{local:!1,lastEdited:Date.now()});return Xe(n),n}(e);case"autosaveSheet":return function(e,t){Date.now()-e.lastEdited<11e3&&(t.setAutosaveState(a.Saving),Xe(e));return e}(e,t);case"updateReadOnly":return function(e,t){var n=Object(o.a)(Object(o.a)({},e),{},{readOnly:t.readOnly});return Xe(n),n}(e,t);case"deleteSheet":return function(e,t){if(e.local)return e;be.collection("deletedSheets").withConverter(je).doc(e.id).set(e),be.collection("sheets").doc(e.id).delete(),e.customLink&&(be.collection("deletedCustomLinks").doc(e.customLink).set({sheetId:e.id}),be.collection("customLinks").doc(e.customLink).delete());return e}(e);case"updateSheetState":return t.sheetState;default:return e}}function Xe(e,t){t||e.local||be.collection("sheets").withConverter(je).doc(e.id).set(e)}var qe,Ve=n(377),Je=function(e){var t=e.open,a=Object(c.useContext)(et).sheetState,r=Object(c.useContext)(jt),i=r.userState,o=r.userDispatch,u=Object(c.useState)(),d=Object(l.a)(u,2),j=d[0],b=d[1],O=Object(c.useState)(""),h=Object(l.a)(O,2),m=h[0],x=h[1],f=Object(c.useState)(!0),p=Object(l.a)(f,2),v=p[0],g=p[1];function y(){a.password?n(143).compare(m,a.password,(function(e,t){t?o({type:"setAuthStatus",authenticated:!0}):g(!1)})):o({type:"setAuthStatus",authenticated:!0})}function N(){o({type:"updateCurUser",user:j})}return Object(s.jsxs)(D.a,{fullWidth:i.authenticated,disableBackdropClick:!0,maxWidth:"sm",open:t,onKeyPress:function(e){return U(e,"enter",N)},PaperProps:{className:"modal"},children:[Object(s.jsx)(W,{title:i.authenticated?"Who are You?":"Enter Sheet Password"}),i.authenticated?Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(E.a,{children:Object.keys(a.users).length?Object.entries(a.users).map((function(e){var t=e[1];return Object(s.jsx)(H,{className:"bottomMargin rightMargin ".concat((null===j||void 0===j?void 0:j.id)===t.id&&"selectedChip"),user:t,userIdx:Object.keys(a.users).indexOf(t.id),onClick:b},t.id)})):Object(s.jsx)("div",{className:"trueCenter",children:Object(s.jsx)(Ve.a,{})})}),Object(s.jsx)(T.a,{className:"modalActions",children:Object(s.jsx)(B.a,{className:"modalConfirmButton rightMarginSmall",disabled:!j,onClick:N,children:"Confirm"})})]}):Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(E.a,{children:Object(s.jsx)(se.a,{className:"bottomMargin",fullWidth:!0,label:"Password",onChange:function(e){return x(e.target.value)},error:!v,helperText:v?"":"This password is incorrect.",InputProps:{type:"password"}})}),Object(s.jsx)(T.a,{className:"modalActions",children:Object(s.jsx)(B.a,{className:"modalConfirmButton rightMarginSmall",disabled:!m,onClick:y,children:"Confirm"})})]})]})},Qe=function(){return Object(s.jsxs)("div",{className:"errorPage",children:[Object(s.jsx)("span",{className:"errorPageHeader",children:Object(s.jsx)("b",{children:"coming soon..."})}),Object(s.jsx)("span",{className:"errorPageSubtitle",children:"We're currently working on a mobile friendly version of splithecost - in the meantime, please visit us on a computer!"})]})},_e={title:"Loading Sheet...",timestamp:"",lastAccessed:0,lastEdited:0,entries:[],users:{},numUsers:0,createdBy:"",local:!0,readOnly:!0,id:""},et=Object(c.createContext)({sheetState:_e,sheetDispatch:function(){return null}}),tt=function(){var e=window.innerWidth<=1e3,t=Object(ve.f)(),n=Object(ve.g)(),r=Object(ve.h)().sheetId,i=Object(c.useReducer)(Ze,_e),u=Object(l.a)(i,2),O=u[0],h=u[1],m=Object(c.useContext)(jt),x=m.userState,f=m.userDispatch,p=Object(c.useState)(O.local?a.Unsaved:a.Saved),v=Object(l.a)(p,2),g=v[0],y=v[1];function N(){return(N=Object(b.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(O.local){e.next=5;break}return h({type:"autosaveSheet",setAutosaveState:y}),e.next=4,new Promise((function(e){return setTimeout(e,1500)}));case 4:y(a.Saved);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(){return(S=Object(b.a)(d.a.mark((function e(){var n,a,s,c,i,l,u;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,be.collection("sheets").withConverter(je).doc(r).get();case 2:if(n=e.sent,!(a=n.data())){e.next=8;break}return h({type:"updateSheetState",sheetState:Object(o.a)(Object(o.a)({},a),{},{lastAccessed:Date.now(),readOnly:!1})}),f({type:"setAuthStatus",authenticated:!a.password}),e.abrupt("return");case 8:return e.next=10,be.collection("customLinks").doc(r).get();case 10:if(s=e.sent,!(c=s.data())){e.next=22;break}return i=c.sheetId,e.next=16,be.collection("sheets").withConverter(je).doc(i).get();case 16:if(l=e.sent,!(u=l.data())){e.next=22;break}return h({type:"updateSheetState",sheetState:Object(o.a)(Object(o.a)({},u),{},{lastAccessed:Date.now()})}),f({type:"setAuthStatus",authenticated:!u.password}),e.abrupt("return");case 22:t.push({pathname:"/invalidsheet",state:{sheetId:r}});case 23:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(c.useEffect)((function(){r&&"new"!==r?function(){S.apply(this,arguments)}():function(){if(!x.curUser||!n.state.title)return void t.push("/create");var e={id:Object(Ye.a)(10),timestamp:new Date(Date.now()).toUTCString(),lastAccessed:Date.now(),lastEdited:Date.now(),title:n.state.title,entries:[],users:Object(j.a)({},x.curUser.id,x.curUser),numUsers:1,createdBy:x.curUser.id,local:!0,readOnly:!1};h({type:"updateSheetState",sheetState:e}),h({type:"addEntry",createdBy:x.curUser.id})}()}),[]),Object(c.useEffect)((function(){y(O.local?a.Unsaved:a.Saved);var e=setInterval((function(){!function(){N.apply(this,arguments)}()}),1e4);return function(){return clearInterval(e)}}),[O.local]),Object(s.jsx)(et.Provider,{value:{sheetState:O,sheetDispatch:h},children:e?Object(s.jsx)(Qe,{}):Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(ae,{saveState:g}),Object(s.jsx)(Ue,{}),Object(s.jsx)(J,{}),x.authenticated&&Object(s.jsx)(Ke,{}),!O.readOnly&&x.curUser&&Object(s.jsx)(Ge,{}),Object(s.jsx)(Je,{open:!x.curUser})]})})},nt=n(29),at=n.p+"static/media/homepage.d372b9ab.png",st=n.p+"static/media/blob.244efd39.svg",ct=function(){return window.innerWidth<1e3?Object(s.jsx)(Qe,{}):Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(O.a,{id:"homepageHeader",container:!0,alignContent:"center",children:Object(s.jsxs)(O.a,{item:!0,container:!0,xs:12,justify:"flex-end",children:[Object(s.jsx)(nt.b,{className:"noTextDecoration",to:"/",children:Object(s.jsx)("span",{className:"homepageLink",children:"about"})}),Object(s.jsx)(nt.b,{className:"noTextDecoration",to:"/",children:Object(s.jsx)("span",{className:"homepageLink",children:"contact"})})]})}),Object(s.jsxs)(O.a,{className:"homepage",container:!0,spacing:0,alignContent:"center",children:[Object(s.jsxs)(O.a,{item:!0,container:!0,xs:8,justify:"center",children:[Object(s.jsx)("img",{id:"homepageBlob",src:st,alt:"blob"}),Object(s.jsx)("img",{id:"homepageImg",src:at,alt:"homepage"})]}),Object(s.jsx)(O.a,{item:!0,container:!0,xs:4,alignItems:"center",alignContent:"center",children:Object(s.jsxs)("div",{id:"homepageText",children:[Object(s.jsx)("span",{id:"homepageTitle",children:"welcome to splitthecost."}),Object(s.jsx)("span",{id:"homepageSubtitle",children:"shared expenses for trips/events made simple. no sign up required!"}),Object(s.jsx)(nt.b,{className:"noTextDecoration",to:"/create",children:Object(s.jsx)(B.a,{className:"createNewButton",children:"create new sheet"})})]})})]})]})};function rt(e,t){switch(t.type){case"updateCurUser":return function(e,t){return Object(o.a)(Object(o.a)({},e),{},{curUser:t.user})}(e,t);case"setDarkMode":return function(e,t){return Object(o.a)(Object(o.a)({},e),{},{darkMode:t.darkMode})}(e,t);case"setAuthStatus":return function(e,t){return Object(o.a)(Object(o.a)({},e),{},{authenticated:t.authenticated})}(e,t);default:return e}}!function(e){e[e.SheetName=1]="SheetName",e[e.DisplayName=2]="DisplayName"}(qe||(qe={}));var it=function(){var e=Object(c.useContext)(jt).userDispatch,t=Object(ve.f)(),n=Object(c.useState)(qe.SheetName),a=Object(l.a)(n,2),r=a[0],i=a[1],o=Object(c.useState)(""),u=Object(l.a)(o,2),d=u[0],j=u[1],b=Object(c.useState)(!0),h=Object(l.a)(b,2),x=h[0],f=h[1],p=Object(c.useState)(!1),v=Object(l.a)(p,2),g=v[0],y=v[1],C=Object(c.useState)(""),k=Object(l.a)(C,2),w=k[0],U=k[1],M=Object(c.useState)(!0),I=Object(l.a)(M,2),D=I[0],E=I[1],T=Object(c.useState)(""),A=Object(l.a)(T,2),L=A[0],W=A[1],R=Object(c.useState)(!0),H=Object(l.a)(R,2),z=H[0],$=H[1];function K(){var e=S(d);f(e),e&&i(qe.DisplayName)}function Y(){var n=N(w.trim()),a=N(L.trim());E(n),$(a),n&&a&&function(){var n=w.trim(),a=L.trim(),s={id:Object(Ye.a)(),firstName:n,lastName:a,initials:"".concat(n.charAt(0)).concat(a.charAt(0)).toLocaleUpperCase(),displayName:"".concat(n," ").concat(a),email:""};e({type:"updateCurUser",user:s}),e({type:"setAuthStatus",authenticated:!0}),t.push({pathname:"/sheet/new",state:{title:d}})}()}function Z(){return console.log(g),Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("div",{className:"giantHeader",children:"Give your sheet a name:"}),Object(s.jsx)(se.a,{className:"giantTextField",fullWidth:!0,placeholder:"Sheet name",value:d,onChange:function(e){return j(e.target.value)},helperText:x?"":"Title must be between 3-40 characters (select special characters are allowed).",inputProps:{className:"giantInput"},FormHelperTextProps:{className:"giantInputHelperText"}}),Object(s.jsx)(le.a,{className:"termsAndConditions",control:Object(s.jsx)(P.a,{checked:g,onClick:function(){return y(!g)},color:"primary"}),label:Object(s.jsxs)(s.Fragment,{children:["I accept the SplitTheCost ",Object(s.jsx)(nt.b,{to:"/tos",children:"terms"}),"."]})}),Object(s.jsx)(B.a,{className:"continueButton",disabled:!g,onClick:K,children:"continue"})]})}return Object(s.jsxs)(G.b.div,{initial:{x:2e3},animate:{x:0},transition:{type:"spring",duration:.8},children:[Object(s.jsxs)(O.a,{className:"createNewSheet",container:!0,spacing:0,children:[Object(s.jsx)(O.a,{item:!0,xs:1}),Object(s.jsx)(O.a,{className:"createNewSheetItem",item:!0,xs:8,children:r===qe.SheetName?Z():r===qe.DisplayName?Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("div",{className:"giantHeader",children:"Yup, we're basically done. What's your name?"}),Object(s.jsxs)("div",{children:[Object(s.jsx)(se.a,{className:"giantTextField halfWidthModalInput",fullWidth:!0,placeholder:"First name",value:w,onChange:function(e){return U(e.target.value)},helperText:D?"":"Please enter a valid first name.",inputProps:{className:"giantInput"},FormHelperTextProps:{className:"giantInputHelperText"}}),Object(s.jsx)(se.a,{className:"leftMarginLarge giantTextField halfWidthModalInput",fullWidth:!0,placeholder:"Last name",value:L,onChange:function(e){return W(e.target.value)},helperText:z?"":"Please enter a valid last name.",inputProps:{className:"giantInput"},FormHelperTextProps:{className:"giantInputHelperText"}})]}),Object(s.jsxs)("div",{children:[Object(s.jsx)(B.a,{className:"continueButton",onClick:function(){i(r-1)},children:"go back"}),Object(s.jsx)(B.a,{className:"leftMargin continueButton",onClick:Y,children:"finish"})]})]}):Z()})]}),Object(s.jsxs)("div",{className:"stepIndicator",children:[Object(s.jsx)(nt.b,{to:"/",children:Object(s.jsx)(m.a,{size:"small",children:Object(s.jsx)(F.a,{})})}),Object(s.jsxs)("span",{className:"leftMarginSmall",children:["Create a sheet (Step ",r," of 2)"]})]})]})},lt=function(){return Object(s.jsxs)("div",{className:"errorPage",children:[Object(s.jsxs)("span",{className:"errorPageHeader",children:[Object(s.jsx)("b",{children:"404"})," - this page doesn't exist."]}),Object(s.jsx)(nt.b,{className:"noTextDecoration",to:"/",children:Object(s.jsx)(B.a,{className:"createNewButton",children:"home"})})]})},ot=function(){var e,t=Object(ve.g)();return Object(s.jsxs)("div",{className:"errorPage",children:[Object(s.jsxs)("span",{className:"errorPageHeader",children:["sorry, we couldn't find a sheet with id \"",Object(s.jsx)("b",{children:null===(e=t.state)||void 0===e?void 0:e.sheetId}),'".']}),Object(s.jsx)(nt.b,{className:"noTextDecoration",to:"/create",children:Object(s.jsx)(B.a,{className:"createNewButton",children:"create new sheet"})})]})},ut=function(){return Object(s.jsxs)("div",{id:"tos",children:[Object(s.jsx)("h2",{children:"Terms of Service"}),Object(s.jsxs)("p",{children:["SplitTheCost stores all data in ",Object(s.jsx)("b",{children:"unencrypted plaintext"})," and is not responsible for the loss or unauthorized release of any data. In other words,"," ",Object(s.jsx)("b",{children:"don't use SplitTheCost for private or confidential information! "}),"SplitTheCost is not liable for any direct, indirect, incidental, consequential, or special damages or losses resulting from authorized or unauthorized use of or access to this platform.",Object(s.jsx)("br",{}),Object(s.jsx)("br",{}),"That's about it! Have fun and enjoy to your heart's desire."]})]})},dt={curUser:void 0,darkMode:!1,authenticated:!1},jt=Object(c.createContext)({userState:dt,userDispatch:function(){return null}});var bt=function(){var e=Object(c.useReducer)(rt,dt),t=Object(l.a)(e,2),n=t[0],a=t[1];return Object(s.jsx)(nt.a,{children:Object(s.jsx)(jt.Provider,{value:{userState:n,userDispatch:a},children:Object(s.jsxs)(ve.c,{children:[Object(s.jsx)(ve.a,{path:"/",exact:!0,component:ct}),Object(s.jsx)(ve.a,{path:"/create",exact:!0,component:it}),Object(s.jsx)(ve.a,{path:"/sheet/:sheetId",exact:!0,component:tt}),Object(s.jsx)(ve.a,{path:"/invalidsheet",exact:!0,component:ot}),Object(s.jsx)(ve.a,{path:"/tos",exact:!0,component:ut}),Object(s.jsx)(ve.a,{component:lt})]})})})},Ot=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,387)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,c=t.getLCP,r=t.getTTFB;n(e),a(e),s(e),c(e),r(e)}))};i.a.render(Object(s.jsx)(bt,{}),document.getElementById("root")),Ot()}},[[324,1,2]]]);
//# sourceMappingURL=main.775e6272.chunk.js.map