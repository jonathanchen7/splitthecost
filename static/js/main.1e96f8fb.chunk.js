(this.webpackJsonpsplitthecost=this.webpackJsonpsplitthecost||[]).push([[0],{224:function(e,t,a){},225:function(e,t,a){},239:function(e,t){},241:function(e,t){},252:function(e,t){},254:function(e,t){},279:function(e,t){},281:function(e,t){},282:function(e,t){},287:function(e,t){},289:function(e,t){},308:function(e,t){},320:function(e,t){},323:function(e,t){},326:function(e,t,a){"use strict";a.r(t);var n,s=a(2),c=a(0),r=a(18),i=a.n(r),o=(a(224),a(7)),l=(a(225),a(10)),u=a(38),d=a.n(u),j=a(76),b=a(60);!function(e){e[e.Unsaved=1]="Unsaved",e[e.Saving=2]="Saving",e[e.Saved=3]="Saved"}(n||(n={}));var O=a(371),h=a(372),m=a(330),x=a(373),f=a(387),p=a(197),v=a.n(p),g=a(102),y=a(386);function N(e){return e.length>=1&&e.length<=20&&/^[a-zA-Z'-\s.()]+$/.test(e)}function S(e){return e.length>=3&&e.length<=41&&/^[0-9a-zA-Z!@#'-\s]+$/.test(e)}function C(e){return e.length>=5&&e.length<=20&&/^[0-9a-zA-Z]+$/.test(e)}function k(e){return e.length>=4&&e.length<=25&&/^[0-9a-zA-Z!@#$?]+$/.test(e)}function w(e,t,a){if(a)return"#dedede";var n=["#AD1457","#F9A825","#1565C0","#4527A0","#D84315","#4E342E","#00838F","#0277BD","#EF6C00","#424242"];return n[t%n.length]}function M(e,t,a){e.key.toLowerCase()===t&&a()}var U=function(e){var t=e.user,a=e.userIdx,n=e.tooltipPlacement,r=e.onClick,i=e.iconOnHover,l=e.disabled,u=e.className,d=Object(c.useState)(!1),j=Object(o.a)(d,2),b=j[0],O=j[1];return Object(s.jsx)(y.a,{className:u,arrow:!0,title:t.displayName,placement:n,onClick:r,children:Object(s.jsx)(f.a,{className:"avatar",style:{backgroundColor:w(0,a,l),cursor:r?"pointer":"default"},children:Object(s.jsx)("span",{onMouseEnter:function(){return O(!0)},onMouseLeave:function(){return O(!1)},children:b&&i||t.initials})})})},D=a(69),I=a(385),E=a(368),P=a(384),B=a(369),A=a(370),T=a(366),L=a(54),F=a.n(L),W=function(e){var t=e.title,a=e.subtitle,n=e.onClose;return Object(s.jsxs)(T.a,{className:"modalTitle",children:[t,a&&Object(s.jsxs)(s.Fragment,{children:[" ","| ",Object(s.jsx)("b",{children:"".concat(a)})]}),n&&Object(s.jsx)(m.a,{className:"modalClose",size:"small",onClick:n,children:Object(s.jsx)(F.a,{})})]})},R=a(388),H=function(e){var t=e.user,a=e.userIdx,n=e.onRemove,c=e.onClick,r=e.className;return Object(s.jsx)("span",{onClick:c&&function(){return c(t)},children:Object(s.jsx)(R.a,{className:"chip ".concat(r," ").concat(c&&"linkCursor"),avatar:Object(s.jsx)(f.a,{className:"smallAvatar",style:{backgroundColor:w(0,a)},children:t.initials}),label:t.displayName,onDelete:n&&function(){return n(t)}},t.id)})},z=function(e){var t=e.open,a=e.setOpen,n=e.entry,r=Object(c.useContext)(st),i=r.sheetState,l=r.sheetDispatch,u=Object(c.useState)(n.exclude),d=Object(o.a)(u,2),j=d[0],b=d[1];function O(){n.exclude!==j&&l({type:"updateExcludedUsers",exclude:j,entry:n}),m()}function h(e){j.includes(e)?b(j.filter((function(t){return t!==e}))):b([].concat(Object(D.a)(j),[e]))}function m(){b(n.exclude),a(!1)}return Object(c.useEffect)((function(){b(n.exclude)}),[n.exclude]),Object(s.jsxs)(I.a,{fullWidth:!0,disableBackdropClick:!0,maxWidth:"xs",onClose:m,open:t,onKeyPress:function(e){return M(e,"enter",O)},PaperProps:{className:"modal"},children:[Object(s.jsx)(W,{title:"Included Friends",subtitle:n.item,onClose:m}),Object(s.jsxs)(E.a,{className:"excludeModalContent",children:[Object(s.jsx)("div",{className:"excludeModalColumn",children:Object.entries(i.users).map((function(e,t){var a=e[1];return t%2===0&&Object(s.jsxs)("div",{className:"excludeModalUser",children:[Object(s.jsx)(P.a,{checked:!j.includes(a.id),color:"primary",onClick:function(){return h(a.id)}}),Object(s.jsx)(H,{user:a,userIdx:Object.keys(i.users).indexOf(a.id),onClick:function(){return h(a.id)}})]},a.id)}))}),Object(s.jsx)("div",{className:"excludeModalColumn",children:Object.entries(i.users).map((function(e,t){var a=e[1];return t%2===1&&Object(s.jsxs)("div",{className:"excludeModalUser",children:[Object(s.jsx)(P.a,{checked:!j.includes(a.id),color:"primary",onClick:function(){return h(a.id)}}),Object(s.jsx)(H,{user:a,userIdx:Object.keys(i.users).indexOf(a.id),onClick:function(){return h(a.id)}})]},a.id)}))})]}),Object(s.jsxs)(B.a,{className:"modalActions",children:[Object(s.jsx)(A.a,{className:"rightMarginSmall",color:"primary",onClick:function(){return b([])},children:"Include All"}),Object(s.jsx)(A.a,{className:"modalConfirmButton rightMarginSmall",onClick:O,children:"Confirm"})]})]})},$=a(67),K=a.n($),V=a(51),Z=a(382),G=function(e){var t=e.open,a=e.setOpen,n=e.entry,r=Object(c.useContext)(st),i=r.sheetState,l=r.sheetDispatch,u=Object(c.useState)(n.user),d=Object(o.a)(u,2),j=d[0],b=d[1];function O(){j&&j!==n.user&&(l({type:"updateEntry",entry:n,section:"user",value:j}),m())}function h(e){b(e)}function m(){b(n.user),a(!1)}return Object(c.useEffect)((function(){b(n.user)}),[n.user]),Object(s.jsxs)(I.a,{fullWidth:!0,disableBackdropClick:!0,maxWidth:"xs",onClose:m,open:t,onKeyPress:function(e){return M(e,"enter",O)},PaperProps:{className:"modal"},children:[Object(s.jsx)(W,{title:"Who Paid?",subtitle:n.item,onClose:m}),Object(s.jsxs)(E.a,{className:"excludeModalContent",children:[Object(s.jsx)("div",{className:"excludeModalColumn",children:Object.entries(i.users).map((function(e,t){var a=e[1];return t%2===0&&Object(s.jsxs)("div",{className:"excludeModalUser",children:[Object(s.jsx)(Z.a,{checked:j===a.id,onClick:function(){return h(a.id)}}),Object(s.jsx)(H,{user:a,userIdx:Object.keys(i.users).indexOf(a.id),onClick:function(){return h(a.id)}})]},a.id)}))}),Object(s.jsx)("div",{className:"excludeModalColumn",children:Object.entries(i.users).map((function(e,t){var a=e[1];return t%2===1&&Object(s.jsxs)("div",{className:"excludeModalUser",children:[Object(s.jsx)(Z.a,{checked:j===a.id,onClick:function(){return h(a.id)}}),Object(s.jsx)(H,{user:a,userIdx:Object.keys(i.users).indexOf(a.id),onClick:function(){return h(a.id)}})]},a.id)}))})]}),Object(s.jsx)(B.a,{className:"modalActions",children:Object(s.jsx)(A.a,{className:"modalConfirmButton rightMarginSmall",onClick:O,children:"Confirm"})})]})},X=function(e){var t=e.entry,a=e.open,n=e.setOpen,r=Object(c.useContext)(st).sheetDispatch;function i(){n(!1)}function o(){r({type:"removeEntry",entryId:t.id}),n(!1)}return Object(s.jsxs)(I.a,{fullWidth:!0,disableBackdropClick:!0,maxWidth:"xs",onClose:i,open:a,onKeyPress:function(e){return M(e,"enter",o)},PaperProps:{className:"modal"},children:[Object(s.jsx)(W,{title:"Remove Entry",onClose:i}),Object(s.jsxs)(E.a,{children:["Are you sure you want to remove ",Object(s.jsx)("b",{children:t.item})," from this sheet?"]}),Object(s.jsx)(B.a,{className:"modalActions",children:Object(s.jsx)(A.a,{className:"modalConfirmButton rightMarginSmall",onClick:o,children:"Confirm"})})]})},Y=function(e){var t=e.entry,a=e.rowIdx,n=Object(c.useContext)(st),r=n.sheetState,i=n.sheetDispatch,l=Object(c.useState)(!t.item&&!t.cost&&!t.note),u=Object(o.a)(l,2),d=u[0],j=u[1],b=Object(c.useState)(!1),p=Object(o.a)(b,2),y=p[0],N=p[1],S=Object(c.useState)(!1),C=Object(o.a)(S,2),k=C[0],w=C[1],M=Object(c.useState)(t.item),D=Object(o.a)(M,2),I=D[0],E=D[1],P=Object(c.useState)(t.note),B=Object(o.a)(P,2),A=B[0],T=B[1],L=Object(c.useState)(!1),F=Object(o.a)(L,2),W=F[0],R=F[1],H=Object(c.useState)(!1),$=Object(o.a)(H,2),Z=$[0],Y=$[1],q=Object(c.useState)(!1),J=Object(o.a)(q,2),Q=J[0],_=J[1];function ee(e,a,n){switch(a){case"item":i({type:"updateEntry",entry:t,section:"item",value:e}),j(!I&&!t.cost&&!A);break;case"cost":i({type:"updateEntry",entry:t,section:"cost",value:e,local:n}),j(!I&&!Number(e)&&!A);break;case"note":i({type:"updateEntry",entry:t,section:"note",value:e}),j(!I&&!t.cost&&!A)}}return Object(s.jsxs)(V.b.div,{animate:{x:0,opacity:1},initial:{x:-2e3,opacity:0},transition:{type:"tween",duration:.5},children:[Object(s.jsxs)(O.a,{className:a%2?"lightRow":"darkRow",container:!0,spacing:0,children:[Object(s.jsx)(O.a,{item:!0,xs:3,children:Object(s.jsxs)("div",{className:"entryDiv",onMouseOver:function(){return N(!0)},onMouseLeave:function(){return N(!1)},children:[Object(s.jsx)(U,{className:"leftMargin",user:r.users[t.user],userIdx:Object.keys(r.users).indexOf(r.users[t.user].id),tooltipPlacement:"top",disabled:d,onClick:r.readOnly?void 0:function(){return Y(!0)},iconOnHover:Object(s.jsx)(K.a,{})}),Object(s.jsx)(h.a,{className:"sideMargins",disableUnderline:!0,fullWidth:!0,readOnly:r.readOnly,value:I,placeholder:d?"Enter item name here":void 0,onFocus:function(){return j(!1)},onChange:function(e){return E(e.target.value)},onBlur:function(e){ee(e.target.value,"item")}}),!r.readOnly&&y&&Object(s.jsx)(m.a,{className:"iconButton largeIconButton rightMargin",onClick:function(){return _(!0)},children:Object(s.jsx)(v.a,{})})]})}),Object(s.jsx)(O.a,{item:!0,xs:1,children:Object(s.jsx)("div",{className:"entryDiv",children:Object(s.jsx)(h.a,{className:"sideMargins",disableUnderline:!0,fullWidth:!0,readOnly:r.readOnly,value:t.cost.toFixed(2),onFocus:function(){return j(!1)},onChange:function(e){ee(e.target.value,"cost",!0)},onBlur:function(e){ee(e.target.value,"cost")},startAdornment:Object(s.jsx)(x.a,{position:"start",children:"$"}),inputComponent:g.a,inputProps:{decimalScale:2,allowNegative:!1,thousandSeparator:",",allowLeadingZeros:!0}})})}),Object(s.jsx)(O.a,{item:!0,xs:2,children:Object(s.jsxs)("div",{className:"entryDiv",onMouseOver:function(){return w(!0)},onMouseLeave:function(){return w(!1)},children:[t.exclude.map((function(e,a){return a<3?Object(s.jsx)(U,{className:"leftMarginSmall",user:r.users[e],userIdx:Object.keys(r.users).indexOf(r.users[e].id),tooltipPlacement:"top"},e):3===a&&t.exclude.length>a?Object(s.jsx)(f.a,{className:"leftMarginSmall",children:"+".concat(t.exclude.length-3)},e):null})),!r.readOnly&&k&&Object(s.jsx)(m.a,{className:"iconButton largeIconButton leftMarginSmall",onClick:function(){return R(!0)},children:Object(s.jsx)(K.a,{})})]})}),Object(s.jsx)(O.a,{item:!0,xs:6,children:Object(s.jsx)("div",{className:"entryDiv",children:Object(s.jsx)(h.a,{className:"sideMargins",disableUnderline:!0,fullWidth:!0,readOnly:r.readOnly,value:A,placeholder:d?"Include a note here":void 0,onFocus:function(){return j(!1)},onChange:function(e){return T(e.target.value)},onBlur:function(e){ee(e.target.value,"note")}})})})]}),Object(s.jsx)(z,{open:W,setOpen:R,entry:t}),Object(s.jsx)(G,{open:Z,setOpen:Y,entry:t}),Object(s.jsx)(X,{open:Q,setOpen:_,entry:t})]})},q=function(){return Object(s.jsxs)(O.a,{className:"gridHeader",container:!0,spacing:0,children:[Object(s.jsx)(O.a,{item:!0,xs:3,children:Object(s.jsx)("span",{className:"leftMargin",children:"ITEM"})}),Object(s.jsx)(O.a,{item:!0,xs:1,children:Object(s.jsx)("span",{className:"leftMargin",children:"COST"})}),Object(s.jsx)(O.a,{item:!0,xs:2,children:Object(s.jsx)("span",{className:"leftMargin",children:"EXCLUDE"})}),Object(s.jsx)(O.a,{item:!0,xs:6,children:Object(s.jsx)("span",{className:"leftMargin",children:"NOTE"})})]})},J=function(){var e=Object(c.useContext)(mt).userState,t=Object(c.useContext)(st).sheetState,a=0;return Object(s.jsxs)("div",{className:"entries",children:[Object(s.jsx)(q,{}),e.authenticated&&t.entries.map((function(t){var n,c;return(t.user===(null===(n=e.curUser)||void 0===n?void 0:n.id)||t.createdBy===(null===(c=e.curUser)||void 0===c?void 0:c.id)||t.item||t.cost||t.note)&&Object(s.jsx)(Y,{entry:t,rowIdx:a++},t.id)}))]})},Q=a(199),_=a.n(Q),ee=a(198),te=a.n(ee),ae=function(e){var t=e.saveState;return Object(s.jsx)("span",{id:"autosaveMessage",children:t===n.Unsaved?Object(s.jsx)(s.Fragment,{}):t===n.Saving?Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(te.a,{fontSize:"small"}),Object(s.jsx)("p",{className:"leftMarginSmall",children:"Saving..."})]}):Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(_.a,{fontSize:"small"}),Object(s.jsx)("p",{className:"leftMarginSmall",children:"Saved to Cloud"})]})})},ne=function(e){var t=e.saveState,a=Object(c.useContext)(st).sheetState;return Object(s.jsx)(O.a,{container:!0,spacing:0,children:Object(s.jsxs)(O.a,{className:"header",item:!0,xs:12,children:[Object(s.jsxs)("span",{className:"leftMargin",children:["split the cost | ",Object(s.jsx)("b",{children:a.title})]}),Object(s.jsx)(ae,{saveState:t})]})})},se=a(380),ce=function(e){var t=e.open,a=e.setOpen,n=Object(c.useContext)(st),r=n.sheetState,i=n.sheetDispatch,l=Object(c.useState)(""),u=Object(o.a)(l,2),d=u[0],j=u[1],b=Object(c.useState)(!0),O=Object(o.a)(b,2),h=O[0],m=O[1],x=Object(c.useState)(""),f=Object(o.a)(x,2),p=f[0],v=f[1],g=Object(c.useState)(!0),y=Object(o.a)(g,2),S=y[0],C=y[1],k=Object(c.useState)(!0),w=Object(o.a)(k,2),U=w[0],D=w[1];function P(){j(""),v(""),m(!0),C(!0),D(!0)}function T(){P(),a(!1)}function L(){r.numUsers>=10||!function(e,t){var a=e.trim().toLocaleLowerCase(),n=t.trim().toLocaleLowerCase(),s=N(a),c=N(n);if(m(s),C(c),!s||!c)return!1;var i=!0;return Object.entries(r.users).forEach((function(e){var t=e[1];t.firstName.toLocaleLowerCase()===a&&t.lastName.toLocaleLowerCase()===n&&(i=!1)})),D(i),i}(d,p)||(i({type:"addUser",firstName:d.trim(),lastName:p.trim(),email:""}),P(),a(!1))}return Object(s.jsxs)(I.a,{fullWidth:!0,disableBackdropClick:!0,maxWidth:"xs",onClose:T,open:t,onKeyPress:function(e){return M(e,"enter",L)},PaperProps:{className:"modal"},children:[Object(s.jsx)(W,{title:"Add a Friend",onClose:T}),Object(s.jsx)(E.a,{children:Object(s.jsxs)("div",{className:"modalInputRow",children:[Object(s.jsx)(se.a,{className:"halfWidthModalInput",autoFocus:!0,label:"First Name",value:d,onChange:function(e){return j(e.target.value)},error:!h||!U,helperText:h?!U&&"Duplicate users not allowed.":"Please enter a valid name."}),Object(s.jsx)(se.a,{className:"halfWidthModalInput",label:"Last Name",value:p,onChange:function(e){return v(e.target.value)},error:!S||!U,helperText:S?!U&&"Duplicate users not allowed.":"Please enter a valid name."})]})}),Object(s.jsx)(B.a,{className:"modalActions",children:Object(s.jsx)(A.a,{className:"modalConfirmButton rightMarginSmall",onClick:L,children:"Confirm"})})]})},re=a(374),ie=a(375),oe=a(133),le=(a(231),a(329),oe.a.initializeApp({apiKey:"AIzaSyCdGdwOcnXkNjD7-wLbhWQuXXdn4nUqHc8",authDomain:"split-the-cost-176bf.firebaseapp.com",projectId:"split-the-cost-176bf",storageBucket:"split-the-cost-176bf.appspot.com",messagingSenderId:"887247853169",appId:"1:887247853169:web:de028bf83a3c0f8ba6add0"})),ue={toFirestore:function(e){return{id:e.id,timestamp:e.timestamp,lastAccessed:e.lastAccessed,lastEdited:e.lastEdited,title:e.title,entries:e.entries,users:e.users,numUsers:e.numUsers,createdBy:e.createdBy,readOnly:!!e.readOnly&&e.readOnly,customLink:e.customLink?e.customLink:"",password:e.password?e.password:""}},fromFirestore:function(e,t){var a=e.data(t);return{id:a.id,timestamp:a.timestamp,lastAccessed:a.lastAccessed,lastEdited:a.lastEdited,title:a.title,entries:a.entries,users:a.users,numUsers:a.numUsers,createdBy:a.createdBy,local:!1,readOnly:a.readOnly,customLink:a.customLink,password:a.password?a.password:""}}},de=(le.auth(),le.firestore()),je=(new oe.a.auth.GoogleAuthProvider,a(22)),be=a(203),Oe=a.n(be),he=a(92),me=a.n(he),xe=a(202),fe=a.n(xe),pe=a(201),ve=a.n(pe),ge=a(200),ye=a.n(ge),Ne=function(e){var t=e.open,a=e.setOpen,n=Object(c.useContext)(st),r=n.sheetState,i=n.sheetDispatch,l=Object(je.f)(),u=Object(c.useState)(r.title),j=Object(o.a)(u,2),h=j[0],x=j[1],f=Object(c.useState)(!1),p=Object(o.a)(f,2),v=p[0],g=p[1],N=Object(c.useState)(!0),w=Object(o.a)(N,2),M=w[0],U=w[1],D=Object(c.useState)(r.customLink?r.customLink:r.id),P=Object(o.a)(D,2),B=P[0],T=P[1],L=Object(c.useState)(!1),R=Object(o.a)(L,2),H=R[0],z=R[1],$=Object(c.useState)(!0),V=Object(o.a)($,2),Z=V[0],G=V[1],X=Object(c.useState)(!0),Y=Object(o.a)(X,2),q=Y[0],J=Y[1],Q=Object(c.useState)(r.readOnly),_=Object(o.a)(Q,2),ee=_[0],te=_[1],ae=Object(c.useState)(""),ne=Object(o.a)(ae,2),ce=ne[0],oe=ne[1],le=Object(c.useState)(!1),ue=Object(o.a)(le,2),be=ue[0],he=ue[1],xe=Object(c.useState)(!0),pe=Object(o.a)(xe,2),ge=pe[0],Ne=pe[1],Se=Object(c.useState)(!1),Ce=Object(o.a)(Se,2),ke=Ce[0],we=Ce[1],Me=Object(c.useState)(""),Ue=Object(o.a)(Me,2),De=Ue[0],Ie=Ue[1],Ee=Object(c.useState)(!0),Pe=Object(o.a)(Ee,2),Be=Pe[0],Ae=Pe[1],Te=Object(c.useState)(""),Le=Object(o.a)(Te,2),Fe=Le[0],We=Le[1],Re=Object(c.useState)(!1),He=Object(o.a)(Re,2),ze=He[0],$e=He[1],Ke=Object(c.useState)(!1),Ve=Object(o.a)(Ke,2),Ze=Ve[0],Ge=Ve[1];function Xe(){a(!1),qe(),_e(),nt(),ot()}function Ye(){v?function(){if(h.trim()===r.title)return void qe();if(!S(h.trim()))return void U(!1);g(!1),U(!0),i({type:"changeSheetTitle",title:h.trim()})}():g(!0)}function qe(){g(!1),U(!0),x(r.title)}function Je(){H?function(){Qe.apply(this,arguments)}():z(!0)}function Qe(){return(Qe=Object(b.a)(d.a.mark((function e(){var t,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=B.trim())!==r.customLink&&t!==r.id){e.next=4;break}return _e(),e.abrupt("return");case 4:if(a=C(t),G(a),a){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,de.collection("customLinks").doc(t).get();case 10:if(!e.sent.exists){e.next=14;break}return J(!1),e.abrupt("return");case 14:return e.next=16,de.collection("sheets").doc(t).get();case 16:if(!e.sent.exists){e.next=20;break}return J(!1),e.abrupt("return");case 20:z(!1),G(!0),J(!0),i({type:"changeSheetLink",link:t}),l.push("/sheet/".concat(B));case 25:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _e(){z(!1),G(!0),J(!0),T(r.customLink?r.customLink:r.id)}function et(){navigator.clipboard.writeText("splitthecost.net/#/sheet/".concat(r.customLink?r.customLink:r.id))}function tt(e){i({type:"updateReadOnly",readOnly:e.target.checked})}function at(){be?function(){if(!ce)return void nt();if(Ne(k(ce)),!k(ce))return;if(Ae(ce===De),ce!==De)return;i({type:"updateSheetPassword",password:ce}),nt()}():he(!0)}function nt(){he(!1),Ae(!0),Ne(!0),oe(""),Ie("")}function ct(){r.password&&i({type:"removeSheetPassword"}),nt()}function rt(){ze?function(){it.apply(this,arguments)}():$e(!0)}function it(){return(it=Object(b.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Fe.trim()){e.next=3;break}return ot(),e.abrupt("return");case 3:if(Fe===r.title){e.next=6;break}return Ge(!0),e.abrupt("return");case 6:i({type:"deleteSheet"}),l.push("/"),ot();case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ot(){Ge(!1),$e(!1),We("")}return Object(c.useEffect)((function(){x(r.title),T(r.customLink?r.customLink:r.id),te(r.readOnly)}),[r.title,r.customLink,r.id,r.readOnly]),Object(s.jsxs)(I.a,{fullWidth:!0,disableBackdropClick:!0,maxWidth:"sm",onClose:Xe,open:t,PaperProps:{className:"modal"},children:[Object(s.jsx)(W,{title:"Settings",onClose:Xe}),Object(s.jsx)(E.a,{className:"modalContent",children:Object(s.jsxs)(O.a,{container:!0,spacing:0,alignItems:"center",children:[Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(O.a,{className:"bottomMargin",item:!0,xs:8,children:Object(s.jsx)(se.a,{fullWidth:!0,inputRef:function(e){return e&&v&&e.focus()},value:h,error:!M,label:"Sheet Title",onChange:function(e){return x(e.target.value)},helperText:M?"":"Title must be between 3-40 characters (select special characters are allowed).",InputProps:{readOnly:!v,disableUnderline:!v}})}),Object(s.jsxs)(O.a,{container:!0,item:!0,xs:4,justify:"flex-end",children:[v&&Object(s.jsx)(m.a,{onClick:qe,children:Object(s.jsx)(F.a,{})}),Object(s.jsx)(m.a,{onClick:Ye,children:v?Object(s.jsx)(me.a,{}):Object(s.jsx)(K.a,{})})]})]}),!r.local&&Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(O.a,{className:"bottomMargin",item:!0,xs:8,children:Object(s.jsx)(se.a,{fullWidth:!0,inputRef:function(e){return e&&H&&e.focus()},value:B,error:!Z||!q,label:"Custom Sheet Link",onChange:function(e){return T(e.target.value)},helperText:Z?q?"":"This custom link is already in use.":"Link must be between 5-20 characters and contain only letters and numbers.",InputProps:{readOnly:!H,disableUnderline:!H,startAdornment:Object(s.jsx)("b",{children:"splitthecost.net/#/"})}})}),Object(s.jsxs)(O.a,{container:!0,item:!0,xs:4,justify:"flex-end",children:[Object(s.jsx)(y.a,{arrow:!0,title:"Copy Link",placement:"left",children:Object(s.jsx)(m.a,{onClick:et,children:Object(s.jsx)(ye.a,{})})}),H&&Object(s.jsx)(m.a,{onClick:_e,children:Object(s.jsx)(F.a,{})}),Object(s.jsx)(m.a,{onClick:Je,children:H?Object(s.jsx)(me.a,{}):Object(s.jsx)(K.a,{})})]})]}),Object(s.jsx)(O.a,{item:!0,xs:12,children:Object(s.jsx)(re.a,{control:Object(s.jsx)(ie.a,{checked:ee,onChange:tt,color:"primary"}),label:"Read Only"})}),!r.local&&Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(O.a,{className:"bottomMargin",item:!0,xs:8,children:Object(s.jsx)(se.a,{fullWidth:!0,value:ce,error:!ge,label:"Sheet Password",placeholder:"Enter new sheet password here",onChange:function(e){return oe(e.target.value)},helperText:ge?"":"Password must be between 5-25 characters and can only contain these special characters (!, @, #, $, %).",InputProps:{readOnly:!be,disableUnderline:!be,type:ke?"default":"password"}})}),Object(s.jsxs)(O.a,{container:!0,item:!0,xs:4,justify:"flex-end",children:[Object(s.jsx)(y.a,{arrow:!0,title:ke?"Hide Password":"View Password",placement:"left",children:Object(s.jsx)(m.a,{onClick:function(){return we(!ke)},children:ke?Object(s.jsx)(ve.a,{}):Object(s.jsx)(fe.a,{})})}),be&&Object(s.jsx)(m.a,{onClick:nt,children:Object(s.jsx)(F.a,{})}),Object(s.jsx)(m.a,{onClick:at,children:be?Object(s.jsx)(me.a,{}):Object(s.jsx)(K.a,{})})]}),be&&Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(O.a,{className:"bottomMargin",item:!0,xs:8,children:Object(s.jsx)(se.a,{fullWidth:!0,value:De,error:!Be,placeholder:"Confirm Password",onChange:function(e){return Ie(e.target.value)},helperText:Be?"":"Passwords don't match.",InputProps:{readOnly:!be,disableUnderline:!be,type:ke?"default":"password"}})}),Object(s.jsx)(O.a,{className:"bottomMargin",container:!0,item:!0,xs:4,justify:"flex-end",children:Object(s.jsx)(A.a,{color:"secondary",onClick:ct,children:"REMOVE PASSWORD"})})]})]}),!r.local&&Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(O.a,{className:"bottomMargin",item:!0,xs:8,children:Object(s.jsx)(se.a,{fullWidth:!0,inputRef:function(e){return e&&ze&&e.focus()},value:Fe,placeholder:"Enter sheet name to confirm deletion.",error:Ze,label:"Delete Sheet",onChange:function(e){return We(e.target.value)},helperText:Ze?"Please enter the sheet name correctly (".concat(r.title,")"):"",InputProps:{readOnly:!ze,disableUnderline:!ze}})}),Object(s.jsxs)(O.a,{container:!0,item:!0,xs:4,justify:"flex-end",children:[ze&&Object(s.jsx)(m.a,{onClick:ot,children:Object(s.jsx)(F.a,{})}),Object(s.jsx)(m.a,{onClick:rt,children:ze?Object(s.jsx)(me.a,{}):Object(s.jsx)(Oe.a,{})})]})]})]})})]})},Se=function(e){var t=e.removeUser,a=e.open,n=e.setOpen,r=Object(c.useContext)(st),i=r.sheetState,o=r.sheetDispatch;function l(){n(!1)}function u(){t.id!==i.createdBy&&o({type:"removeUser",userId:t.id}),n(!1)}return Object(s.jsxs)(I.a,{fullWidth:!0,disableBackdropClick:!0,maxWidth:"xs",onClose:l,open:a,onKeyPress:function(e){return M(e,"enter",u)},PaperProps:{className:"modal"},children:[Object(s.jsx)(W,{title:"Remove Friend",onClose:l}),Object(s.jsxs)(E.a,{children:["Are you sure you want to remove ",Object(s.jsx)("b",{children:t.displayName})," and all associated entries from this sheet?"]}),Object(s.jsx)(B.a,{className:"modalActions",children:Object(s.jsx)(A.a,{className:"modalConfirmButton rightMarginSmall",onClick:u,children:"Confirm"})})]})},Ce=function(e){var t=e.open,a=e.setOpen,n=Object(c.useContext)(st),r=n.sheetState,i=n.sheetDispatch,l=Object(je.f)(),u=Object(c.useState)(""),j=Object(o.a)(u,2),h=j[0],m=j[1];function x(){a(!1)}function f(){return(f=Object(b.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.local){e.next=6;break}return m("SAVING"),e.next=4,new Promise((function(e){return setTimeout(e,500)}));case 4:i({type:"saveSheet"}),l.push("/sheet/".concat(r.id));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(c.useEffect)((function(){m(r.local?"SAVE":"SAVED")}),[r.local]),Object(s.jsxs)(I.a,{fullWidth:!0,disableBackdropClick:!0,maxWidth:"xs",onClose:x,open:t,PaperProps:{className:"modal"},children:[Object(s.jsx)(W,{title:"Save Sheet",onClose:x}),Object(s.jsx)(E.a,{className:"modalContent bottomMargin",children:Object(s.jsx)(O.a,{container:!0,spacing:0,alignItems:"center",children:"Would you like to save this sheet to the cloud for future access?"})}),Object(s.jsx)(B.a,{className:"modalActions",children:Object(s.jsx)(A.a,{className:"modalConfirmButton rightMarginSmall",disabled:!r.local,onClick:function(){return f.apply(this,arguments)},children:h})})]})},ke=a(107),we=a.n(ke),Me=a(205),Ue=a.n(Me),De=a(204),Ie=a.n(De),Ee=function(){var e,t=Object(c.useContext)(mt).userState,a=Object(c.useContext)(st).sheetState,n=Object(c.useState)(!1),r=Object(o.a)(n,2),i=r[0],l=r[1],u=Object(c.useState)(!1),d=Object(o.a)(u,2),j=d[0],b=d[1],h=Object(c.useState)(!1),x=Object(o.a)(h,2),f=x[0],p=x[1],v=Object(c.useState)(!1),g=Object(o.a)(v,2),N=g[0],S=g[1],C=Object(c.useState)(),k=Object(o.a)(C,2),w=k[0],M=k[1];function U(){l(!0)}function D(e){M(e),b(!0)}return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsxs)(O.a,{className:"usersBar",container:!0,spacing:0,children:[Object(s.jsx)(O.a,{item:!0,container:!0,xs:11,alignItems:"center",children:t.authenticated&&Object(s.jsxs)(s.Fragment,{children:[t.curUser&&Object(s.jsx)(H,{className:"leftMargin bottomMargin",user:t.curUser,userIdx:Object.keys(a.users).indexOf(t.curUser.id)}),Object.entries(a.users).map((function(e){var n=e[1];return(!t.curUser||n.id!==t.curUser.id)&&Object(s.jsx)(H,{className:"leftMargin bottomMargin",user:n,userIdx:Object.keys(a.users).indexOf(n.id),onRemove:!a.readOnly&&t.curUser&&a.createdBy!==n.id?D:void 0},n.id)})),!a.readOnly&&t.curUser&&Object.keys(a.users).length<10&&Object(s.jsx)(y.a,{arrow:!0,title:"Add Friend",placement:"right",children:Object(s.jsx)(m.a,{className:"iconButton smallIconButton leftMargin bottomMargin",onClick:U,children:Object(s.jsx)(we.a,{})})})]})}),Object(s.jsxs)(O.a,{item:!0,container:!0,xs:1,justify:"flex-end",alignItems:"center",children:[a.local&&Object(s.jsx)(y.a,{arrow:!0,title:"Save Sheet",placement:"left",children:Object(s.jsx)(m.a,{className:"iconButton smallIconButton rightMargin bottomMargin",onClick:function(){S(!0)},children:Object(s.jsx)(Ie.a,{})})}),(null===(e=t.curUser)||void 0===e?void 0:e.id)===a.createdBy&&Object(s.jsx)(y.a,{arrow:!0,title:"Settings",placement:"left",children:Object(s.jsx)(m.a,{className:"iconButton smallIconButton rightMargin bottomMargin",onClick:function(){p(!0)},children:Object(s.jsx)(Ue.a,{})})})]})]}),Object(s.jsx)(ce,{open:i,setOpen:l}),Object(s.jsx)(Ne,{open:f,setOpen:p}),w&&Object(s.jsx)(Se,{removeUser:w,open:j,setOpen:b}),Object(s.jsx)(Ce,{open:N,setOpen:S})]})},Pe=function(){return Object(s.jsxs)(O.a,{className:"gridHeader roundedTop",container:!0,spacing:0,children:[Object(s.jsx)(O.a,{item:!0,xs:2}),Object(s.jsx)(O.a,{item:!0,xs:5,children:Object(s.jsx)("span",{className:"leftMargin",children:"TOTAL SPENT"})}),Object(s.jsx)(O.a,{item:!0,xs:5,children:Object(s.jsx)("span",{className:"leftMargin",children:"TOTAL OWED"})})]})},Be=function(e){var t=e.user,a=e.data,n=e.idx,r=Object(c.useContext)(st).sheetState;return Object(s.jsxs)(O.a,{className:"".concat(n%2?"lightRow":"darkRow"," ").concat(n===r.numUsers-1&&"roundedBottom"),container:!0,spacing:0,children:[Object(s.jsx)(O.a,{className:"sideDialogRow",item:!0,xs:2,children:Object(s.jsx)(U,{className:"leftMargin",user:t,userIdx:Object.keys(r.users).indexOf(t.id),tooltipPlacement:"left"})}),Object(s.jsx)(O.a,{className:"sideDialogRow",item:!0,xs:5,children:Object(s.jsx)(h.a,{className:"sideMargins",readOnly:!0,disableUnderline:!0,fullWidth:!0,value:a?null===a||void 0===a?void 0:a.totalSpent.toFixed(2):0,startAdornment:Object(s.jsx)(x.a,{position:"start",children:"$"})})}),Object(s.jsx)(O.a,{className:"sideDialogRow",item:!0,xs:5,children:Object(s.jsx)(s.Fragment,{children:Object(s.jsx)(h.a,{readOnly:!0,disableUnderline:!0,fullWidth:!0,className:"sideMargins",value:a?null===a||void 0===a?void 0:a.totalOwed.toFixed(2):0,startAdornment:Object(s.jsx)(x.a,{position:"start",children:"$"})})})})]})},Ae=function(){var e=Object(c.useContext)(st).sheetState,t=Object(c.useContext)(mt).userState,a=Object(c.useState)({}),n=Object(o.a)(a,2),r=n[0],i=n[1],l=0;return Object(c.useEffect)((function(){i(function(e,t){var a={};return Object.entries(t).forEach((function(e){var t=e[1];a[t.id]={totalSpent:0,totalOwed:0}})),e.forEach((function(e){a[e.user].totalSpent+=e.cost;var n=Object.keys(t).filter((function(t){return!e.exclude.includes(t)})),s=e.cost/n.length;n.forEach((function(t){t!==e.user&&(a[t].totalOwed+=s)}))})),a}(e.entries,e.users))}),[e]),Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(Pe,{}),t.curUser&&Object(s.jsx)(Be,{user:t.curUser,data:r[t.curUser.id],idx:l++}),Object.entries(e.users).map((function(e){var a,n=e[1];return n.id!==(null===(a=t.curUser)||void 0===a?void 0:a.id)&&Object(s.jsx)(Be,{user:n,data:r[n.id],idx:l++},n.id)}))]})},Te=a(207),Le=a.n(Te),Fe=a(206),We=a.n(Fe),Re=a(381),He=a(376),ze=a(378),$e=function(){return Object(s.jsxs)(O.a,{className:"gridHeader roundedTop",container:!0,spacing:0,children:[Object(s.jsx)(O.a,{item:!0,xs:8,children:Object(s.jsx)("span",{className:"leftMargin",children:"TRANSACTIONS"})}),Object(s.jsx)(O.a,{item:!0,xs:4,children:Object(s.jsx)("span",{className:"leftMargin",children:"TOTAL"})})]})},Ke=function(e){var t=e.user,a=e.data,n=e.idx,r=Object(c.useContext)(st).sheetState,i=Object(c.useContext)(mt).userState,o=a?a.theyOwe-a.youOwe:0,l=o<0?i.curUser:t,u=o<0?t:i.curUser;return Object(s.jsxs)(O.a,{className:"".concat(n%2?"lightRow":"darkRow"," ").concat(n===r.numUsers-2&&"roundedBottom"),container:!0,spacing:0,children:[Object(s.jsx)(O.a,{className:"sideDialogRow",item:!0,xs:2,children:Object(s.jsx)(U,{className:"leftMargin",user:l,userIdx:Object.keys(r.users).indexOf(l.id),tooltipPlacement:"left"})}),Object(s.jsx)(O.a,{className:"sideDialogRow",item:!0,xs:4,children:0===o?Object(s.jsx)("div",{className:"leftMargin evenArrow",children:Object(s.jsx)("span",{children:"EVEN"})}):Object(s.jsx)("div",{className:"arrow ".concat(o<0?"redArrow":"greenArrow"),children:Object(s.jsx)("span",{className:"leftMarginSmall",children:o<0?"YOU OWE":"OWES YOU"})})}),Object(s.jsx)(O.a,{className:"sideDialogRow",item:!0,xs:2,children:Object(s.jsx)(U,{user:u,userIdx:Object.keys(r.users).indexOf(u.id),tooltipPlacement:"top"})}),Object(s.jsx)(O.a,{className:"sideDialogRow",item:!0,xs:4,children:Object(s.jsx)(h.a,{className:"sideMargins",readOnly:!0,disableUnderline:!0,fullWidth:!0,inputComponent:g.a,inputProps:{decimalScale:2,allowNegative:!1,thousandSeparator:","},value:Math.abs(o).toFixed(2),startAdornment:Object(s.jsx)(x.a,{position:"start",children:"$"})})})]})},Ve=function(){var e=Object(c.useContext)(st).sheetState,t=Object(c.useContext)(mt).userState,a=Object(c.useState)(),n=Object(o.a)(a,2),r=n[0],i=n[1],l=0;return Object(c.useEffect)((function(){t.curUser&&i(function(e,t,a){var n={user:e,totalSpent:0,totalOwed:0,userBreakdown:{}};return Object.entries(a).forEach((function(t){var a=t[1];a!==e&&(n.userBreakdown[a.id]={theyOwe:0,youOwe:0})})),t.forEach((function(t){var s=Object.keys(a).length-t.exclude.length;t.user===e.id?(n.totalSpent+=t.cost,Object.keys(a).filter((function(e){return!t.exclude.includes(e)&&e!==t.user})).forEach((function(e){n.userBreakdown[e].theyOwe+=t.cost/s}))):t.exclude.includes(e.id)||(n.totalOwed+=t.cost/s,n.userBreakdown[t.user].youOwe+=t.cost/s)})),n}(t.curUser,e.entries,e.users))}),[t.curUser,e]),!t.curUser||!r||e.numUsers<2?Object(s.jsx)("div",{className:"noBreakdownData",children:"No data to break down. \ud83e\udd74"}):Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)($e,{}),Object.entries(e.users).map((function(e){var a=e[1];return a.id!==t.curUser.id&&Object(s.jsx)(Ke,{user:a,data:r.userBreakdown[a.id],idx:l++},a.id)}))]})},Ze=a(137),Ge=a(377),Xe=function(){var e=Object(c.useState)(!0),t=Object(o.a)(e,2),a=t[0],n=t[1],r=Object(c.useState)("ov"),i=Object(o.a)(r,2),l=i[0],u=i[1];return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(V.a,{children:a&&Object(s.jsx)(V.b.div,{className:"sideDialog",animate:{x:0,opacity:1},initial:{x:600,opacity:0},exit:{x:600,opacity:0},transition:{duration:.3},children:Object(s.jsxs)(Ze.a,{value:l,children:[Object(s.jsxs)(Re.a,{value:l,onChange:function(e,t){u(t)},indicatorColor:"primary",textColor:"primary",children:[Object(s.jsx)(He.a,{className:"sideDialogTab",value:"ov",label:"OVERVIEW"}),Object(s.jsx)(He.a,{className:"sideDialogTab",value:"bd",label:"BREAKDOWN"})]}),Object(s.jsx)(V.b.div,{animate:"ov"===l?{opacity:1}:{opacity:0},transition:{duration:.7},children:Object(s.jsx)(Ge.a,{className:"sideDialogContent",value:"ov",children:Object(s.jsx)(Ae,{})})}),Object(s.jsx)(V.b.div,{animate:"bd"===l?{opacity:1}:{opacity:0},transition:{duration:.7},children:Object(s.jsx)(Ge.a,{className:"sideDialogContent",value:"bd",children:Object(s.jsx)(Ve,{})})})]})})}),Object(s.jsx)(V.b.div,{className:"sideDialogFab",animate:a?{x:-440}:{x:0},transition:{duration:.3},children:Object(s.jsx)(ze.a,{variant:"extended",size:"medium",onClick:function(){n(!a)},children:a?Object(s.jsx)(We.a,{}):Object(s.jsx)(Le.a,{})})})]})},Ye=function(){var e=Object(c.useContext)(st).sheetDispatch,t=Object(c.useContext)(mt).userState;return Object(s.jsx)("div",{className:"addItemFabDiv",children:Object(s.jsxs)(ze.a,{className:"addItemFab",variant:"extended",size:"medium",onClick:function(){e({type:"addEntry",createdBy:t.curUser.id,item:"",cost:0,exclude:[],note:""})},children:[Object(s.jsx)(we.a,{}),Object(s.jsx)("span",{className:"leftMarginSmall",children:"Add Expense"})]})})},qe=a(66);function Je(e,t){switch(t.type){case"addEntry":return function(e,t){var a={id:Object(qe.a)(),timestamp:new Date(Date.now()).toUTCString(),lastEdited:Date.now(),item:t.item?t.item:"",cost:t.cost?t.cost:0,exclude:t.exclude?t.exclude:[],note:t.note?t.note:"",user:t.createdBy,createdBy:t.createdBy},n=Object(l.a)(Object(l.a)({},e),{},{entries:[].concat(Object(D.a)(e.entries),[a]),lastEdited:Date.now()});return Qe(n,t.local),n}(e,t);case"removeEntry":return function(e,t){var a=e.entries.filter((function(e){return e.id!==t.entryId})),n=Object(l.a)(Object(l.a)({},e),{},{entries:a,lastEdited:Date.now()});return Qe(n,t.local),n}(e,t);case"updateEntry":return function(e,t){var a=t.entry,n=t.value,s=Object(l.a)(Object(l.a)({},a),{},{lastEdited:Date.now()});if("item"===t.section){if(a.item===n)return e;s=Object(l.a)(Object(l.a)({},s),{},{item:n})}else if("cost"===t.section)s=Object(l.a)(Object(l.a)({},s),{},{cost:Number(n.replaceAll(",",""))});else if("user"===t.section){if(a.user===n)return e;s=Object(l.a)(Object(l.a)({},s),{},{user:n})}else{if(a.note===n)return e;s=Object(l.a)(Object(l.a)({},s),{},{note:n})}var c=Object(D.a)(e.entries);return c[c.indexOf(a)]=s,Object(l.a)(Object(l.a)({},e),{},{entries:c,lastEdited:Date.now()})}(e,t);case"addUser":return function(e,t){if(e.numUsers>=10)return e;var a=!1;if(Object.entries(e.users).forEach((function(e){var n=e[1];n.firstName===t.firstName&&n.lastName===t.lastName&&(a=!0)})),a)return e;var n={id:Object(qe.a)(),firstName:t.firstName,lastName:t.lastName,initials:"".concat(t.firstName.charAt(0)).concat(t.lastName.charAt(0)).toLocaleUpperCase(),displayName:"".concat(t.firstName," ").concat(t.lastName),email:t.email},s=Object(l.a)(Object(l.a)({},e),{},{users:Object(l.a)(Object(l.a)({},e.users),{},Object(j.a)({},n.id,n)),numUsers:e.numUsers+1,lastEdited:Date.now()});return Qe(s,t.local),s}(e,t);case"removeUser":return function(e,t){if(1===e.numUsers)return e;var a=Object(l.a)({},e.users);delete a[t.userId];var n=e.entries.filter((function(e){return e.createdBy!==t.userId&&e.user!==t.userId}));n.forEach((function(e,a){if(e.exclude.includes(t.userId)){var s=e.exclude.filter((function(e){return t.userId!==e})),c=Object(l.a)(Object(l.a)({},e),{},{exclude:s});n[a]=c}}));var s=Object(l.a)(Object(l.a)({},e),{},{entries:n,users:a,numUsers:e.numUsers-1,lastEdited:Date.now()});return Qe(s,t.local),s}(e,t);case"updateExcludedUsers":return function(e,t){var a=Object(l.a)(Object(l.a)({},t.entry),{},{exclude:t.exclude}),n=Object(D.a)(e.entries);n[n.indexOf(t.entry)]=a;var s=Object(l.a)(Object(l.a)({},e),{},{entries:n,lastEdited:Date.now()});return Qe(s,t.local),s}(e,t);case"removeExcludedUser":return function(e,t){var a=Object(l.a)(Object(l.a)({},t.entry),{},{exclude:t.entry.exclude.filter((function(e){return e!==t.userId}))}),n=Object(D.a)(e.entries);n[n.indexOf(t.entry)]=a;var s=Object(l.a)(Object(l.a)({},e),{},{entries:n,lastEdited:Date.now()});return Qe(s,t.local),s}(e,t);case"changeSheetTitle":return function(e,t){if(e.title===t.title)return e;var a=Object(l.a)(Object(l.a)({},e),{},{title:t.title,lastEdited:Date.now()});return Qe(a),a}(e,t);case"changeSheetLink":return function(e,t){if(!t.link||e.customLink===t.link||t.link.length<5)return e;e.customLink&&de.collection("customLinks").doc(e.customLink).delete();var a={sheetId:e.id};de.collection("customLinks").doc(t.link).set(a);var n=Object(l.a)(Object(l.a)({},e),{},{customLink:t.link,lastEdited:Date.now()});return Qe(n),n}(e,t);case"updateSheetPassword":return function(e,t){if(e.local)return e;var n=a(142),s=10;return n.hash(t.password,s,(function(t,a){if(!t){var n=Object(l.a)(Object(l.a)({},e),{},{password:a,lastEdited:Date.now()});return Qe(n),n}})),e}(e,t);case"removeSheetPassword":return function(e,t){if(e.password){var a=Object(l.a)(Object(l.a)({},e),{},{password:"",lastEdited:Date.now()});return Qe(a),a}return e}(e);case"saveSheet":return function(e,t){if(!e.local)return e;var a=Object(l.a)(Object(l.a)({},e),{},{local:!1,lastEdited:Date.now()});return Qe(a),a}(e);case"autosaveSheet":return function(e,t){Date.now()-e.lastEdited<11e3&&(t.setAutosaveState(n.Saving),Qe(e));return e}(e,t);case"updateReadOnly":return function(e,t){var a=Object(l.a)(Object(l.a)({},e),{},{readOnly:t.readOnly,lastEdited:Date.now()});return Qe(a),a}(e,t);case"deleteSheet":return function(e,t){if(e.local)return e;de.collection("deletedSheets").withConverter(ue).doc(e.id).set(e),de.collection("sheets").doc(e.id).delete(),e.customLink&&(de.collection("deletedCustomLinks").doc(e.customLink).set({sheetId:e.id}),de.collection("customLinks").doc(e.customLink).delete());return e}(e);case"updateSheetState":return t.sheetState;default:return e}}function Qe(e,t){t||e.local||de.collection("sheets").withConverter(ue).doc(e.id).set(e)}var _e,et=a(379),tt=function(e){var t=e.open,n=Object(c.useContext)(st).sheetState,r=Object(c.useContext)(mt),i=r.userState,l=r.userDispatch,u=Object(c.useState)(),d=Object(o.a)(u,2),j=d[0],b=d[1],O=Object(c.useState)(""),h=Object(o.a)(O,2),m=h[0],x=h[1],f=Object(c.useState)(!0),p=Object(o.a)(f,2),v=p[0],g=p[1];function y(){m?n.password?a(142).compare(m,n.password,(function(e,t){t?l({type:"setAuthStatus",authenticated:!0}):g(!1)})):l({type:"setAuthStatus",authenticated:!0}):g(!1)}function N(){j&&l({type:"updateCurUser",user:j})}function S(){i.authenticated?N():y()}return Object(s.jsxs)(I.a,{fullWidth:i.authenticated,disableBackdropClick:!0,maxWidth:"sm",open:t,onKeyPress:function(e){return M(e,"enter",S)},PaperProps:{className:"modal"},children:[Object(s.jsx)(W,{title:i.authenticated?"Who are You?":"Enter Sheet Password"}),i.authenticated?Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(E.a,{children:Object.keys(n.users).length?Object.entries(n.users).map((function(e){var t=e[1];return Object(s.jsx)(H,{className:"bottomMargin rightMargin ".concat((null===j||void 0===j?void 0:j.id)===t.id&&"selectedChip"),user:t,userIdx:Object.keys(n.users).indexOf(t.id),onClick:b},t.id)})):Object(s.jsx)("div",{className:"trueCenter",children:Object(s.jsx)(et.a,{})})}),Object(s.jsx)(B.a,{className:"modalActions",children:Object(s.jsx)(A.a,{className:"modalConfirmButton rightMarginSmall",disabled:!j,onClick:N,children:"Confirm"})})]}):Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(E.a,{children:Object(s.jsx)(se.a,{className:"bottomMargin",fullWidth:!0,label:"Password",onChange:function(e){return x(e.target.value)},error:!v,helperText:v?"":"This password is incorrect.",InputProps:{type:"password"}})}),Object(s.jsx)(B.a,{className:"modalActions",children:Object(s.jsx)(A.a,{className:"modalConfirmButton rightMarginSmall",disabled:!m,onClick:y,children:"Confirm"})})]})]})},at=function(){return Object(s.jsxs)("div",{className:"errorPage",children:[Object(s.jsx)("span",{className:"errorPageHeader",children:Object(s.jsx)("b",{children:"coming soon..."})}),Object(s.jsx)("span",{className:"errorPageSubtitle",children:"We're currently working on a mobile friendly version of splithecost - in the meantime, please visit us on a computer!"})]})},nt={title:"Loading Sheet...",timestamp:"",lastAccessed:0,lastEdited:0,entries:[],users:{},numUsers:0,createdBy:"",local:!0,readOnly:!0,id:""},st=Object(c.createContext)({sheetState:nt,sheetDispatch:function(){return null}}),ct=function(){var e=window.innerWidth<=1e3,t=Object(je.f)(),a=Object(je.g)(),r=Object(je.h)().sheetId,i=Object(c.useReducer)(Je,nt),u=Object(o.a)(i,2),O=u[0],h=u[1],m=Object(c.useContext)(mt),x=m.userState,f=m.userDispatch,p=Object(c.useState)(O.local?n.Unsaved:n.Saved),v=Object(o.a)(p,2),g=v[0],y=v[1];function N(){return(N=Object(b.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(O.local){e.next=5;break}return h({type:"autosaveSheet",setAutosaveState:y}),e.next=4,new Promise((function(e){return setTimeout(e,1500)}));case 4:y(n.Saved);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(){return(S=Object(b.a)(d.a.mark((function e(){var a,n,s,c,i,o,u;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,de.collection("sheets").withConverter(ue).doc(r).get();case 2:if(a=e.sent,!(n=a.data())){e.next=8;break}return h({type:"updateSheetState",sheetState:Object(l.a)(Object(l.a)({},n),{},{lastAccessed:Date.now(),readOnly:!1})}),f({type:"setAuthStatus",authenticated:!n.password}),e.abrupt("return");case 8:return e.next=10,de.collection("customLinks").doc(r).get();case 10:if(s=e.sent,!(c=s.data())){e.next=22;break}return i=c.sheetId,e.next=16,de.collection("sheets").withConverter(ue).doc(i).get();case 16:if(o=e.sent,!(u=o.data())){e.next=22;break}return h({type:"updateSheetState",sheetState:Object(l.a)(Object(l.a)({},u),{},{lastAccessed:Date.now()})}),f({type:"setAuthStatus",authenticated:!u.password}),e.abrupt("return");case 22:t.push({pathname:"/invalidsheet",state:{sheetId:r}});case 23:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(c.useEffect)((function(){r&&"new"!==r?function(){S.apply(this,arguments)}():function(){if(!x.curUser||!a.state.title)return void t.push("/create");var e={id:Object(qe.a)(10),timestamp:new Date(Date.now()).toUTCString(),lastAccessed:Date.now(),lastEdited:Date.now(),title:a.state.title,entries:[],users:Object(j.a)({},x.curUser.id,x.curUser),numUsers:1,createdBy:x.curUser.id,local:!0,readOnly:!1};h({type:"updateSheetState",sheetState:e}),h({type:"addEntry",createdBy:x.curUser.id})}()}),[]),Object(c.useEffect)((function(){y(O.local?n.Unsaved:n.Saved);var e=setInterval((function(){!function(){N.apply(this,arguments)}()}),1e4);return function(){return clearInterval(e)}}),[O.local]),Object(s.jsx)(st.Provider,{value:{sheetState:O,sheetDispatch:h},children:e?Object(s.jsx)(at,{}):Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(ne,{saveState:g}),Object(s.jsx)(Ee,{}),Object(s.jsx)(J,{}),x.authenticated&&Object(s.jsx)(Xe,{}),!O.readOnly&&x.curUser&&Object(s.jsx)(Ye,{}),Object(s.jsx)(tt,{open:!x.curUser})]})})},rt=a(29),it=a.p+"static/media/homepage.d372b9ab.png",ot=a.p+"static/media/blob.244efd39.svg",lt=function(){return window.innerWidth<1e3?Object(s.jsx)(at,{}):Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(O.a,{id:"homepageHeader",container:!0,alignContent:"center",children:Object(s.jsxs)(O.a,{item:!0,container:!0,xs:12,justify:"flex-end",children:[Object(s.jsx)(rt.b,{className:"noTextDecoration",to:"/",children:Object(s.jsx)("span",{className:"homepageLink",children:"about"})}),Object(s.jsx)(rt.b,{className:"noTextDecoration",to:"/",children:Object(s.jsx)("span",{className:"homepageLink",children:"contact"})})]})}),Object(s.jsxs)(O.a,{className:"homepage",container:!0,spacing:0,alignContent:"center",children:[Object(s.jsxs)(O.a,{item:!0,container:!0,xs:8,justify:"center",children:[Object(s.jsx)("img",{id:"homepageBlob",src:ot,alt:"blob"}),Object(s.jsx)("img",{id:"homepageImg",src:it,alt:"homepage"})]}),Object(s.jsx)(O.a,{item:!0,container:!0,xs:4,alignItems:"center",alignContent:"center",children:Object(s.jsxs)("div",{id:"homepageText",children:[Object(s.jsx)("span",{id:"homepageTitle",children:"welcome to splitthecost."}),Object(s.jsx)("span",{id:"homepageSubtitle",children:"shared expenses for trips/events made simple. no sign up required!"}),Object(s.jsx)(rt.b,{className:"noTextDecoration",to:"/create",children:Object(s.jsx)(A.a,{className:"createNewButton",children:"create new sheet"})})]})})]})]})};function ut(e,t){switch(t.type){case"updateCurUser":return function(e,t){return Object(l.a)(Object(l.a)({},e),{},{curUser:t.user})}(e,t);case"setDarkMode":return function(e,t){return Object(l.a)(Object(l.a)({},e),{},{darkMode:t.darkMode})}(e,t);case"setAuthStatus":return function(e,t){return Object(l.a)(Object(l.a)({},e),{},{authenticated:t.authenticated})}(e,t);default:return e}}!function(e){e[e.SheetName=1]="SheetName",e[e.DisplayName=2]="DisplayName"}(_e||(_e={}));var dt=function(){var e=Object(c.useContext)(mt).userDispatch,t=Object(je.f)(),a=Object(c.useState)(_e.SheetName),n=Object(o.a)(a,2),r=n[0],i=n[1],l=Object(c.useState)(""),u=Object(o.a)(l,2),d=u[0],j=u[1],b=Object(c.useState)(!0),h=Object(o.a)(b,2),x=h[0],f=h[1],p=Object(c.useState)(!1),v=Object(o.a)(p,2),g=v[0],y=v[1],C=Object(c.useState)(""),k=Object(o.a)(C,2),w=k[0],M=k[1],U=Object(c.useState)(!0),D=Object(o.a)(U,2),I=D[0],E=D[1],B=Object(c.useState)(""),T=Object(o.a)(B,2),L=T[0],W=T[1],R=Object(c.useState)(!0),H=Object(o.a)(R,2),z=H[0],$=H[1];function K(){var e=S(d);f(e),e&&i(_e.DisplayName)}function Z(){var a=N(w.trim()),n=N(L.trim());E(a),$(n),a&&n&&function(){var a=w.trim(),n=L.trim(),s={id:Object(qe.a)(),firstName:a,lastName:n,initials:"".concat(a.charAt(0)).concat(n.charAt(0)).toLocaleUpperCase(),displayName:"".concat(a," ").concat(n),email:""};e({type:"updateCurUser",user:s}),e({type:"setAuthStatus",authenticated:!0}),t.push({pathname:"/sheet/new",state:{title:d}})}()}function G(){return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("div",{className:"giantHeader",children:"Give your sheet a name:"}),Object(s.jsx)(se.a,{className:"giantTextField",fullWidth:!0,placeholder:"Sheet name",value:d,onChange:function(e){return j(e.target.value)},helperText:x?"":"Title must be between 3-40 characters (select special characters are allowed).",inputProps:{className:"giantInput"},FormHelperTextProps:{className:"giantInputHelperText"}}),Object(s.jsx)(re.a,{className:"termsAndConditions",control:Object(s.jsx)(P.a,{checked:g,onClick:function(){return y(!g)},color:"primary"}),label:Object(s.jsxs)(s.Fragment,{children:["I accept the SplitTheCost"," ",Object(s.jsx)(rt.b,{to:"/tos",target:"_blank",children:"terms"}),"."]})}),Object(s.jsx)(A.a,{className:"continueButton",disabled:!g,onClick:K,children:"continue"})]})}return Object(s.jsxs)(V.b.div,{initial:{x:2e3},animate:{x:0},transition:{type:"spring",duration:.8},children:[Object(s.jsxs)(O.a,{className:"createNewSheet",container:!0,spacing:0,children:[Object(s.jsx)(O.a,{item:!0,xs:1}),Object(s.jsx)(O.a,{className:"createNewSheetItem",item:!0,xs:8,children:r===_e.SheetName?G():r===_e.DisplayName?Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("div",{className:"giantHeader",children:"Yup, we're basically done. What's your name?"}),Object(s.jsxs)("div",{children:[Object(s.jsx)(se.a,{className:"giantTextField halfWidthModalInput",fullWidth:!0,placeholder:"First name",value:w,onChange:function(e){return M(e.target.value)},helperText:I?"":"Please enter a valid first name.",inputProps:{className:"giantInput"},FormHelperTextProps:{className:"giantInputHelperText"}}),Object(s.jsx)(se.a,{className:"leftMarginLarge giantTextField halfWidthModalInput",fullWidth:!0,placeholder:"Last name",value:L,onChange:function(e){return W(e.target.value)},helperText:z?"":"Please enter a valid last name.",inputProps:{className:"giantInput"},FormHelperTextProps:{className:"giantInputHelperText"}})]}),Object(s.jsxs)("div",{children:[Object(s.jsx)(A.a,{className:"continueButton",onClick:function(){i(r-1)},children:"go back"}),Object(s.jsx)(A.a,{className:"leftMargin continueButton",onClick:Z,children:"finish"})]})]}):G()})]}),Object(s.jsxs)("div",{className:"stepIndicator",children:[Object(s.jsx)(rt.b,{to:"/",children:Object(s.jsx)(m.a,{size:"small",children:Object(s.jsx)(F.a,{})})}),Object(s.jsxs)("span",{className:"leftMarginSmall",children:["Create a sheet (Step ",r," of 2)"]})]})]})},jt=function(){return Object(s.jsxs)("div",{className:"errorPage",children:[Object(s.jsxs)("span",{className:"errorPageHeader",children:[Object(s.jsx)("b",{children:"404"})," - this page doesn't exist."]}),Object(s.jsx)(rt.b,{className:"noTextDecoration",to:"/",children:Object(s.jsx)(A.a,{className:"createNewButton",children:"home"})})]})},bt=function(){var e,t=Object(je.g)();return Object(s.jsxs)("div",{className:"errorPage",children:[Object(s.jsxs)("span",{className:"errorPageHeader",children:["sorry, we couldn't find a sheet with id \"",Object(s.jsx)("b",{children:null===(e=t.state)||void 0===e?void 0:e.sheetId}),'".']}),Object(s.jsx)(rt.b,{className:"noTextDecoration",to:"/create",children:Object(s.jsx)(A.a,{className:"createNewButton",children:"create new sheet"})})]})},Ot=function(){return Object(s.jsxs)("div",{id:"tos",children:[Object(s.jsx)("h2",{children:"Terms of Service"}),Object(s.jsxs)("p",{children:["SplitTheCost stores all data in ",Object(s.jsx)("b",{children:"unencrypted plaintext"})," and is not responsible for the loss or unauthorized release of any data. In other words,"," ",Object(s.jsx)("b",{children:"don't use SplitTheCost for private or confidential information! "}),"SplitTheCost is not liable for any direct, indirect, incidental, consequential, or special damages or losses resulting from authorized or unauthorized use of or access to this platform.",Object(s.jsx)("br",{}),Object(s.jsx)("br",{}),"That's about it! Have fun and enjoy to your heart's desire."]})]})},ht={curUser:void 0,darkMode:!1,authenticated:!1},mt=Object(c.createContext)({userState:ht,userDispatch:function(){return null}});var xt=function(){var e=Object(c.useReducer)(ut,ht),t=Object(o.a)(e,2),a=t[0],n=t[1];return Object(s.jsx)(rt.a,{children:Object(s.jsx)(mt.Provider,{value:{userState:a,userDispatch:n},children:Object(s.jsxs)(je.c,{children:[Object(s.jsx)(je.a,{path:"/",exact:!0,component:lt}),Object(s.jsx)(je.a,{path:"/create",exact:!0,component:dt}),Object(s.jsx)(je.a,{path:"/sheet/:sheetId",exact:!0,component:ct}),Object(s.jsx)(je.a,{path:"/invalidsheet",exact:!0,component:bt}),Object(s.jsx)(je.a,{path:"/tos",exact:!0,component:Ot}),Object(s.jsx)(je.a,{component:jt})]})})})},ft=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,389)).then((function(t){var a=t.getCLS,n=t.getFID,s=t.getFCP,c=t.getLCP,r=t.getTTFB;a(e),n(e),s(e),c(e),r(e)}))};i.a.render(Object(s.jsx)(xt,{}),document.getElementById("root")),ft()}},[[326,1,2]]]);
//# sourceMappingURL=main.1e96f8fb.chunk.js.map