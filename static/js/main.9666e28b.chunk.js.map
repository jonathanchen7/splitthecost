{"version":3,"sources":["models/models.tsx","logic/logic.ts","components/bits/UserAvatar.tsx","components/modals/ModalHeader.tsx","components/bits/UserChip.tsx","components/modals/ExcludedUsersModal.tsx","components/modals/EntryUserModal.tsx","components/modals/RemoveEntryModal.tsx","components/entries/EntriesRow.tsx","components/entries/EntriesHeader.tsx","components/entries/Entries.tsx","components/bits/AutosaveMessage.tsx","components/header/Header.tsx","components/modals/AddUserModal.tsx","firebase.ts","components/modals/SettingsModal.tsx","components/modals/RemoveUserModal.tsx","components/modals/SaveSheetModal.tsx","components/users/UsersBar.tsx","components/dialog/overview/OverviewHeader.tsx","components/dialog/overview/OverviewRow.tsx","components/dialog/overview/Overview.tsx","components/dialog/breakdown/BreakdownHeader.tsx","components/dialog/breakdown/BreakdownRow.tsx","components/dialog/breakdown/Breakdown.tsx","components/dialog/SideDialog.tsx","components/bits/AddItemFab.tsx","actions/sheetActions.ts","components/pages/CreateNewSheet.tsx","components/modals/PasswordUserModal.tsx","components/pages/ViewOnDesktop.tsx","components/pages/SplitTheCost.tsx","assets/homepage.png","assets/blob.svg","components/pages/HomePage.tsx","actions/appUserActions.ts","components/pages/PageNotFound.tsx","components/pages/SheetNotFound.tsx","components/pages/TermsOfService.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["SaveState","validateName","name","length","test","validateSheetTitle","title","validateCustomSheetLink","link","validatePassword","password","getAvatarColor","user","userIdx","placeholder","colors","handleKeyPress","e","target","action","key","toLowerCase","UserAvatar","tooltipPlacement","onClick","iconOnHover","disabled","className","useState","hover","setHover","Tooltip","arrow","displayName","placement","Avatar","style","backgroundColor","cursor","onMouseEnter","onMouseLeave","initials","ModalHeader","subtitle","onClose","DialogTitle","IconButton","size","UserChip","onRemove","Chip","avatar","label","onDelete","id","ExcludedUsersModal","open","setOpen","entry","useContext","SheetContext","sheetState","sheetDispatch","exclude","excludedUsers","setExcludedUsers","confirmExcludeUsers","type","handleClose","handleClick","userId","includes","filter","useEffect","Dialog","fullWidth","disableBackdropClick","maxWidth","onKeyPress","PaperProps","item","DialogContent","Object","entries","users","map","pair","idx","Checkbox","checked","color","keys","indexOf","DialogActions","Button","EntryUserModal","entryUser","setEntryUser","confirmEntryUser","section","value","Radio","RemoveEntryModal","confirmRemoveEntry","entryId","EntriesRow","rowIdx","cost","note","emptyRow","setEmptyRow","showDelete","setShowDelete","showEdit","setShowEdit","setItem","setNote","showExcludeUsersModal","setShowExcludeUsersModal","showEntryUserModal","setShowEntryUserModal","showRemoveEntryModal","setShowRemoveEntryModal","updateEntry","local","Number","div","animate","x","opacity","initial","transition","duration","Grid","container","spacing","xs","onMouseOver","readOnly","undefined","Input","disableUnderline","onFocus","onChange","onBlur","toFixed","startAdornment","InputAdornment","position","inputComponent","NumberFormat","inputProps","decimalScale","allowNegative","thousandSeparator","allowLeadingZeros","EntriesHeader","Entries","userState","UserContext","authenticated","curUser","createdBy","AutosaveMessage","saveState","Unsaved","Saving","fontSize","Header","AddUserModal","firstName","setFirstName","validFirstName","setValidFirstName","lastName","setLastName","validLastName","setValidLastName","uniqueUser","setUniqueUser","resetDialog","confirmAddUser","numUsers","first","trim","toLocaleLowerCase","last","checkFirstName","checkLastName","unique","forEach","validateNewUser","email","TextField","autoFocus","error","helperText","fire","firebase","initializeApp","apiKey","process","authDomain","projectId","storageBucket","messagingSenderId","appId","sheetStateConverter","toFirestore","timestamp","lastAccessed","lastEdited","customLink","fromFirestore","snapshot","options","data","db","auth","firestore","GoogleAuthProvider","SettingsModal","history","useHistory","sheetTitle","setSheetTitle","editTitle","setEditTitle","validTitle","setValidTitle","sheetLink","setSheetLink","editLink","setEditLink","validLink","setValidLink","uniqueLink","setUniqueLink","setReadOnly","setPassword","editPassword","setEditPassword","validPassword","setValidPassword","viewPassword","setViewPassword","password2","setPassword2","passwordsMatch","setPasswordsMatch","deleteText","setDeleteText","editDelete","setEditDelete","deleteError","setDeleteError","cancelSheetTitle","cancelCustomLink","cancelPassword","cancelDeleteSheet","handleEditSheetTitle","confirmSheetTitle","handleEditCustomLink","confirmCustomLink","a","linkTrimmed","temp","collection","doc","get","exists","push","copySheetLink","navigator","clipboard","writeText","handleEditReadOnly","handleEditPassword","confirmPassword","removePassword","handleDeleteSheet","confirmDeleteSheet","alignItems","inputRef","titleRef","focus","InputProps","justify","linkRef","FormControlLabel","control","Switch","deleteRef","RemoveUserModal","removeUser","confirmRemoveUser","SaveSheetModal","buttonText","setButtonText","Promise","r","setTimeout","UsersBar","openAddUser","setOpenAddUser","openRemoveUser","setOpenRemoveUser","openSettings","setOpenSettings","openSaveSheet","setOpenSaveSheet","setRemoveUser","openAddUserModal","openRemoveUserModal","OverviewHeader","OverviewRow","totalSpent","totalOwed","Overview","overviewData","setOverviewData","validUsers","userCost","calculateOverview","BreakdownHeader","BreakdownRow","netCost","theyOwe","youOwe","debtedUser","owedUser","Math","abs","Breakdown","breakdownData","setBreakdownData","userBreakdown","numEntryUsers","calculateUserBreakdown","SideDialog","tab","setTab","exit","TabContext","Tabs","event","indicatorColor","textColor","Tab","TabPanel","Fab","variant","AddItemFab","sheetReducer","state","newEntry","nanoid","Date","now","toUTCString","newSheetState","updateFirestore","addEntry","newEntries","removeEntry","replaceAll","duplicateUser","newUser","charAt","toLocaleUpperCase","addUser","newUsers","newExcludedUsers","curId","updatedEntry","updateExcludedUsers","removeExcludedUser","changeSheetTitle","delete","firebaseLink","sheetId","set","changeSheetLink","bcrypt","require","saltRounds","hash","err","updateSheetPassword","removeSheetPassword","saveSheet","setAutosaveState","autosaveSheet","updateReadOnly","withConverter","deleteSheet","CreateSheetStep","PasswordUserModal","userDispatch","selectedUser","setSelectedUser","compare","res","confirmUser","handleEnter","CircularProgress","ViewOnDesktop","initialSheetState","createContext","SplitTheCost","isMobile","window","innerWidth","location","useLocation","useParams","useReducer","Saved","autosaveState","sheetSnapshot","fetchedSheetState","customLinkSnapshot","actualSheetId","customSheetSnapshot","customFetchedSheetState","pathname","fetchSheetState","generateNewSheetState","saveInterval","setInterval","clearInterval","Provider","HomePage","alignContent","src","blob","alt","homepage","to","userReducer","updateCurUser","darkMode","setDarkMode","setAuthStatus","CreateNewSheet","SheetName","step","setStep","agreeToTerms","setAgreeToTerms","handleTitleButton","DisplayName","handleNameButton","validFirst","validLast","createNewSheet","sheetNameStep","FormHelperTextProps","PageNotFound","SheetNotFound","TermsOfService","initialUserState","App","path","exact","component","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.9666e28b.chunk.js","sourcesContent":["export interface User {\r\n  id: string;\r\n  firstName: string;\r\n  lastName: string;\r\n  initials: string;\r\n  displayName: string;\r\n  email: string;\r\n}\r\n\r\nexport interface Entry {\r\n  id: string;\r\n  timestamp: string;\r\n  lastEdited: number;\r\n  item: string;\r\n  cost: number;\r\n  exclude: string[];\r\n  user: string;\r\n  createdBy: string;\r\n  note: string;\r\n}\r\n\r\nexport interface OverviewData {\r\n  [userId: string]: { totalSpent: number; totalOwed: number };\r\n}\r\n\r\nexport interface UserBreakdownData {\r\n  user: User;\r\n  totalSpent: number;\r\n  totalOwed: number;\r\n  userBreakdown: { [userId: string]: { youOwe: number; theyOwe: number } };\r\n}\r\n\r\nexport interface SheetSettings {\r\n  darkMode: boolean;\r\n  viewOnly: boolean;\r\n}\r\n\r\nexport interface SheetState {\r\n  id: string;\r\n  timestamp: string;\r\n  lastAccessed: number;\r\n  lastEdited: number;\r\n  title: string;\r\n  entries: Entry[];\r\n  users: { [userId: string]: User };\r\n  numUsers: number;\r\n  createdBy: string;\r\n  local: boolean;\r\n  readOnly: boolean;\r\n  customLink?: string;\r\n  password?: string;\r\n}\r\n\r\nexport interface UserState {\r\n  curUser: User | undefined;\r\n  darkMode: boolean;\r\n  authenticated: boolean;\r\n}\r\n\r\nexport enum SaveState {\r\n  Unsaved = 1,\r\n  Saving = 2,\r\n  Saved = 3,\r\n}\r\n","import { User, Entry, UserBreakdownData, OverviewData } from \"../models/models\";\r\n\r\n// Calculates and returns the breakdown data.\r\nexport function calculateUserBreakdown(\r\n  user: User,\r\n  entries: Entry[],\r\n  users: { [id: string]: User }\r\n): UserBreakdownData {\r\n  let breakdownData: UserBreakdownData = {\r\n    user: user,\r\n    totalSpent: 0,\r\n    totalOwed: 0,\r\n    userBreakdown: {},\r\n  };\r\n\r\n  Object.entries(users).forEach((pair) => {\r\n    let curUser = pair[1];\r\n    if (curUser !== user) {\r\n      breakdownData.userBreakdown[curUser.id] = { theyOwe: 0, youOwe: 0 };\r\n    }\r\n  });\r\n\r\n  entries.forEach((entry) => {\r\n    const numEntryUsers = Object.keys(users).length - entry.exclude.length;\r\n    if (entry.user === user.id) {\r\n      // This is the current user's entry. Add the cost to totalSpent and\r\n      // increment \"theyOwe\" for all valid users.\r\n      breakdownData.totalSpent += entry.cost;\r\n\r\n      const validUsers = Object.keys(users).filter(\r\n        (userId) => !entry.exclude.includes(userId) && userId !== entry.user\r\n      );\r\n      validUsers.forEach((userId) => {\r\n        breakdownData.userBreakdown[userId].theyOwe +=\r\n          entry.cost / numEntryUsers;\r\n      });\r\n    } else if (!entry.exclude.includes(user.id)) {\r\n      // This is another user's entry that you need to pay for. Add the cost to\r\n      // totalOwed and increment \"youOwe\" for this particular user.\r\n      breakdownData.totalOwed += entry.cost / numEntryUsers;\r\n      breakdownData.userBreakdown[entry.user].youOwe +=\r\n        entry.cost / numEntryUsers;\r\n    }\r\n  });\r\n\r\n  return breakdownData;\r\n}\r\n\r\n// Calculates and returns the overview data.\r\nexport function calculateOverview(\r\n  entries: Entry[],\r\n  users: { [id: string]: User }\r\n): OverviewData {\r\n  let overviewData: OverviewData = {};\r\n\r\n  // Create entries for each user.\r\n  Object.entries(users).forEach((pair) => {\r\n    let user = pair[1];\r\n    overviewData[user.id] = { totalSpent: 0, totalOwed: 0 };\r\n  });\r\n\r\n  entries.forEach((entry) => {\r\n    overviewData[entry.user].totalSpent += entry.cost;\r\n\r\n    const validUsers = Object.keys(users).filter(\r\n      (userId) => !entry.exclude.includes(userId)\r\n    );\r\n    const userCost = entry.cost / validUsers.length;\r\n\r\n    validUsers.forEach((userId) => {\r\n      if (userId !== entry.user) {\r\n        overviewData[userId].totalOwed += userCost;\r\n      }\r\n    });\r\n  });\r\n\r\n  return overviewData;\r\n}\r\n\r\n// Returns true if a name is valid, false otherwise.\r\n// Assumes the name has no leading/trailing whitespace.\r\nexport function validateName(name: string): boolean {\r\n  return (\r\n    name.length >= 1 && name.length <= 20 && /^[a-zA-Z'-\\s.()]+$/.test(name)\r\n  );\r\n}\r\n\r\n// Returns true if a sheet title is valid, false otherwise.\r\n// Assumes the title has no leading/trailing whitespace.\r\nexport function validateSheetTitle(title: string): boolean {\r\n  return (\r\n    title.length >= 3 &&\r\n    title.length <= 41 &&\r\n    /^[0-9a-zA-Z!@#'-\\s]+$/.test(title)\r\n  );\r\n}\r\n\r\n// Returns true if a custom sheet link is valid, false otherwise.\r\n// Assumes the title has no leading/trailing whitespace.\r\nexport function validateCustomSheetLink(link: string): boolean {\r\n  return link.length >= 5 && link.length <= 20 && /^[0-9a-zA-Z]+$/.test(link);\r\n}\r\n\r\n// Returns true if a sheet password is valid, false otherwise.\r\n// Assumes the password has no leading/trailing whitespace.\r\nexport function validatePassword(password: string): boolean {\r\n  return (\r\n    password.length >= 4 &&\r\n    password.length <= 25 &&\r\n    /^[0-9a-zA-Z!@#$?]+$/.test(password)\r\n  );\r\n}\r\n\r\n// \"Calculates\" an avatar's color.\r\nexport function getAvatarColor(\r\n  user: User,\r\n  userIdx: number,\r\n  placeholder?: boolean\r\n): string {\r\n  if (placeholder) return \"#dedede\";\r\n\r\n  const colors = [\r\n    \"#AD1457\",\r\n    \"#F9A825\",\r\n    \"#1565C0\",\r\n    \"#4527A0\",\r\n    \"#D84315\",\r\n    \"#4E342E\",\r\n    \"#00838F\",\r\n    \"#0277BD\",\r\n    \"#EF6C00\",\r\n    \"#424242\",\r\n  ];\r\n\r\n  return colors[userIdx % colors.length];\r\n}\r\n\r\nexport function handleKeyPress(\r\n  e: React.KeyboardEvent,\r\n  target: string,\r\n  action: () => void\r\n) {\r\n  if (e.key.toLowerCase() === target) {\r\n    action();\r\n  }\r\n}\r\n","import * as React from \"react\";\r\nimport { Avatar, Tooltip } from \"@material-ui/core\";\r\nimport { User } from \"../../models/models\";\r\nimport { getAvatarColor } from \"../../logic/logic\";\r\nimport { useState } from \"react\";\r\n\r\ninterface Props {\r\n  user: User;\r\n  userIdx: number;\r\n  tooltipPlacement:\r\n    | \"top\"\r\n    | \"left\"\r\n    | \"right\"\r\n    | \"bottom-end\"\r\n    | \"bottom-start\"\r\n    | \"bottom\"\r\n    | \"left-end\"\r\n    | \"left-start\"\r\n    | \"right-end\"\r\n    | \"right-start\"\r\n    | \"top-end\"\r\n    | \"top-start\"\r\n    | undefined;\r\n  onClick?: () => void;\r\n  iconOnHover?: JSX.Element;\r\n  disabled?: boolean;\r\n  className?: string;\r\n}\r\n\r\nexport const UserAvatar: React.FC<Props> = ({\r\n  user,\r\n  userIdx,\r\n  tooltipPlacement,\r\n  onClick,\r\n  iconOnHover,\r\n  disabled,\r\n  className,\r\n}) => {\r\n  const [hover, setHover] = useState(false);\r\n\r\n  return (\r\n    <Tooltip\r\n      className={className}\r\n      arrow\r\n      title={user.displayName}\r\n      placement={tooltipPlacement}\r\n      onClick={onClick}\r\n    >\r\n      <Avatar\r\n        className='avatar'\r\n        style={{\r\n          backgroundColor: getAvatarColor(user, userIdx, disabled),\r\n          cursor: onClick ? \"pointer\" : \"default\",\r\n        }}\r\n      >\r\n        <span\r\n          onMouseEnter={() => setHover(true)}\r\n          onMouseLeave={() => setHover(false)}\r\n        >\r\n          {hover ? (iconOnHover ? iconOnHover : user.initials) : user.initials}\r\n        </span>\r\n      </Avatar>\r\n    </Tooltip>\r\n  );\r\n};\r\n","import * as React from \"react\";\r\nimport { DialogTitle, IconButton } from \"@material-ui/core\";\r\nimport CloseRoundedIcon from \"@material-ui/icons/CloseRounded\";\r\n\r\ninterface Props {\r\n  title: string;\r\n  subtitle?: string;\r\n  onClose?: () => void;\r\n}\r\n\r\nexport const ModalHeader: React.FC<Props> = ({ title, subtitle, onClose }) => {\r\n  return (\r\n    <DialogTitle className='modalTitle'>\r\n      {title}\r\n      {subtitle && (\r\n        <>\r\n          {\" \"}\r\n          | <b>{`${subtitle}`}</b>\r\n        </>\r\n      )}\r\n      {onClose && (\r\n        <IconButton className='modalClose' size='small' onClick={onClose}>\r\n          <CloseRoundedIcon />\r\n        </IconButton>\r\n      )}\r\n    </DialogTitle>\r\n  );\r\n};\r\n","import * as React from \"react\";\r\nimport { Avatar, Chip } from \"@material-ui/core\";\r\nimport { User } from \"../../models/models\";\r\nimport { getAvatarColor } from \"../../logic/logic\";\r\n\r\ninterface Props {\r\n  user: User;\r\n  userIdx: number;\r\n  onRemove?: (user: User) => void;\r\n  onClick?: (user: User) => void;\r\n  className?: string;\r\n}\r\n\r\nexport const UserChip: React.FC<Props> = ({\r\n  user,\r\n  userIdx,\r\n  onRemove,\r\n  onClick,\r\n  className,\r\n}) => {\r\n  return (\r\n    <span onClick={onClick && (() => onClick(user))}>\r\n      <Chip\r\n        className={`chip ${className} ${onClick && \"linkCursor\"}`}\r\n        avatar={\r\n          <Avatar\r\n            className='smallAvatar'\r\n            style={{ backgroundColor: getAvatarColor(user, userIdx) }}\r\n          >\r\n            {user.initials}\r\n          </Avatar>\r\n        }\r\n        label={user.displayName}\r\n        onDelete={onRemove && (() => onRemove(user))}\r\n        key={user.id}\r\n      />\r\n    </span>\r\n  );\r\n};\r\n","import * as React from \"react\";\r\nimport {\r\n  Button,\r\n  Checkbox,\r\n  Dialog,\r\n  DialogActions,\r\n  DialogContent,\r\n} from \"@material-ui/core\";\r\nimport { Entry } from \"../../models/models\";\r\nimport { useState, useContext, useEffect } from \"react\";\r\nimport { SheetContext } from \"../pages/SplitTheCost\";\r\nimport { ModalHeader } from \"./ModalHeader\";\r\nimport { UserChip } from \"../bits/UserChip\";\r\nimport { handleKeyPress } from \"../../logic/logic\";\r\n\r\ninterface Props {\r\n  open: boolean;\r\n  setOpen: React.Dispatch<React.SetStateAction<boolean>>;\r\n  entry: Entry;\r\n}\r\n\r\nexport const ExcludedUsersModal: React.FC<Props> = ({\r\n  open,\r\n  setOpen,\r\n  entry,\r\n}) => {\r\n  const { sheetState, sheetDispatch } = useContext(SheetContext);\r\n\r\n  const [excludedUsers, setExcludedUsers] = useState<string[]>(entry.exclude);\r\n\r\n  useEffect(() => {\r\n    setExcludedUsers(entry.exclude);\r\n  }, [entry.exclude]);\r\n\r\n  function confirmExcludeUsers() {\r\n    if (entry.exclude !== excludedUsers) {\r\n      sheetDispatch({\r\n        type: \"updateExcludedUsers\",\r\n        exclude: excludedUsers,\r\n        entry: entry,\r\n      });\r\n    }\r\n\r\n    handleClose();\r\n  }\r\n\r\n  function handleClick(userId: string) {\r\n    if (excludedUsers.includes(userId)) {\r\n      setExcludedUsers(excludedUsers.filter((id) => id !== userId));\r\n    } else {\r\n      setExcludedUsers([...excludedUsers, userId]);\r\n    }\r\n  }\r\n\r\n  function handleClose() {\r\n    setExcludedUsers(entry.exclude);\r\n    setOpen(false);\r\n  }\r\n\r\n  return (\r\n    <Dialog\r\n      fullWidth\r\n      disableBackdropClick\r\n      maxWidth='xs'\r\n      onClose={handleClose}\r\n      open={open}\r\n      onKeyPress={(e) => handleKeyPress(e, \"enter\", confirmExcludeUsers)}\r\n      PaperProps={{ className: \"modal\" }}\r\n    >\r\n      <ModalHeader\r\n        title='Included Friends'\r\n        subtitle={entry.item}\r\n        onClose={handleClose}\r\n      />\r\n      <DialogContent className='excludeModalContent'>\r\n        <div className='excludeModalColumn'>\r\n          {Object.entries(sheetState.users).map((pair, idx) => {\r\n            const user = pair[1];\r\n            return (\r\n              idx % 2 === 0 && (\r\n                <div className='excludeModalUser' key={user.id}>\r\n                  <Checkbox\r\n                    checked={!excludedUsers.includes(user.id)}\r\n                    color='primary'\r\n                    onClick={() => handleClick(user.id)}\r\n                  />\r\n                  <UserChip\r\n                    user={user}\r\n                    userIdx={Object.keys(sheetState.users).indexOf(user.id)}\r\n                    onClick={() => handleClick(user.id)}\r\n                  />\r\n                </div>\r\n              )\r\n            );\r\n          })}\r\n        </div>\r\n        <div className='excludeModalColumn'>\r\n          {Object.entries(sheetState.users).map((pair, idx) => {\r\n            const user = pair[1];\r\n            return (\r\n              idx % 2 === 1 && (\r\n                <div className='excludeModalUser' key={user.id}>\r\n                  <Checkbox\r\n                    checked={!excludedUsers.includes(user.id)}\r\n                    color='primary'\r\n                    onClick={() => handleClick(user.id)}\r\n                  />\r\n                  <UserChip\r\n                    user={user}\r\n                    userIdx={Object.keys(sheetState.users).indexOf(user.id)}\r\n                    onClick={() => handleClick(user.id)}\r\n                  />\r\n                </div>\r\n              )\r\n            );\r\n          })}\r\n        </div>\r\n      </DialogContent>\r\n      <DialogActions className='modalActions'>\r\n        <Button\r\n          className='rightMarginSmall'\r\n          color='primary'\r\n          onClick={() => setExcludedUsers([])}\r\n        >\r\n          Include All\r\n        </Button>\r\n        <Button\r\n          className='modalConfirmButton rightMarginSmall'\r\n          onClick={confirmExcludeUsers}\r\n        >\r\n          Confirm\r\n        </Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n};\r\n","import * as React from \"react\";\r\nimport {\r\n  Button,\r\n  Dialog,\r\n  DialogActions,\r\n  DialogContent,\r\n  Radio,\r\n} from \"@material-ui/core\";\r\nimport { Entry } from \"../../models/models\";\r\nimport { useState, useContext, useEffect } from \"react\";\r\nimport { SheetContext } from \"../pages/SplitTheCost\";\r\nimport { ModalHeader } from \"./ModalHeader\";\r\nimport { UserChip } from \"../bits/UserChip\";\r\nimport { handleKeyPress } from \"../../logic/logic\";\r\n\r\ninterface Props {\r\n  open: boolean;\r\n  setOpen: React.Dispatch<React.SetStateAction<boolean>>;\r\n  entry: Entry;\r\n}\r\n\r\nexport const EntryUserModal: React.FC<Props> = ({ open, setOpen, entry }) => {\r\n  const { sheetState, sheetDispatch } = useContext(SheetContext);\r\n\r\n  const [entryUser, setEntryUser] = useState(entry.user);\r\n\r\n  useEffect(() => {\r\n    setEntryUser(entry.user);\r\n  }, [entry.user]);\r\n\r\n  function confirmEntryUser() {\r\n    if (entryUser && entryUser !== entry.user) {\r\n      sheetDispatch({\r\n        type: \"updateEntry\",\r\n        entry: entry,\r\n        section: \"user\",\r\n        value: entryUser,\r\n      });\r\n      handleClose();\r\n    }\r\n  }\r\n\r\n  function handleClick(userId: string) {\r\n    setEntryUser(userId);\r\n  }\r\n\r\n  function handleClose() {\r\n    setEntryUser(entry.user);\r\n    setOpen(false);\r\n  }\r\n\r\n  return (\r\n    <Dialog\r\n      fullWidth\r\n      disableBackdropClick\r\n      maxWidth='xs'\r\n      onClose={handleClose}\r\n      open={open}\r\n      onKeyPress={(e) => handleKeyPress(e, \"enter\", confirmEntryUser)}\r\n      PaperProps={{ className: \"modal\" }}\r\n    >\r\n      <ModalHeader\r\n        title='Who Paid?'\r\n        subtitle={entry.item}\r\n        onClose={handleClose}\r\n      />\r\n      <DialogContent className='excludeModalContent'>\r\n        <div className='excludeModalColumn'>\r\n          {Object.entries(sheetState.users).map((pair, idx) => {\r\n            const user = pair[1];\r\n            return (\r\n              idx % 2 === 0 && (\r\n                <div className='excludeModalUser' key={user.id}>\r\n                  <Radio\r\n                    checked={entryUser === user.id}\r\n                    onClick={() => handleClick(user.id)}\r\n                  />\r\n                  <UserChip\r\n                    user={user}\r\n                    userIdx={Object.keys(sheetState.users).indexOf(user.id)}\r\n                    onClick={() => handleClick(user.id)}\r\n                  />\r\n                </div>\r\n              )\r\n            );\r\n          })}\r\n        </div>\r\n        <div className='excludeModalColumn'>\r\n          {Object.entries(sheetState.users).map((pair, idx) => {\r\n            const user = pair[1];\r\n            return (\r\n              idx % 2 === 1 && (\r\n                <div className='excludeModalUser' key={user.id}>\r\n                  <Radio\r\n                    checked={entryUser === user.id}\r\n                    onClick={() => handleClick(user.id)}\r\n                  />\r\n                  <UserChip\r\n                    user={user}\r\n                    userIdx={Object.keys(sheetState.users).indexOf(user.id)}\r\n                    onClick={() => handleClick(user.id)}\r\n                  />\r\n                </div>\r\n              )\r\n            );\r\n          })}\r\n        </div>\r\n      </DialogContent>\r\n      <DialogActions className='modalActions'>\r\n        <Button\r\n          className='modalConfirmButton rightMarginSmall'\r\n          onClick={confirmEntryUser}\r\n        >\r\n          Confirm\r\n        </Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n};\r\n","import * as React from \"react\";\r\nimport {\r\n  Button,\r\n  Dialog,\r\n  DialogActions,\r\n  DialogContent,\r\n} from \"@material-ui/core\";\r\nimport { useContext } from \"react\";\r\nimport { SheetContext } from \"../pages/SplitTheCost\";\r\nimport { Entry } from \"../../models/models\";\r\nimport { ModalHeader } from \"./ModalHeader\";\r\nimport { handleKeyPress } from \"../../logic/logic\";\r\n\r\ninterface Props {\r\n  entry: Entry;\r\n  open: boolean;\r\n  setOpen: React.Dispatch<React.SetStateAction<boolean>>;\r\n}\r\n\r\nexport const RemoveEntryModal: React.FC<Props> = ({ entry, open, setOpen }) => {\r\n  const { sheetDispatch } = useContext(SheetContext);\r\n\r\n  function handleClose() {\r\n    setOpen(false);\r\n  }\r\n\r\n  function confirmRemoveEntry() {\r\n    sheetDispatch({\r\n      type: \"removeEntry\",\r\n      entryId: entry.id,\r\n    });\r\n\r\n    setOpen(false);\r\n  }\r\n\r\n  return (\r\n    <Dialog\r\n      fullWidth\r\n      disableBackdropClick\r\n      maxWidth='xs'\r\n      onClose={handleClose}\r\n      open={open}\r\n      onKeyPress={(e) => handleKeyPress(e, \"enter\", confirmRemoveEntry)}\r\n      PaperProps={{ className: \"modal\" }}\r\n    >\r\n      <ModalHeader title='Remove Entry' onClose={handleClose} />\r\n      <DialogContent>\r\n        Are you sure you want to remove <b>{entry.item}</b> from this sheet?\r\n      </DialogContent>\r\n      <DialogActions className='modalActions'>\r\n        <Button\r\n          className='modalConfirmButton rightMarginSmall'\r\n          onClick={confirmRemoveEntry}\r\n        >\r\n          Confirm\r\n        </Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n};\r\n","import * as React from \"react\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport { useState } from \"react\";\r\nimport { Avatar, IconButton, Input, InputAdornment } from \"@material-ui/core\";\r\nimport DeleteIcon from \"@material-ui/icons/Delete\";\r\nimport { Entry } from \"../../models/models\";\r\nimport NumberFormat from \"react-number-format\";\r\nimport { UserAvatar } from \"../bits/UserAvatar\";\r\nimport { ExcludedUsersModal } from \"../modals/ExcludedUsersModal\";\r\nimport EditRoundedIcon from \"@material-ui/icons/EditRounded\";\r\nimport { motion } from \"framer-motion\";\r\nimport { useContext } from \"react\";\r\nimport { SheetContext } from \"../pages/SplitTheCost\";\r\nimport { EntryUserModal } from \"../modals/EntryUserModal\";\r\nimport { RemoveEntryModal } from \"../modals/RemoveEntryModal\";\r\n\r\ninterface Props {\r\n  entry: Entry;\r\n  rowIdx: number;\r\n}\r\n\r\nexport const EntriesRow: React.FC<Props> = ({ entry, rowIdx }) => {\r\n  const { sheetState, sheetDispatch } = useContext(SheetContext);\r\n\r\n  const [emptyRow, setEmptyRow] = useState(\r\n    !entry.item && !entry.cost && !entry.note\r\n  );\r\n\r\n  const [showDelete, setShowDelete] = useState(false);\r\n  const [showEdit, setShowEdit] = useState(false);\r\n  const [item, setItem] = useState(entry.item);\r\n  const [note, setNote] = useState(entry.note);\r\n  const [showExcludeUsersModal, setShowExcludeUsersModal] = useState(false);\r\n  const [showEntryUserModal, setShowEntryUserModal] = useState(false);\r\n  const [showRemoveEntryModal, setShowRemoveEntryModal] = useState(false);\r\n\r\n  const numExcludeUsersDisplay = 3;\r\n\r\n  function updateEntry(\r\n    value: string,\r\n    section: \"item\" | \"cost\" | \"note\",\r\n    local?: boolean\r\n  ) {\r\n    switch (section) {\r\n      case \"item\":\r\n        sheetDispatch({\r\n          type: \"updateEntry\",\r\n          entry: entry,\r\n          section: \"item\",\r\n          value: value,\r\n        });\r\n        setEmptyRow(!item && !entry.cost && !note);\r\n        break;\r\n      case \"cost\":\r\n        sheetDispatch({\r\n          type: \"updateEntry\",\r\n          entry: entry,\r\n          section: \"cost\",\r\n          value: value,\r\n          local: local,\r\n        });\r\n        setEmptyRow(!item && !Number(value) && !note);\r\n        break;\r\n      case \"note\":\r\n        sheetDispatch({\r\n          type: \"updateEntry\",\r\n          entry: entry,\r\n          section: \"note\",\r\n          value: value,\r\n        });\r\n        setEmptyRow(!item && !entry.cost && !note);\r\n        break;\r\n    }\r\n  }\r\n\r\n  return (\r\n    <motion.div\r\n      animate={{ x: 0, opacity: 1 }}\r\n      initial={{ x: -2000, opacity: 0 }}\r\n      transition={{ type: \"tween\", duration: 0.5 }}\r\n    >\r\n      <Grid\r\n        className={rowIdx % 2 ? \"lightRow\" : \"darkRow\"}\r\n        container\r\n        spacing={0}\r\n      >\r\n        <Grid item xs={3}>\r\n          <div\r\n            className='entryDiv'\r\n            onMouseOver={() => setShowDelete(true)}\r\n            onMouseLeave={() => setShowDelete(false)}\r\n          >\r\n            <UserAvatar\r\n              className='leftMargin'\r\n              user={sheetState.users[entry.user]}\r\n              userIdx={Object.keys(sheetState.users).indexOf(\r\n                sheetState.users[entry.user].id\r\n              )}\r\n              tooltipPlacement='top'\r\n              disabled={emptyRow}\r\n              onClick={\r\n                !sheetState.readOnly\r\n                  ? () => setShowEntryUserModal(true)\r\n                  : undefined\r\n              }\r\n              iconOnHover={<EditRoundedIcon />}\r\n            />\r\n            <Input\r\n              className='sideMargins'\r\n              disableUnderline\r\n              fullWidth\r\n              readOnly={sheetState.readOnly}\r\n              value={item}\r\n              placeholder={emptyRow ? \"Enter item name here\" : undefined}\r\n              onFocus={() => setEmptyRow(false)}\r\n              onChange={(e) => setItem(e.target.value)}\r\n              onBlur={(e) => {\r\n                updateEntry(e.target.value, \"item\");\r\n              }}\r\n            />\r\n            {!sheetState.readOnly && showDelete && (\r\n              <IconButton\r\n                className='iconButton largeIconButton rightMargin'\r\n                onClick={() => setShowRemoveEntryModal(true)}\r\n              >\r\n                <DeleteIcon />\r\n              </IconButton>\r\n            )}\r\n          </div>\r\n        </Grid>\r\n        <Grid item xs={1}>\r\n          <div className='entryDiv'>\r\n            <Input\r\n              className='sideMargins'\r\n              disableUnderline\r\n              fullWidth\r\n              readOnly={sheetState.readOnly}\r\n              value={entry.cost.toFixed(2)}\r\n              onFocus={() => setEmptyRow(false)}\r\n              onChange={(e) => {\r\n                updateEntry(e.target.value, \"cost\", true);\r\n              }}\r\n              onBlur={(e) => {\r\n                updateEntry(e.target.value, \"cost\");\r\n              }}\r\n              startAdornment={\r\n                <InputAdornment position='start'>$</InputAdornment>\r\n              }\r\n              inputComponent={NumberFormat as any}\r\n              inputProps={{\r\n                decimalScale: 2,\r\n                allowNegative: false,\r\n                thousandSeparator: \",\",\r\n                allowLeadingZeros: true,\r\n              }}\r\n            />\r\n          </div>\r\n        </Grid>\r\n        <Grid item xs={2}>\r\n          <div\r\n            className='entryDiv'\r\n            onMouseOver={() => setShowEdit(true)}\r\n            onMouseLeave={() => setShowEdit(false)}\r\n          >\r\n            {entry.exclude.map((userId, idx) => {\r\n              if (idx < numExcludeUsersDisplay) {\r\n                return (\r\n                  <UserAvatar\r\n                    className='leftMarginSmall'\r\n                    user={sheetState.users[userId]}\r\n                    userIdx={Object.keys(sheetState.users).indexOf(\r\n                      sheetState.users[userId].id\r\n                    )}\r\n                    tooltipPlacement='top'\r\n                    key={userId}\r\n                  />\r\n                );\r\n              } else if (\r\n                idx === numExcludeUsersDisplay &&\r\n                entry.exclude.length > idx\r\n              ) {\r\n                return (\r\n                  <Avatar className='leftMarginSmall' key={userId}>{`+${\r\n                    entry.exclude.length - numExcludeUsersDisplay\r\n                  }`}</Avatar>\r\n                );\r\n              } else {\r\n                return null;\r\n              }\r\n            })}\r\n\r\n            {!sheetState.readOnly && showEdit && (\r\n              <IconButton\r\n                className='iconButton largeIconButton leftMarginSmall'\r\n                onClick={() => setShowExcludeUsersModal(true)}\r\n              >\r\n                <EditRoundedIcon />\r\n              </IconButton>\r\n            )}\r\n          </div>\r\n        </Grid>\r\n        <Grid item xs={6}>\r\n          <div className='entryDiv'>\r\n            <Input\r\n              className='sideMargins'\r\n              disableUnderline\r\n              fullWidth\r\n              readOnly={sheetState.readOnly}\r\n              value={note}\r\n              placeholder={emptyRow ? \"Include a note here\" : undefined}\r\n              onFocus={() => setEmptyRow(false)}\r\n              onChange={(e) => setNote(e.target.value)}\r\n              onBlur={(e) => {\r\n                updateEntry(e.target.value, \"note\");\r\n              }}\r\n            />\r\n          </div>\r\n        </Grid>\r\n      </Grid>\r\n      <ExcludedUsersModal\r\n        open={showExcludeUsersModal}\r\n        setOpen={setShowExcludeUsersModal}\r\n        entry={entry}\r\n      />\r\n      <EntryUserModal\r\n        open={showEntryUserModal}\r\n        setOpen={setShowEntryUserModal}\r\n        entry={entry}\r\n      />\r\n      <RemoveEntryModal\r\n        open={showRemoveEntryModal}\r\n        setOpen={setShowRemoveEntryModal}\r\n        entry={entry}\r\n      />\r\n    </motion.div>\r\n  );\r\n};\r\n","import { Grid } from \"@material-ui/core\";\r\nimport * as React from \"react\";\r\n\r\nexport const EntriesHeader: React.FC = () => {\r\n  return (\r\n    <Grid className='gridHeader' container spacing={0}>\r\n      <Grid item xs={3}>\r\n        <span className='leftMargin'>ITEM</span>\r\n      </Grid>\r\n      <Grid item xs={1}>\r\n        <span className='leftMargin'>COST</span>\r\n      </Grid>\r\n      <Grid item xs={2}>\r\n        <span className='leftMargin'>EXCLUDE</span>\r\n      </Grid>\r\n      <Grid item xs={6}>\r\n        <span className='leftMargin'>NOTE</span>\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n};\r\n","import * as React from \"react\";\r\nimport { EntriesRow } from \"./EntriesRow\";\r\nimport { EntriesHeader } from \"./EntriesHeader\";\r\nimport { useContext } from \"react\";\r\nimport { SheetContext } from \"../pages/SplitTheCost\";\r\nimport { UserContext } from \"../../App\";\r\n\r\nexport const Entries: React.FC = () => {\r\n  const { userState } = useContext(UserContext);\r\n  const { sheetState } = useContext(SheetContext);\r\n  let rowIdx = 0;\r\n\r\n  return (\r\n    <div className='entries'>\r\n      <EntriesHeader />\r\n      {userState.authenticated &&\r\n        sheetState.entries.map(\r\n          (entry) =>\r\n            (entry.user === userState.curUser?.id ||\r\n              entry.createdBy === userState.curUser?.id ||\r\n              entry.item ||\r\n              entry.cost ||\r\n              entry.note) && (\r\n              <EntriesRow entry={entry} rowIdx={rowIdx++} key={entry.id} />\r\n            )\r\n        )}\r\n    </div>\r\n  );\r\n};\r\n","import * as React from \"react\";\r\nimport CloudDoneRoundedIcon from \"@material-ui/icons/CloudDoneRounded\";\r\nimport SyncRoundedIcon from \"@material-ui/icons/SyncRounded\";\r\nimport { SaveState } from \"../../models/models\";\r\n\r\ninterface Props {\r\n  saveState: SaveState;\r\n}\r\n\r\nexport const AutosaveMessage: React.FC<Props> = ({ saveState }) => {\r\n  function renderMessage(): JSX.Element {\r\n    if (saveState === SaveState.Unsaved) {\r\n      return <></>;\r\n    } else if (saveState === SaveState.Saving) {\r\n      return (\r\n        <>\r\n          <SyncRoundedIcon fontSize='small' />\r\n          <p className='leftMarginSmall'>Saving...</p>\r\n        </>\r\n      );\r\n    } else {\r\n      return (\r\n        <>\r\n          <CloudDoneRoundedIcon fontSize='small' />\r\n          <p className='leftMarginSmall'>Saved to Cloud</p>\r\n        </>\r\n      );\r\n    }\r\n  }\r\n\r\n  return <span id='autosaveMessage'>{renderMessage()}</span>;\r\n};\r\n","import * as React from \"react\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport { useContext } from \"react\";\r\nimport { SheetContext } from \"../pages/SplitTheCost\";\r\nimport { AutosaveMessage } from \"../bits/AutosaveMessage\";\r\nimport { SaveState } from \"../../models/models\";\r\n\r\ninterface Props {\r\n  saveState: SaveState;\r\n}\r\n\r\nexport const Header: React.FC<Props> = ({ saveState }) => {\r\n  const { sheetState } = useContext(SheetContext);\r\n\r\n  return (\r\n    <Grid container spacing={0}>\r\n      <Grid className='header' item xs={12}>\r\n        <span className='leftMargin'>\r\n          split the cost | <b>{sheetState.title}</b>\r\n        </span>\r\n        <AutosaveMessage saveState={saveState} />\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n};\r\n","import * as React from \"react\";\r\nimport {\r\n  Button,\r\n  Dialog,\r\n  DialogActions,\r\n  DialogContent,\r\n  TextField,\r\n} from \"@material-ui/core\";\r\nimport { useContext, useState } from \"react\";\r\nimport { SheetContext } from \"../pages/SplitTheCost\";\r\nimport { ModalHeader } from \"./ModalHeader\";\r\nimport { handleKeyPress, validateName } from \"../../logic/logic\";\r\n\r\ninterface Props {\r\n  open: boolean;\r\n  setOpen: React.Dispatch<React.SetStateAction<boolean>>;\r\n}\r\n\r\nexport const AddUserModal: React.FC<Props> = ({ open, setOpen }) => {\r\n  const { sheetState, sheetDispatch } = useContext(SheetContext);\r\n\r\n  const [firstName, setFirstName] = useState(\"\");\r\n  const [validFirstName, setValidFirstName] = useState(true);\r\n  const [lastName, setLastName] = useState(\"\");\r\n  const [validLastName, setValidLastName] = useState(true);\r\n  const [uniqueUser, setUniqueUser] = useState(true);\r\n\r\n  // Resets dialog inputs.\r\n  function resetDialog() {\r\n    setFirstName(\"\");\r\n    setLastName(\"\");\r\n    setValidFirstName(true);\r\n    setValidLastName(true);\r\n    setUniqueUser(true);\r\n  }\r\n\r\n  function handleClose() {\r\n    resetDialog();\r\n    setOpen(false);\r\n  }\r\n\r\n  function validateNewUser(firstName: string, lastName: string): boolean {\r\n    const first = firstName.trim().toLocaleLowerCase();\r\n    const last = lastName.trim().toLocaleLowerCase();\r\n\r\n    const checkFirstName = validateName(first);\r\n    const checkLastName = validateName(last);\r\n    setValidFirstName(checkFirstName);\r\n    setValidLastName(checkLastName);\r\n\r\n    if (!checkFirstName || !checkLastName) return false;\r\n\r\n    let unique = true;\r\n    Object.entries(sheetState.users).forEach((pair) => {\r\n      const user = pair[1];\r\n      if (\r\n        user.firstName.toLocaleLowerCase() === first &&\r\n        user.lastName.toLocaleLowerCase() === last\r\n      ) {\r\n        unique = false;\r\n      }\r\n    });\r\n\r\n    setUniqueUser(unique);\r\n    return unique;\r\n  }\r\n\r\n  function confirmAddUser() {\r\n    // Validate first/last name and check for duplicates.\r\n    if (sheetState.numUsers >= 10 || !validateNewUser(firstName, lastName)) {\r\n      return;\r\n    }\r\n\r\n    sheetDispatch({\r\n      type: \"addUser\",\r\n      firstName: firstName.trim(),\r\n      lastName: lastName.trim(),\r\n      email: \"\",\r\n    });\r\n\r\n    resetDialog();\r\n    setOpen(false);\r\n  }\r\n\r\n  return (\r\n    <Dialog\r\n      fullWidth\r\n      disableBackdropClick\r\n      maxWidth='xs'\r\n      onClose={handleClose}\r\n      open={open}\r\n      onKeyPress={(e) => handleKeyPress(e, \"enter\", confirmAddUser)}\r\n      PaperProps={{ className: \"modal\" }}\r\n    >\r\n      <ModalHeader title='Add a Friend' onClose={handleClose} />\r\n      <DialogContent>\r\n        <div className='modalInputRow'>\r\n          <TextField\r\n            className='halfWidthModalInput'\r\n            autoFocus\r\n            label='First Name'\r\n            value={firstName}\r\n            onChange={(e) => setFirstName(e.target.value)}\r\n            error={!validFirstName || !uniqueUser}\r\n            helperText={\r\n              (!validFirstName && \"Please enter a valid name.\") ||\r\n              (!uniqueUser && \"Duplicate users not allowed.\")\r\n            }\r\n          />\r\n          <TextField\r\n            className='halfWidthModalInput'\r\n            label='Last Name'\r\n            value={lastName}\r\n            onChange={(e) => setLastName(e.target.value)}\r\n            error={!validLastName || !uniqueUser}\r\n            helperText={\r\n              (!validLastName && \"Please enter a valid name.\") ||\r\n              (!uniqueUser && \"Duplicate users not allowed.\")\r\n            }\r\n          />\r\n        </div>\r\n      </DialogContent>\r\n      <DialogActions className='modalActions'>\r\n        <Button\r\n          className='modalConfirmButton rightMarginSmall'\r\n          onClick={confirmAddUser}\r\n        >\r\n          Confirm\r\n        </Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n};\r\n","import firebase from \"firebase/app\";\r\nimport \"firebase/auth\";\r\nimport \"firebase/firestore\";\r\nimport { SheetState } from \"./models/models\";\r\n\r\nconst fire = firebase.initializeApp({\r\n  apiKey: process.env.REACT_APP_FIREBASE_API_KEY,\r\n  authDomain: process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,\r\n  projectId: process.env.REACT_APP_FIREBASE_PROJECT_ID,\r\n  storageBucket: process.env.REACT_APP_FIREBASE_STORAGE_BUCKET,\r\n  messagingSenderId: process.env.REACT_APP_FIREBASE_MESSAGING_SENDER_ID,\r\n  appId: process.env.REACT_APP_FIREBASE_APP_ID,\r\n});\r\n\r\nexport const sheetStateConverter = {\r\n  toFirestore(sheetState: SheetState): firebase.firestore.DocumentData {\r\n    return {\r\n      id: sheetState.id,\r\n      timestamp: sheetState.timestamp,\r\n      lastAccessed: sheetState.lastAccessed,\r\n      lastEdited: sheetState.lastEdited,\r\n      title: sheetState.title,\r\n      entries: sheetState.entries,\r\n      users: sheetState.users,\r\n      numUsers: sheetState.numUsers,\r\n      createdBy: sheetState.createdBy,\r\n      readOnly: sheetState.readOnly ? sheetState.readOnly : false,\r\n      customLink: sheetState.customLink ? sheetState.customLink : \"\",\r\n      password: sheetState.password ? sheetState.password : \"\",\r\n    };\r\n  },\r\n  fromFirestore(\r\n    snapshot: firebase.firestore.QueryDocumentSnapshot,\r\n    options: firebase.firestore.SnapshotOptions\r\n  ): SheetState {\r\n    const data = snapshot.data(options)!;\r\n    return {\r\n      id: data.id,\r\n      timestamp: data.timestamp,\r\n      lastAccessed: data.lastAccessed,\r\n      lastEdited: data.lastEdited,\r\n      title: data.title,\r\n      entries: data.entries,\r\n      users: data.users,\r\n      numUsers: data.numUsers,\r\n      createdBy: data.createdBy,\r\n      local: false,\r\n      readOnly: data.readOnly,\r\n      customLink: data.customLink,\r\n      password: data.password ? data.password : \"\",\r\n    };\r\n  },\r\n};\r\n\r\nexport const auth = fire.auth();\r\nexport const db = fire.firestore();\r\nexport const googleAuthProvider = new firebase.auth.GoogleAuthProvider();\r\nexport default fire;\r\n","import * as React from \"react\";\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  Grid,\r\n  TextField,\r\n  IconButton,\r\n  FormControlLabel,\r\n  Switch,\r\n  Tooltip,\r\n  Button,\r\n} from \"@material-ui/core\";\r\nimport { useContext, useEffect, useState } from \"react\";\r\nimport { SheetContext } from \"../pages/SplitTheCost\";\r\nimport { ModalHeader } from \"./ModalHeader\";\r\nimport { db } from \"../../firebase\";\r\nimport {\r\n  validateCustomSheetLink,\r\n  validatePassword,\r\n  validateSheetTitle,\r\n} from \"../../logic/logic\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport DeleteIcon from \"@material-ui/icons/DeleteRounded\";\r\nimport EditRoundedIcon from \"@material-ui/icons/EditRounded\";\r\nimport DoneRoundedIcon from \"@material-ui/icons/DoneRounded\";\r\nimport CloseRoundedIcon from \"@material-ui/icons/CloseRounded\";\r\nimport VisibilityIcon from \"@material-ui/icons/Visibility\";\r\nimport VisibilityOffIcon from \"@material-ui/icons/VisibilityOff\";\r\nimport FilterNoneRoundedIcon from \"@material-ui/icons/FilterNoneRounded\";\r\n\r\ninterface Props {\r\n  open: boolean;\r\n  setOpen: React.Dispatch<React.SetStateAction<boolean>>;\r\n}\r\n\r\nexport const SettingsModal: React.FC<Props> = ({ open, setOpen }) => {\r\n  const { sheetState, sheetDispatch } = useContext(SheetContext);\r\n  const history = useHistory();\r\n\r\n  // Sheet title state\r\n  const [sheetTitle, setSheetTitle] = useState(sheetState.title);\r\n  const [editTitle, setEditTitle] = useState(false);\r\n  const [validTitle, setValidTitle] = useState(true);\r\n\r\n  // Custom sheet link state\r\n  const [sheetLink, setSheetLink] = useState(\r\n    sheetState.customLink ? sheetState.customLink : sheetState.id\r\n  );\r\n  const [editLink, setEditLink] = useState(false);\r\n  const [validLink, setValidLink] = useState(true);\r\n  const [uniqueLink, setUniqueLink] = useState(true);\r\n\r\n  // Read only state\r\n  const [readOnly, setReadOnly] = useState(sheetState.readOnly);\r\n\r\n  // Sheet password state\r\n  const [password, setPassword] = useState(\"\");\r\n  const [editPassword, setEditPassword] = useState(false);\r\n  const [validPassword, setValidPassword] = useState(true);\r\n  const [viewPassword, setViewPassword] = useState(false);\r\n\r\n  const [password2, setPassword2] = useState(\"\");\r\n  const [passwordsMatch, setPasswordsMatch] = useState(true);\r\n\r\n  // Delete sheet state\r\n  const [deleteText, setDeleteText] = useState(\"\");\r\n  const [editDelete, setEditDelete] = useState(false);\r\n  const [deleteError, setDeleteError] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setSheetTitle(sheetState.title);\r\n    setSheetLink(sheetState.customLink ? sheetState.customLink : sheetState.id);\r\n    setReadOnly(sheetState.readOnly);\r\n  }, [\r\n    sheetState.title,\r\n    sheetState.customLink,\r\n    sheetState.id,\r\n    sheetState.readOnly,\r\n  ]);\r\n\r\n  function handleClose() {\r\n    setOpen(false);\r\n    cancelSheetTitle();\r\n    cancelCustomLink();\r\n    cancelPassword();\r\n    cancelDeleteSheet();\r\n  }\r\n\r\n  // ----------------- SHEET TITLE -----------------\r\n\r\n  function renderSheetTitleSetting(): JSX.Element {\r\n    return (\r\n      <>\r\n        <Grid className='bottomMargin' item xs={8}>\r\n          <TextField\r\n            fullWidth\r\n            inputRef={(titleRef) => titleRef && editTitle && titleRef.focus()}\r\n            value={sheetTitle}\r\n            error={!validTitle}\r\n            label='Sheet Title'\r\n            onChange={(e) => setSheetTitle(e.target.value)}\r\n            helperText={\r\n              validTitle\r\n                ? \"\"\r\n                : \"Title must be between 3-40 characters (select special characters are allowed).\"\r\n            }\r\n            InputProps={{\r\n              readOnly: !editTitle,\r\n              disableUnderline: !editTitle,\r\n            }}\r\n          />\r\n        </Grid>\r\n        <Grid container item xs={4} justify='flex-end'>\r\n          {editTitle && (\r\n            <IconButton onClick={cancelSheetTitle}>\r\n              <CloseRoundedIcon />\r\n            </IconButton>\r\n          )}\r\n          <IconButton onClick={handleEditSheetTitle}>\r\n            {editTitle ? <DoneRoundedIcon /> : <EditRoundedIcon />}\r\n          </IconButton>\r\n        </Grid>\r\n      </>\r\n    );\r\n  }\r\n\r\n  function handleEditSheetTitle() {\r\n    if (!editTitle) {\r\n      setEditTitle(true);\r\n    } else {\r\n      confirmSheetTitle();\r\n    }\r\n  }\r\n\r\n  function confirmSheetTitle() {\r\n    if (sheetTitle.trim() === sheetState.title) {\r\n      cancelSheetTitle();\r\n      return;\r\n    }\r\n\r\n    if (!validateSheetTitle(sheetTitle.trim())) {\r\n      setValidTitle(false);\r\n      return;\r\n    }\r\n\r\n    setEditTitle(false);\r\n    setValidTitle(true);\r\n    sheetDispatch({ type: \"changeSheetTitle\", title: sheetTitle.trim() });\r\n  }\r\n\r\n  function cancelSheetTitle() {\r\n    setEditTitle(false);\r\n    setValidTitle(true);\r\n    setSheetTitle(sheetState.title);\r\n  }\r\n\r\n  // ----------------- CUSTOM SHEET LINK -----------------\r\n\r\n  function renderCustomLinkSetting(): JSX.Element {\r\n    return (\r\n      <>\r\n        <Grid className='bottomMargin' item xs={8}>\r\n          <TextField\r\n            fullWidth\r\n            inputRef={(linkRef) => linkRef && editLink && linkRef.focus()}\r\n            value={sheetLink}\r\n            error={!validLink || !uniqueLink}\r\n            label='Custom Sheet Link'\r\n            onChange={(e) => setSheetLink(e.target.value)}\r\n            helperText={\r\n              validLink\r\n                ? uniqueLink\r\n                  ? \"\"\r\n                  : \"This custom link is already in use.\"\r\n                : \"Link must be between 5-20 characters and contain only letters and numbers.\"\r\n            }\r\n            InputProps={{\r\n              readOnly: !editLink,\r\n              disableUnderline: !editLink,\r\n              startAdornment: <b>splitthecost.net/#/</b>,\r\n            }}\r\n          />\r\n        </Grid>\r\n        <Grid container item xs={4} justify='flex-end'>\r\n          <Tooltip arrow title='Copy Link' placement='left'>\r\n            <IconButton onClick={copySheetLink}>\r\n              <FilterNoneRoundedIcon />\r\n            </IconButton>\r\n          </Tooltip>\r\n          {editLink && (\r\n            <IconButton onClick={cancelCustomLink}>\r\n              <CloseRoundedIcon />\r\n            </IconButton>\r\n          )}\r\n          <IconButton onClick={handleEditCustomLink}>\r\n            {editLink ? <DoneRoundedIcon /> : <EditRoundedIcon />}\r\n          </IconButton>\r\n        </Grid>\r\n      </>\r\n    );\r\n  }\r\n\r\n  function handleEditCustomLink() {\r\n    if (!editLink) {\r\n      setEditLink(true);\r\n    } else {\r\n      confirmCustomLink();\r\n    }\r\n  }\r\n\r\n  async function confirmCustomLink() {\r\n    const linkTrimmed = sheetLink.trim();\r\n    if (\r\n      linkTrimmed === sheetState.customLink ||\r\n      linkTrimmed === sheetState.id\r\n    ) {\r\n      cancelCustomLink();\r\n      return;\r\n    }\r\n\r\n    const temp = validateCustomSheetLink(linkTrimmed);\r\n    setValidLink(temp);\r\n    if (!temp) {\r\n      return;\r\n    }\r\n\r\n    const linkSnapshot = await db\r\n      .collection(\"customLinks\")\r\n      .doc(linkTrimmed)\r\n      .get();\r\n    if (linkSnapshot.exists) {\r\n      setUniqueLink(false);\r\n      return;\r\n    }\r\n\r\n    const idSnapshot = await db.collection(\"sheets\").doc(linkTrimmed).get();\r\n    if (idSnapshot.exists) {\r\n      setUniqueLink(false);\r\n      return;\r\n    }\r\n\r\n    setEditLink(false);\r\n    setValidLink(true);\r\n    setUniqueLink(true);\r\n    sheetDispatch({ type: \"changeSheetLink\", link: linkTrimmed });\r\n    history.push(`/sheet/${sheetLink}`);\r\n  }\r\n\r\n  function cancelCustomLink() {\r\n    setEditLink(false);\r\n    setValidLink(true);\r\n    setUniqueLink(true);\r\n    setSheetLink(sheetState.customLink ? sheetState.customLink : sheetState.id);\r\n  }\r\n\r\n  function copySheetLink() {\r\n    navigator.clipboard.writeText(\r\n      `splitthecost.net/#/sheet/${\r\n        sheetState.customLink ? sheetState.customLink : sheetState.id\r\n      }`\r\n    );\r\n  }\r\n\r\n  // ----------------- TOGGLES -----------------\r\n\r\n  function renderToggleSettings(): JSX.Element {\r\n    return (\r\n      <Grid item xs={12}>\r\n        <FormControlLabel\r\n          control={\r\n            <Switch\r\n              checked={readOnly}\r\n              onChange={handleEditReadOnly}\r\n              color='primary'\r\n            />\r\n          }\r\n          label='Read Only'\r\n        />\r\n      </Grid>\r\n    );\r\n  }\r\n\r\n  function handleEditReadOnly(e: React.ChangeEvent<HTMLInputElement>) {\r\n    sheetDispatch({ type: \"updateReadOnly\", readOnly: e.target.checked });\r\n  }\r\n\r\n  // ----------------- SHEET PASSWORD -----------------\r\n\r\n  function renderPasswordSetting(): JSX.Element {\r\n    return (\r\n      <>\r\n        <Grid className='bottomMargin' item xs={8}>\r\n          <TextField\r\n            fullWidth\r\n            value={password}\r\n            error={!validPassword}\r\n            label='Sheet Password'\r\n            placeholder='Enter new sheet password here'\r\n            onChange={(e) => setPassword(e.target.value)}\r\n            helperText={\r\n              validPassword\r\n                ? \"\"\r\n                : \"Password must be between 5-25 characters and can only contain these special characters (!, @, #, $, %).\"\r\n            }\r\n            InputProps={{\r\n              readOnly: !editPassword,\r\n              disableUnderline: !editPassword,\r\n              type: viewPassword ? \"default\" : \"password\",\r\n            }}\r\n          />\r\n        </Grid>\r\n        <Grid container item xs={4} justify='flex-end'>\r\n          <Tooltip\r\n            arrow\r\n            title={viewPassword ? \"Hide Password\" : \"View Password\"}\r\n            placement='left'\r\n          >\r\n            <IconButton onClick={() => setViewPassword(!viewPassword)}>\r\n              {viewPassword ? <VisibilityOffIcon /> : <VisibilityIcon />}\r\n            </IconButton>\r\n          </Tooltip>\r\n          {editPassword && (\r\n            <IconButton onClick={cancelPassword}>\r\n              <CloseRoundedIcon />\r\n            </IconButton>\r\n          )}\r\n          <IconButton onClick={handleEditPassword}>\r\n            {editPassword ? <DoneRoundedIcon /> : <EditRoundedIcon />}\r\n          </IconButton>\r\n        </Grid>\r\n\r\n        {editPassword && (\r\n          <>\r\n            <Grid className='bottomMargin' item xs={8}>\r\n              <TextField\r\n                fullWidth\r\n                value={password2}\r\n                error={!passwordsMatch}\r\n                placeholder='Confirm Password'\r\n                onChange={(e) => setPassword2(e.target.value)}\r\n                helperText={passwordsMatch ? \"\" : \"Passwords don't match.\"}\r\n                InputProps={{\r\n                  readOnly: !editPassword,\r\n                  disableUnderline: !editPassword,\r\n                  type: viewPassword ? \"default\" : \"password\",\r\n                }}\r\n              />\r\n            </Grid>\r\n            <Grid\r\n              className='bottomMargin'\r\n              container\r\n              item\r\n              xs={4}\r\n              justify='flex-end'\r\n            >\r\n              <Button color='secondary' onClick={removePassword}>\r\n                REMOVE PASSWORD\r\n              </Button>\r\n            </Grid>\r\n          </>\r\n        )}\r\n      </>\r\n    );\r\n  }\r\n\r\n  function handleEditPassword() {\r\n    if (!editPassword) {\r\n      setEditPassword(true);\r\n    } else {\r\n      confirmPassword();\r\n    }\r\n  }\r\n\r\n  function confirmPassword() {\r\n    if (!password) {\r\n      cancelPassword();\r\n      return;\r\n    }\r\n\r\n    setValidPassword(validatePassword(password));\r\n    if (!validatePassword(password)) return;\r\n\r\n    setPasswordsMatch(password === password2);\r\n    if (password !== password2) return;\r\n\r\n    sheetDispatch({ type: \"updateSheetPassword\", password: password });\r\n    cancelPassword();\r\n  }\r\n\r\n  function cancelPassword() {\r\n    setEditPassword(false);\r\n    setPasswordsMatch(true);\r\n    setValidPassword(true);\r\n    setPassword(\"\");\r\n    setPassword2(\"\");\r\n  }\r\n\r\n  function removePassword() {\r\n    if (sheetState.password) {\r\n      sheetDispatch({ type: \"removeSheetPassword\" });\r\n    }\r\n    cancelPassword();\r\n  }\r\n\r\n  // ----------------- DELETE SHEET -----------------\r\n\r\n  function renderDeleteSheetSetting(): JSX.Element {\r\n    return (\r\n      <>\r\n        <Grid className='bottomMargin' item xs={8}>\r\n          <TextField\r\n            fullWidth\r\n            inputRef={(deleteRef) =>\r\n              deleteRef && editDelete && deleteRef.focus()\r\n            }\r\n            value={deleteText}\r\n            placeholder='Enter sheet name to confirm deletion.'\r\n            error={deleteError}\r\n            label='Delete Sheet'\r\n            onChange={(e) => setDeleteText(e.target.value)}\r\n            helperText={\r\n              deleteError\r\n                ? `Please enter the sheet name correctly (${sheetState.title})`\r\n                : \"\"\r\n            }\r\n            InputProps={{\r\n              readOnly: !editDelete,\r\n              disableUnderline: !editDelete,\r\n            }}\r\n          />\r\n        </Grid>\r\n        <Grid container item xs={4} justify='flex-end'>\r\n          {editDelete && (\r\n            <IconButton onClick={cancelDeleteSheet}>\r\n              <CloseRoundedIcon />\r\n            </IconButton>\r\n          )}\r\n          <IconButton onClick={handleDeleteSheet}>\r\n            {editDelete ? <DoneRoundedIcon /> : <DeleteIcon />}\r\n          </IconButton>\r\n        </Grid>\r\n      </>\r\n    );\r\n  }\r\n\r\n  function handleDeleteSheet() {\r\n    if (!editDelete) {\r\n      setEditDelete(true);\r\n    } else {\r\n      confirmDeleteSheet();\r\n    }\r\n  }\r\n\r\n  async function confirmDeleteSheet() {\r\n    if (!deleteText.trim()) {\r\n      cancelDeleteSheet();\r\n      return;\r\n    }\r\n\r\n    if (deleteText !== sheetState.title) {\r\n      setDeleteError(true);\r\n      return;\r\n    }\r\n\r\n    sheetDispatch({ type: \"deleteSheet\" });\r\n    history.push(\"/\");\r\n    cancelDeleteSheet();\r\n  }\r\n\r\n  function cancelDeleteSheet() {\r\n    setDeleteError(false);\r\n    setEditDelete(false);\r\n    setDeleteText(\"\");\r\n  }\r\n\r\n  return (\r\n    <Dialog\r\n      fullWidth\r\n      disableBackdropClick\r\n      maxWidth='sm'\r\n      onClose={handleClose}\r\n      open={open}\r\n      PaperProps={{ className: \"modal\" }}\r\n    >\r\n      <ModalHeader title='Settings' onClose={handleClose} />\r\n      <DialogContent className='modalContent'>\r\n        <Grid container spacing={0} alignItems='center'>\r\n          {renderSheetTitleSetting()}\r\n          {!sheetState.local && renderCustomLinkSetting()}\r\n          {renderToggleSettings()}\r\n          {!sheetState.local && renderPasswordSetting()}\r\n          {!sheetState.local && renderDeleteSheetSetting()}\r\n        </Grid>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n","import * as React from \"react\";\r\nimport {\r\n  Button,\r\n  Dialog,\r\n  DialogActions,\r\n  DialogContent,\r\n} from \"@material-ui/core\";\r\nimport { useContext } from \"react\";\r\nimport { SheetContext } from \"../pages/SplitTheCost\";\r\nimport { User } from \"../../models/models\";\r\nimport { ModalHeader } from \"./ModalHeader\";\r\nimport { handleKeyPress } from \"../../logic/logic\";\r\n\r\ninterface Props {\r\n  removeUser: User;\r\n  open: boolean;\r\n  setOpen: React.Dispatch<React.SetStateAction<boolean>>;\r\n}\r\n\r\nexport const RemoveUserModal: React.FC<Props> = ({\r\n  removeUser,\r\n  open,\r\n  setOpen,\r\n}) => {\r\n  const { sheetState, sheetDispatch } = useContext(SheetContext);\r\n\r\n  function handleClose() {\r\n    setOpen(false);\r\n  }\r\n\r\n  function confirmRemoveUser() {\r\n    if (removeUser.id !== sheetState.createdBy) {\r\n      sheetDispatch({\r\n        type: \"removeUser\",\r\n        userId: removeUser.id,\r\n      });\r\n    }\r\n\r\n    setOpen(false);\r\n  }\r\n\r\n  return (\r\n    <Dialog\r\n      fullWidth\r\n      disableBackdropClick\r\n      maxWidth='xs'\r\n      onClose={handleClose}\r\n      open={open}\r\n      onKeyPress={(e) => handleKeyPress(e, \"enter\", confirmRemoveUser)}\r\n      PaperProps={{ className: \"modal\" }}\r\n    >\r\n      <ModalHeader title='Remove Friend' onClose={handleClose} />\r\n      <DialogContent>\r\n        Are you sure you want to remove <b>{removeUser.displayName}</b> and all\r\n        associated entries from this sheet?\r\n      </DialogContent>\r\n      <DialogActions className='modalActions'>\r\n        <Button\r\n          className='modalConfirmButton rightMarginSmall'\r\n          onClick={confirmRemoveUser}\r\n        >\r\n          Confirm\r\n        </Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n};\r\n","import * as React from \"react\";\r\nimport {\r\n  Button,\r\n  Dialog,\r\n  DialogActions,\r\n  DialogContent,\r\n  Grid,\r\n} from \"@material-ui/core\";\r\nimport { useContext, useEffect, useState } from \"react\";\r\n// import NumberFormat from \"react-number-format\";\r\nimport { SheetContext } from \"../pages/SplitTheCost\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { ModalHeader } from \"./ModalHeader\";\r\n\r\ninterface Props {\r\n  open: boolean;\r\n  setOpen: React.Dispatch<React.SetStateAction<boolean>>;\r\n}\r\n\r\nexport const SaveSheetModal: React.FC<Props> = ({ open, setOpen }) => {\r\n  const { sheetState, sheetDispatch } = useContext(SheetContext);\r\n\r\n  const history = useHistory();\r\n\r\n  const [buttonText, setButtonText] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    setButtonText(sheetState.local ? \"SAVE\" : \"SAVED\");\r\n  }, [sheetState.local]);\r\n\r\n  function handleClose() {\r\n    setOpen(false);\r\n  }\r\n\r\n  async function confirmSaveSheet() {\r\n    if (sheetState.local) {\r\n      setButtonText(\"SAVING\");\r\n      await new Promise((r) => setTimeout(r, 500));\r\n      sheetDispatch({ type: \"saveSheet\" });\r\n      history.push(`/sheet/${sheetState.id}`);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Dialog\r\n      fullWidth\r\n      disableBackdropClick\r\n      maxWidth='xs'\r\n      onClose={handleClose}\r\n      open={open}\r\n      PaperProps={{ className: \"modal\" }}\r\n    >\r\n      <ModalHeader title='Save Sheet' onClose={handleClose} />\r\n      <DialogContent className='modalContent bottomMargin'>\r\n        <Grid container spacing={0} alignItems='center'>\r\n          Would you like to save this sheet to the cloud for future access?\r\n        </Grid>\r\n      </DialogContent>\r\n      <DialogActions className='modalActions'>\r\n        <Button\r\n          className='modalConfirmButton rightMarginSmall'\r\n          disabled={!sheetState.local}\r\n          onClick={confirmSaveSheet}\r\n        >\r\n          {buttonText}\r\n        </Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n};\r\n","import * as React from \"react\";\r\nimport { Grid, IconButton, Tooltip } from \"@material-ui/core\";\r\nimport { AddUserModal } from \"../modals/AddUserModal\";\r\nimport { useState } from \"react\";\r\nimport { SettingsModal } from \"../modals/SettingsModal\";\r\nimport { useContext } from \"react\";\r\nimport { UserContext } from \"../../App\";\r\nimport { SheetContext } from \"../pages/SplitTheCost\";\r\nimport { UserChip } from \"../bits/UserChip\";\r\nimport { RemoveUserModal } from \"../modals/RemoveUserModal\";\r\nimport { User } from \"../../models/models\";\r\nimport { SaveSheetModal } from \"../modals/SaveSheetModal\";\r\nimport AddRoundedIcon from \"@material-ui/icons/AddRounded\";\r\nimport SettingsRoundedIcon from \"@material-ui/icons/SettingsRounded\";\r\nimport SaveRoundedIcon from \"@material-ui/icons/SaveRounded\";\r\n\r\nexport const UsersBar: React.FC = () => {\r\n  const { userState } = useContext(UserContext);\r\n  const { sheetState } = useContext(SheetContext);\r\n\r\n  const [openAddUser, setOpenAddUser] = useState(false);\r\n  const [openRemoveUser, setOpenRemoveUser] = useState(false);\r\n  const [openSettings, setOpenSettings] = useState(false);\r\n  const [openSaveSheet, setOpenSaveSheet] = useState(false);\r\n\r\n  const [removeUser, setRemoveUser] = useState<User>();\r\n\r\n  function openSettingsModal() {\r\n    setOpenSettings(true);\r\n  }\r\n\r\n  function openAddUserModal() {\r\n    setOpenAddUser(true);\r\n  }\r\n\r\n  function openRemoveUserModal(user: User) {\r\n    setRemoveUser(user);\r\n    setOpenRemoveUser(true);\r\n  }\r\n\r\n  function openSaveSheetModal() {\r\n    setOpenSaveSheet(true);\r\n  }\r\n\r\n  function renderUsers(): JSX.Element {\r\n    return (\r\n      <>\r\n        {userState.curUser && (\r\n          <UserChip\r\n            className='leftMargin bottomMargin'\r\n            user={userState.curUser}\r\n            userIdx={Object.keys(sheetState.users).indexOf(\r\n              userState.curUser.id\r\n            )}\r\n          />\r\n        )}\r\n        {Object.entries(sheetState.users).map((pair) => {\r\n          const user = pair[1];\r\n          return (\r\n            (!userState.curUser || user.id !== userState.curUser.id) && (\r\n              <UserChip\r\n                className='leftMargin bottomMargin'\r\n                user={user}\r\n                userIdx={Object.keys(sheetState.users).indexOf(user.id)}\r\n                onRemove={\r\n                  !sheetState.readOnly &&\r\n                  userState.curUser &&\r\n                  sheetState.createdBy !== user.id\r\n                    ? openRemoveUserModal\r\n                    : undefined\r\n                }\r\n                key={user.id}\r\n              />\r\n            )\r\n          );\r\n        })}\r\n        {!sheetState.readOnly &&\r\n          userState.curUser &&\r\n          Object.keys(sheetState.users).length < 10 && (\r\n            <Tooltip arrow title='Add Friend' placement='right'>\r\n              <IconButton\r\n                className='iconButton smallIconButton leftMargin bottomMargin'\r\n                onClick={openAddUserModal}\r\n              >\r\n                <AddRoundedIcon />\r\n              </IconButton>\r\n            </Tooltip>\r\n          )}\r\n      </>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Grid className='usersBar' container spacing={0}>\r\n        <Grid item container xs={11} alignItems='center'>\r\n          {userState.authenticated && renderUsers()}\r\n        </Grid>\r\n        <Grid item container xs={1} justify='flex-end' alignItems='center'>\r\n          {sheetState.local && (\r\n            <Tooltip arrow title='Save Sheet' placement='left'>\r\n              <IconButton\r\n                className='iconButton smallIconButton rightMargin bottomMargin'\r\n                onClick={openSaveSheetModal}\r\n              >\r\n                <SaveRoundedIcon />\r\n              </IconButton>\r\n            </Tooltip>\r\n          )}\r\n          {userState.curUser?.id === sheetState.createdBy && (\r\n            <Tooltip arrow title='Settings' placement='left'>\r\n              <IconButton\r\n                className='iconButton smallIconButton rightMargin bottomMargin'\r\n                onClick={openSettingsModal}\r\n              >\r\n                <SettingsRoundedIcon />\r\n              </IconButton>\r\n            </Tooltip>\r\n          )}\r\n        </Grid>\r\n      </Grid>\r\n      <AddUserModal open={openAddUser} setOpen={setOpenAddUser} />\r\n      <SettingsModal open={openSettings} setOpen={setOpenSettings} />\r\n      {removeUser && (\r\n        <RemoveUserModal\r\n          removeUser={removeUser}\r\n          open={openRemoveUser}\r\n          setOpen={setOpenRemoveUser}\r\n        />\r\n      )}\r\n      <SaveSheetModal open={openSaveSheet} setOpen={setOpenSaveSheet} />\r\n    </>\r\n  );\r\n};\r\n","import { Grid } from \"@material-ui/core\";\r\nimport * as React from \"react\";\r\n\r\nexport const OverviewHeader: React.FC = () => {\r\n  return (\r\n    <Grid className='gridHeader roundedTop' container spacing={0}>\r\n      <Grid item xs={2}></Grid>\r\n      <Grid item xs={5}>\r\n        <span className='leftMargin'>TOTAL SPENT</span>\r\n      </Grid>\r\n      <Grid item xs={5}>\r\n        <span className='leftMargin'>TOTAL OWED</span>\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n};\r\n","import { Grid, Input, InputAdornment } from \"@material-ui/core\";\r\nimport * as React from \"react\";\r\n// import NumberFormat from \"react-number-format\";\r\nimport { User } from \"../../../models/models\";\r\nimport { UserAvatar } from \"../../bits/UserAvatar\";\r\nimport { SheetContext } from \"../../pages/SplitTheCost\";\r\nimport { useContext } from \"react\";\r\n\r\ninterface Props {\r\n  user: User;\r\n  data: { totalSpent: number; totalOwed: number };\r\n  idx: number;\r\n}\r\n\r\nexport const OverviewRow: React.FC<Props> = ({ user, data, idx }) => {\r\n  const { sheetState } = useContext(SheetContext);\r\n\r\n  return (\r\n    <Grid\r\n      className={`${idx % 2 ? \"lightRow\" : \"darkRow\"} ${\r\n        idx === sheetState.numUsers - 1 && \"roundedBottom\"\r\n      }`}\r\n      container\r\n      spacing={0}\r\n    >\r\n      <Grid className='sideDialogRow' item xs={2}>\r\n        <UserAvatar\r\n          className='leftMargin'\r\n          user={user}\r\n          userIdx={Object.keys(sheetState.users).indexOf(user.id)}\r\n          tooltipPlacement='left'\r\n        />\r\n      </Grid>\r\n      <Grid className='sideDialogRow' item xs={5}>\r\n        <Input\r\n          className='sideMargins'\r\n          readOnly\r\n          disableUnderline\r\n          fullWidth\r\n          // inputComponent={NumberFormat as any}\r\n          // inputProps={{\r\n          //   decimalScale: 2,\r\n          //   allowNegative: false,\r\n          //   thousandSeparator: \",\",\r\n          // }}\r\n          value={data ? data?.totalSpent.toFixed(2) : 0}\r\n          startAdornment={<InputAdornment position='start'>$</InputAdornment>}\r\n        />\r\n      </Grid>\r\n      <Grid className='sideDialogRow' item xs={5}>\r\n        <>\r\n          <Input\r\n            readOnly\r\n            disableUnderline\r\n            fullWidth\r\n            // inputComponent={NumberFormat as any}\r\n            // inputProps={{\r\n            //   decimalScale: 2,\r\n            //   allowNegative: false,\r\n            //   thousandSeparator: \",\",\r\n            // }}\r\n            className='sideMargins'\r\n            value={data ? data?.totalOwed.toFixed(2) : 0}\r\n            startAdornment={<InputAdornment position='start'>$</InputAdornment>}\r\n          />\r\n        </>\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n};\r\n","import * as React from \"react\";\r\nimport { useEffect, useState, useContext } from \"react\";\r\nimport { OverviewData } from \"../../../models/models\";\r\nimport { OverviewHeader } from \"./OverviewHeader\";\r\nimport { OverviewRow } from \"./OverviewRow\";\r\nimport { calculateOverview } from \"../../../logic/logic\";\r\nimport { SheetContext } from \"../../pages/SplitTheCost\";\r\nimport { UserContext } from \"../../../App\";\r\n\r\nexport const Overview: React.FC = () => {\r\n  const { sheetState } = useContext(SheetContext);\r\n  const { userState } = useContext(UserContext);\r\n\r\n  const [overviewData, setOverviewData] = useState<OverviewData>({});\r\n  let rowIdx = 0;\r\n\r\n  useEffect(() => {\r\n    setOverviewData(calculateOverview(sheetState.entries, sheetState.users));\r\n  }, [sheetState]);\r\n\r\n  return (\r\n    <>\r\n      <OverviewHeader />\r\n      {userState.curUser && (\r\n        <OverviewRow\r\n          user={userState.curUser}\r\n          data={overviewData[userState.curUser.id]}\r\n          idx={rowIdx++}\r\n        />\r\n      )}\r\n      {Object.entries(sheetState.users).map((pair) => {\r\n        let user = pair[1];\r\n        return (\r\n          user.id !== userState.curUser?.id && (\r\n            <OverviewRow\r\n              user={user}\r\n              data={overviewData[user.id]}\r\n              idx={rowIdx++}\r\n              key={user.id}\r\n            />\r\n          )\r\n        );\r\n      })}\r\n    </>\r\n  );\r\n};\r\n","import { Grid } from \"@material-ui/core\";\r\nimport * as React from \"react\";\r\n\r\nexport const BreakdownHeader: React.FC = () => {\r\n  return (\r\n    <Grid className='gridHeader roundedTop' container spacing={0}>\r\n      <Grid item xs={8}>\r\n        <span className='leftMargin'>TRANSACTIONS</span>\r\n      </Grid>\r\n      <Grid item xs={4}>\r\n        <span className='leftMargin'>TOTAL</span>\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n};\r\n","import { Grid, Input, InputAdornment } from \"@material-ui/core\";\r\nimport * as React from \"react\";\r\nimport { useContext } from \"react\";\r\nimport NumberFormat from \"react-number-format\";\r\nimport { UserContext } from \"../../../App\";\r\nimport { User } from \"../../../models/models\";\r\nimport { SheetContext } from \"../../pages/SplitTheCost\";\r\nimport { UserAvatar } from \"../../bits/UserAvatar\";\r\n\r\ninterface Props {\r\n  user: User;\r\n  data?: { theyOwe: number; youOwe: number };\r\n  idx: number;\r\n}\r\n\r\nexport const BreakdownRow: React.FC<Props> = ({ user, data, idx }) => {\r\n  const { sheetState } = useContext(SheetContext);\r\n  const { userState } = useContext(UserContext);\r\n\r\n  const netCost = data ? data.theyOwe - data.youOwe : 0;\r\n  const debtedUser = netCost < 0 ? userState.curUser! : user;\r\n  const owedUser = netCost < 0 ? user : userState.curUser!;\r\n\r\n  return (\r\n    <Grid\r\n      className={`${idx % 2 ? \"lightRow\" : \"darkRow\"} ${\r\n        idx === sheetState.numUsers - 2 && \"roundedBottom\"\r\n      }`}\r\n      container\r\n      spacing={0}\r\n    >\r\n      <Grid className='sideDialogRow' item xs={2}>\r\n        <UserAvatar\r\n          className='leftMargin'\r\n          user={debtedUser}\r\n          userIdx={Object.keys(sheetState.users).indexOf(debtedUser.id)}\r\n          tooltipPlacement='left'\r\n        />\r\n      </Grid>\r\n      <Grid className='sideDialogRow' item xs={4}>\r\n        {netCost === 0 ? (\r\n          <div className='leftMargin evenArrow'>\r\n            <span>EVEN</span>\r\n          </div>\r\n        ) : (\r\n          <div className={`arrow ${netCost < 0 ? \"redArrow\" : \"greenArrow\"}`}>\r\n            <span className='leftMarginSmall'>\r\n              {netCost < 0 ? \"YOU OWE\" : \"OWES YOU\"}\r\n            </span>\r\n          </div>\r\n        )}\r\n      </Grid>\r\n      <Grid className='sideDialogRow' item xs={2}>\r\n        <UserAvatar\r\n          user={owedUser}\r\n          userIdx={Object.keys(sheetState.users).indexOf(owedUser.id)}\r\n          tooltipPlacement='top'\r\n        />\r\n      </Grid>\r\n      <Grid className='sideDialogRow' item xs={4}>\r\n        <Input\r\n          className='sideMargins'\r\n          readOnly\r\n          disableUnderline\r\n          fullWidth\r\n          inputComponent={NumberFormat as any}\r\n          inputProps={{\r\n            decimalScale: 2,\r\n            allowNegative: false,\r\n            thousandSeparator: \",\",\r\n          }}\r\n          value={Math.abs(netCost).toFixed(2)}\r\n          startAdornment={<InputAdornment position='start'>$</InputAdornment>}\r\n        />\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n};\r\n","import * as React from \"react\";\r\nimport { useEffect, useState, useContext } from \"react\";\r\nimport { UserBreakdownData } from \"../../../models/models\";\r\nimport { BreakdownHeader } from \"./BreakdownHeader\";\r\nimport { BreakdownRow } from \"./BreakdownRow\";\r\nimport { UserContext } from \"../../../App\";\r\nimport { SheetContext } from \"../../pages/SplitTheCost\";\r\nimport { calculateUserBreakdown } from \"../../../logic/logic\";\r\n\r\nexport const Breakdown: React.FC = () => {\r\n  const { sheetState } = useContext(SheetContext);\r\n  const { userState } = useContext(UserContext);\r\n\r\n  const [breakdownData, setBreakdownData] = useState<UserBreakdownData>();\r\n  let rowIdx = 0;\r\n\r\n  useEffect(() => {\r\n    if (userState.curUser) {\r\n      setBreakdownData(\r\n        calculateUserBreakdown(\r\n          userState.curUser,\r\n          sheetState.entries,\r\n          sheetState.users\r\n        )\r\n      );\r\n    }\r\n  }, [userState.curUser, sheetState]);\r\n\r\n  return !userState.curUser || !breakdownData || sheetState.numUsers < 2 ? (\r\n    <div className='noBreakdownData'>No data to break down. &#129396;</div>\r\n  ) : (\r\n    <>\r\n      <BreakdownHeader />\r\n      {Object.entries(sheetState.users).map((pair) => {\r\n        let user = pair[1];\r\n        return (\r\n          user.id !== userState.curUser!.id && (\r\n            <BreakdownRow\r\n              user={user}\r\n              data={breakdownData.userBreakdown[user.id]}\r\n              idx={rowIdx++}\r\n              key={user.id}\r\n            />\r\n          )\r\n        );\r\n      })}\r\n    </>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { Overview } from \"./overview/Overview\";\r\nimport ArrowBackRoundedIcon from \"@material-ui/icons/ArrowBackRounded\";\r\nimport ArrowForwardRoundedIcon from \"@material-ui/icons/ArrowForwardRounded\";\r\nimport { Fab, Tabs, Tab } from \"@material-ui/core\";\r\nimport { AnimatePresence, motion } from \"framer-motion\";\r\nimport { Breakdown } from \"./breakdown/Breakdown\";\r\nimport { TabContext, TabPanel } from \"@material-ui/lab\";\r\nimport { useState } from \"react\";\r\n\r\nexport const SideDialog: React.FC = () => {\r\n  const [open, setOpen] = useState(true);\r\n  const [tab, setTab] = useState(\"ov\");\r\n\r\n  function handleOpen() {\r\n    setOpen(!open);\r\n  }\r\n\r\n  function handleChange(event: React.ChangeEvent<{}>, value: string) {\r\n    setTab(value);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <AnimatePresence>\r\n        {open && (\r\n          <motion.div\r\n            className='sideDialog'\r\n            animate={{ x: 0, opacity: 1 }}\r\n            initial={{ x: 600, opacity: 0 }}\r\n            exit={{ x: 600, opacity: 0 }}\r\n            transition={{ duration: 0.3 }}\r\n          >\r\n            <TabContext value={tab}>\r\n              <Tabs\r\n                value={tab}\r\n                onChange={handleChange}\r\n                indicatorColor='primary'\r\n                textColor='primary'\r\n              >\r\n                <Tab className='sideDialogTab' value='ov' label='OVERVIEW' />\r\n                <Tab className='sideDialogTab' value='bd' label='BREAKDOWN' />\r\n              </Tabs>\r\n              <motion.div\r\n                animate={tab === \"ov\" ? { opacity: 1 } : { opacity: 0 }}\r\n                transition={{ duration: 0.7 }}\r\n              >\r\n                <TabPanel className='sideDialogContent' value={\"ov\"}>\r\n                  <Overview />\r\n                </TabPanel>\r\n              </motion.div>\r\n              <motion.div\r\n                animate={tab === \"bd\" ? { opacity: 1 } : { opacity: 0 }}\r\n                transition={{ duration: 0.7 }}\r\n              >\r\n                <TabPanel className='sideDialogContent' value={\"bd\"}>\r\n                  <Breakdown />\r\n                </TabPanel>\r\n              </motion.div>\r\n            </TabContext>\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n      <motion.div\r\n        className='sideDialogFab'\r\n        animate={open ? { x: -440 } : { x: 0 }}\r\n        transition={{ duration: 0.3 }}\r\n      >\r\n        <Fab variant='extended' size='medium' onClick={handleOpen}>\r\n          {open ? <ArrowForwardRoundedIcon /> : <ArrowBackRoundedIcon />}\r\n        </Fab>\r\n      </motion.div>\r\n    </>\r\n  );\r\n};\r\n","import * as React from \"react\";\r\nimport { Fab } from \"@material-ui/core\";\r\nimport { useContext } from \"react\";\r\nimport AddRoundedIcon from \"@material-ui/icons/AddRounded\";\r\nimport { UserContext } from \"../../App\";\r\nimport { SheetContext } from \"../pages/SplitTheCost\";\r\n\r\nexport const AddItemFab: React.FC = () => {\r\n  const { sheetDispatch } = useContext(SheetContext);\r\n  const { userState } = useContext(UserContext);\r\n\r\n  function addEntry() {\r\n    sheetDispatch({\r\n      type: \"addEntry\",\r\n      createdBy: userState.curUser!.id,\r\n      item: \"\",\r\n      cost: 0,\r\n      exclude: [],\r\n      note: \"\",\r\n    });\r\n  }\r\n\r\n  return (\r\n    <div className='addItemFabDiv'>\r\n      <Fab\r\n        className='addItemFab'\r\n        variant='extended'\r\n        size='medium'\r\n        onClick={addEntry}\r\n      >\r\n        <AddRoundedIcon />\r\n        <span className='leftMarginSmall'>Add Expense</span>\r\n      </Fab>\r\n    </div>\r\n  );\r\n};\r\n","import { nanoid } from \"nanoid\";\r\nimport { db, sheetStateConverter } from \"../firebase\";\r\nimport { Entry, SaveState, SheetState, User } from \"../models/models\";\r\n\r\nexport type AddEntryAction = {\r\n  type: \"addEntry\";\r\n  createdBy: string;\r\n  item?: string;\r\n  cost?: number;\r\n  exclude?: string[];\r\n  note?: string;\r\n  local?: boolean;\r\n};\r\nexport type RemoveEntryAction = {\r\n  type: \"removeEntry\";\r\n  entryId: string;\r\n  local?: boolean;\r\n};\r\nexport type UpdateEntryAction = {\r\n  type: \"updateEntry\";\r\n  entry: Entry;\r\n  section: \"item\" | \"cost\" | \"note\" | \"user\";\r\n  value: string;\r\n  local?: boolean;\r\n};\r\nexport type AddUserAction = {\r\n  type: \"addUser\";\r\n  firstName: string;\r\n  lastName: string;\r\n  email: string;\r\n  local?: boolean;\r\n};\r\nexport type RemoveUserAction = {\r\n  type: \"removeUser\";\r\n  userId: string;\r\n  local?: boolean;\r\n};\r\nexport type UpdateExcludedUsersAction = {\r\n  type: \"updateExcludedUsers\";\r\n  exclude: string[];\r\n  entry: Entry;\r\n  local?: boolean;\r\n};\r\nexport type RemoveExcludedUserAction = {\r\n  type: \"removeExcludedUser\";\r\n  userId: string;\r\n  entry: Entry;\r\n  local?: boolean;\r\n};\r\nexport type ChangeSheetTitleAction = {\r\n  type: \"changeSheetTitle\";\r\n  title: string;\r\n};\r\nexport type ChangeSheetLinkAction = {\r\n  type: \"changeSheetLink\";\r\n  link: string;\r\n};\r\nexport type UpdateReadOnlyAction = {\r\n  type: \"updateReadOnly\";\r\n  readOnly: boolean;\r\n};\r\nexport type UpdateSheetPasswordAction = {\r\n  type: \"updateSheetPassword\";\r\n  password: string;\r\n};\r\nexport type RemoveSheetPasswordAction = {\r\n  type: \"removeSheetPassword\";\r\n};\r\nexport type SaveSheetAction = {\r\n  type: \"saveSheet\";\r\n};\r\nexport type AutosaveSheetAction = {\r\n  type: \"autosaveSheet\";\r\n  setAutosaveState: React.Dispatch<React.SetStateAction<SaveState>>;\r\n};\r\nexport type DeleteSheetAction = {\r\n  type: \"deleteSheet\";\r\n};\r\nexport type UpdateSheetStateAction = {\r\n  type: \"updateSheetState\";\r\n  sheetState: SheetState;\r\n};\r\n\r\nexport type SheetAction =\r\n  | AddEntryAction\r\n  | RemoveEntryAction\r\n  | UpdateEntryAction\r\n  | AddUserAction\r\n  | RemoveUserAction\r\n  | UpdateExcludedUsersAction\r\n  | RemoveExcludedUserAction\r\n  | ChangeSheetTitleAction\r\n  | ChangeSheetLinkAction\r\n  | UpdateSheetPasswordAction\r\n  | RemoveSheetPasswordAction\r\n  | SaveSheetAction\r\n  | AutosaveSheetAction\r\n  | UpdateReadOnlyAction\r\n  | DeleteSheetAction\r\n  | UpdateSheetStateAction;\r\n\r\nexport function sheetReducer(state: SheetState, action: SheetAction) {\r\n  switch (action.type) {\r\n    case \"addEntry\":\r\n      return addEntry(state, action);\r\n    case \"removeEntry\":\r\n      return removeEntry(state, action);\r\n    case \"updateEntry\":\r\n      return updateEntry(state, action);\r\n    case \"addUser\":\r\n      return addUser(state, action);\r\n    case \"removeUser\":\r\n      return removeUser(state, action);\r\n    case \"updateExcludedUsers\":\r\n      return updateExcludedUsers(state, action);\r\n    case \"removeExcludedUser\":\r\n      return removeExcludedUser(state, action);\r\n    case \"changeSheetTitle\":\r\n      return changeSheetTitle(state, action);\r\n    case \"changeSheetLink\":\r\n      return changeSheetLink(state, action);\r\n    case \"updateSheetPassword\":\r\n      return updateSheetPassword(state, action);\r\n    case \"removeSheetPassword\":\r\n      return removeSheetPassword(state, action);\r\n    case \"saveSheet\":\r\n      return saveSheet(state, action);\r\n    case \"autosaveSheet\":\r\n      return autosaveSheet(state, action);\r\n    case \"updateReadOnly\":\r\n      return updateReadOnly(state, action);\r\n    case \"deleteSheet\":\r\n      return deleteSheet(state, action);\r\n    case \"updateSheetState\":\r\n      return action.sheetState;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\n// ----------------- SHEET ACTIONS -----------------\r\n\r\n// Add a new entry to the sheet.\r\nfunction addEntry(state: SheetState, action: AddEntryAction): SheetState {\r\n  const newEntry: Entry = {\r\n    id: nanoid(),\r\n    timestamp: new Date(Date.now()).toUTCString(),\r\n    lastEdited: Date.now(),\r\n    item: action.item ? action.item : \"\",\r\n    cost: action.cost ? action.cost : 0,\r\n    exclude: action.exclude ? action.exclude : [],\r\n    note: action.note ? action.note : \"\",\r\n    user: action.createdBy,\r\n    createdBy: action.createdBy,\r\n  };\r\n\r\n  const newSheetState: SheetState = {\r\n    ...state,\r\n    entries: [...state.entries, newEntry],\r\n    lastEdited: Date.now(),\r\n  };\r\n  updateFirestore(newSheetState, action.local);\r\n  return newSheetState;\r\n}\r\n\r\n// Remove an entry from the sheet.\r\nfunction removeEntry(state: SheetState, action: RemoveEntryAction): SheetState {\r\n  const newEntries = state.entries.filter(\r\n    (entry) => entry.id !== action.entryId\r\n  );\r\n\r\n  const newSheetState: SheetState = {\r\n    ...state,\r\n    entries: newEntries,\r\n    lastEdited: Date.now(),\r\n  };\r\n  updateFirestore(newSheetState, action.local);\r\n  return newSheetState;\r\n}\r\n\r\n// Update a section of an entry.\r\nfunction updateEntry(state: SheetState, action: UpdateEntryAction): SheetState {\r\n  const entry = action.entry;\r\n  const value = action.value;\r\n  let newEntry: Entry = { ...entry, lastEdited: Date.now() };\r\n\r\n  if (action.section === \"item\") {\r\n    if (entry.item === value) return state;\r\n    newEntry = { ...newEntry, item: value };\r\n  } else if (action.section === \"cost\") {\r\n    newEntry = { ...newEntry, cost: Number(value.replaceAll(\",\", \"\")) };\r\n  } else if (action.section === \"user\") {\r\n    if (entry.user === value) return state;\r\n    newEntry = { ...newEntry, user: value };\r\n  } else {\r\n    if (entry.note === value) return state;\r\n    newEntry = { ...newEntry, note: value };\r\n  }\r\n  const newEntries = [...state.entries];\r\n  newEntries[newEntries.indexOf(entry)] = newEntry;\r\n\r\n  const newSheetState: SheetState = {\r\n    ...state,\r\n    entries: newEntries,\r\n    lastEdited: Date.now(),\r\n  };\r\n  return newSheetState;\r\n}\r\n\r\n// Add a user to the sheet.\r\nfunction addUser(state: SheetState, action: AddUserAction): SheetState {\r\n  if (state.numUsers >= 10) return state;\r\n\r\n  let duplicateUser = false;\r\n  Object.entries(state.users).forEach((pair) => {\r\n    const user = pair[1];\r\n    if (\r\n      user.firstName === action.firstName &&\r\n      user.lastName === action.lastName\r\n    ) {\r\n      duplicateUser = true;\r\n    }\r\n  });\r\n\r\n  if (duplicateUser) return state;\r\n\r\n  const newUser: User = {\r\n    id: nanoid(),\r\n    firstName: action.firstName,\r\n    lastName: action.lastName,\r\n    initials: `${action.firstName.charAt(0)}${action.lastName.charAt(\r\n      0\r\n    )}`.toLocaleUpperCase(),\r\n    displayName: `${action.firstName} ${action.lastName}`,\r\n    email: action.email,\r\n  };\r\n\r\n  const newSheetState: SheetState = {\r\n    ...state,\r\n    users: { ...state.users, [newUser.id]: newUser },\r\n    numUsers: state.numUsers + 1,\r\n    lastEdited: Date.now(),\r\n  };\r\n  updateFirestore(newSheetState, action.local);\r\n  return newSheetState;\r\n}\r\n\r\n// Remove a user from the sheet.\r\nfunction removeUser(state: SheetState, action: RemoveUserAction): SheetState {\r\n  if (state.numUsers === 1) return state;\r\n\r\n  // Remove user from users dictionary.\r\n  const newUsers = { ...state.users };\r\n  delete newUsers[action.userId];\r\n\r\n  // Remove entries created by the user and/or associated with the user.\r\n  const newEntries = state.entries.filter(\r\n    (entry) => entry.createdBy !== action.userId && entry.user !== action.userId\r\n  );\r\n\r\n  // Remove user from any excluded user lists.\r\n  newEntries.forEach((entry, idx) => {\r\n    if (entry.exclude.includes(action.userId)) {\r\n      let newExcludedUsers = entry.exclude.filter(\r\n        (curId) => action.userId !== curId\r\n      );\r\n      let updatedEntry = { ...entry, exclude: newExcludedUsers };\r\n      newEntries[idx] = updatedEntry;\r\n    }\r\n  });\r\n\r\n  const newSheetState: SheetState = {\r\n    ...state,\r\n    entries: newEntries,\r\n    users: newUsers,\r\n    numUsers: state.numUsers - 1,\r\n    lastEdited: Date.now(),\r\n  };\r\n  updateFirestore(newSheetState, action.local);\r\n  return newSheetState;\r\n}\r\n\r\n// Update the excluded userIds for a specific entry.\r\nfunction updateExcludedUsers(\r\n  state: SheetState,\r\n  action: UpdateExcludedUsersAction\r\n): SheetState {\r\n  const newEntry = {\r\n    ...action.entry,\r\n    exclude: action.exclude,\r\n  };\r\n  const newEntries = [...state.entries];\r\n  newEntries[newEntries.indexOf(action.entry)] = newEntry;\r\n\r\n  const newSheetState: SheetState = {\r\n    ...state,\r\n    entries: newEntries,\r\n    lastEdited: Date.now(),\r\n  };\r\n  updateFirestore(newSheetState, action.local);\r\n  return newSheetState;\r\n}\r\n\r\n// Remove an excluded user from a specific entry.\r\nfunction removeExcludedUser(\r\n  state: SheetState,\r\n  action: RemoveExcludedUserAction\r\n): SheetState {\r\n  const newEntry = {\r\n    ...action.entry,\r\n    exclude: action.entry.exclude.filter((userId) => userId !== action.userId),\r\n  };\r\n  const newEntries = [...state.entries];\r\n  newEntries[newEntries.indexOf(action.entry)] = newEntry;\r\n\r\n  const newSheetState: SheetState = {\r\n    ...state,\r\n    entries: newEntries,\r\n    lastEdited: Date.now(),\r\n  };\r\n  updateFirestore(newSheetState, action.local);\r\n  return newSheetState;\r\n}\r\n\r\n// Update the sheet's title.\r\nfunction changeSheetTitle(\r\n  state: SheetState,\r\n  action: ChangeSheetTitleAction\r\n): SheetState {\r\n  if (state.title === action.title) return state;\r\n\r\n  const newSheetState: SheetState = {\r\n    ...state,\r\n    title: action.title,\r\n    lastEdited: Date.now(),\r\n  };\r\n  updateFirestore(newSheetState);\r\n  return newSheetState;\r\n}\r\n\r\n// Update the sheet's custom link.\r\nfunction changeSheetLink(\r\n  state: SheetState,\r\n  action: ChangeSheetLinkAction\r\n): SheetState {\r\n  if (\r\n    !action.link ||\r\n    state.customLink === action.link ||\r\n    action.link.length < 5\r\n  )\r\n    return state;\r\n\r\n  // Remove any existing custom links from Firestore.\r\n  if (state.customLink) {\r\n    db.collection(\"customLinks\").doc(state.customLink).delete();\r\n  }\r\n\r\n  // Add the new custom link to Firestore.\r\n  const firebaseLink = { sheetId: state.id };\r\n  db.collection(\"customLinks\").doc(action.link).set(firebaseLink);\r\n\r\n  const newSheetState: SheetState = {\r\n    ...state,\r\n    customLink: action.link,\r\n    lastEdited: Date.now(),\r\n  };\r\n  updateFirestore(newSheetState);\r\n  return newSheetState;\r\n}\r\n\r\nfunction updateSheetPassword(\r\n  state: SheetState,\r\n  action: UpdateSheetPasswordAction\r\n): SheetState {\r\n  if (state.local) return state;\r\n\r\n  const bcrypt = require(\"bcryptjs\");\r\n  const saltRounds = 10;\r\n\r\n  bcrypt.hash(action.password, saltRounds, function (err: Error, hash: string) {\r\n    if (!err) {\r\n      const newSheetState = {\r\n        ...state,\r\n        password: hash,\r\n        lastEdited: Date.now(),\r\n      };\r\n      updateFirestore(newSheetState);\r\n      return newSheetState;\r\n    }\r\n  });\r\n\r\n  return state;\r\n}\r\n\r\n// Remove the current sheet's password (if one exists).\r\nfunction removeSheetPassword(\r\n  state: SheetState,\r\n  action: RemoveSheetPasswordAction\r\n): SheetState {\r\n  if (state.password) {\r\n    const newSheetState = { ...state, password: \"\", lastEdited: Date.now() };\r\n    updateFirestore(newSheetState);\r\n    return newSheetState;\r\n  }\r\n\r\n  return state;\r\n}\r\n\r\n// Save the sheet in Firestore and set the sheet to auto-update.\r\nfunction saveSheet(state: SheetState, action: SaveSheetAction): SheetState {\r\n  if (!state.local) return state;\r\n\r\n  const newSheetState = { ...state, local: false, lastEdited: Date.now() };\r\n  updateFirestore(newSheetState);\r\n  return newSheetState;\r\n}\r\n\r\nfunction autosaveSheet(\r\n  state: SheetState,\r\n  action: AutosaveSheetAction\r\n): SheetState {\r\n  if (Date.now() - state.lastEdited < 11000) {\r\n    action.setAutosaveState(SaveState.Saving);\r\n    updateFirestore(state);\r\n  }\r\n\r\n  return state;\r\n}\r\n\r\nfunction updateReadOnly(\r\n  state: SheetState,\r\n  action: UpdateReadOnlyAction\r\n): SheetState {\r\n  const newSheetState = {\r\n    ...state,\r\n    readOnly: action.readOnly,\r\n    lastEdited: Date.now(),\r\n  };\r\n  updateFirestore(newSheetState);\r\n  return newSheetState;\r\n}\r\n\r\nfunction deleteSheet(state: SheetState, action: DeleteSheetAction): SheetState {\r\n  if (state.local) {\r\n    return state;\r\n  }\r\n\r\n  db.collection(\"deletedSheets\")\r\n    .withConverter(sheetStateConverter)\r\n    .doc(state.id)\r\n    .set(state);\r\n  db.collection(\"sheets\").doc(state.id).delete();\r\n\r\n  if (state.customLink) {\r\n    db.collection(\"deletedCustomLinks\")\r\n      .doc(state.customLink)\r\n      .set({ sheetId: state.id });\r\n    db.collection(\"customLinks\").doc(state.customLink).delete();\r\n  }\r\n\r\n  return state;\r\n}\r\n\r\nfunction updateFirestore(state: SheetState, local?: boolean) {\r\n  if (local || state.local) return;\r\n\r\n  db.collection(\"sheets\")\r\n    .withConverter(sheetStateConverter)\r\n    .doc(state.id)\r\n    .set(state);\r\n}\r\n","import {\r\n  Button,\r\n  Checkbox,\r\n  FormControlLabel,\r\n  Grid,\r\n  IconButton,\r\n  TextField,\r\n} from \"@material-ui/core\";\r\nimport React, { useContext, useState } from \"react\";\r\nimport { Link, useHistory } from \"react-router-dom\";\r\nimport CloseRoundedIcon from \"@material-ui/icons/CloseRounded\";\r\nimport { motion } from \"framer-motion\";\r\nimport { UserContext } from \"../../App\";\r\nimport { User } from \"../../models/models\";\r\nimport { nanoid } from \"nanoid\";\r\nimport { validateName, validateSheetTitle } from \"../../logic/logic\";\r\n\r\nenum CreateSheetStep {\r\n  SheetName = 1,\r\n  DisplayName = 2,\r\n}\r\n\r\nexport const CreateNewSheet: React.FC = () => {\r\n  const { userDispatch } = useContext(UserContext);\r\n  const history = useHistory();\r\n\r\n  const [step, setStep] = useState(CreateSheetStep.SheetName);\r\n\r\n  const [sheetTitle, setSheetTitle] = useState(\"\");\r\n  const [validTitle, setValidTitle] = useState(true);\r\n  const [agreeToTerms, setAgreeToTerms] = useState(false);\r\n  const [firstName, setFirstName] = useState(\"\");\r\n  const [validFirstName, setValidFirstName] = useState(true);\r\n  const [lastName, setLastName] = useState(\"\");\r\n  const [validLastName, setValidLastName] = useState(true);\r\n\r\n  function handleTitleButton() {\r\n    const temp = validateSheetTitle(sheetTitle);\r\n    setValidTitle(temp);\r\n    if (temp) {\r\n      setStep(CreateSheetStep.DisplayName);\r\n    }\r\n  }\r\n\r\n  function handleNameButton() {\r\n    const validFirst = validateName(firstName.trim());\r\n    const validLast = validateName(lastName.trim());\r\n    setValidFirstName(validFirst);\r\n    setValidLastName(validLast);\r\n\r\n    if (validFirst && validLast) {\r\n      createNewSheet();\r\n    }\r\n  }\r\n\r\n  function createNewSheet() {\r\n    const first = firstName.trim();\r\n    const last = lastName.trim();\r\n\r\n    const newUser: User = {\r\n      id: nanoid(),\r\n      firstName: first,\r\n      lastName: last,\r\n      initials: `${first.charAt(0)}${last.charAt(0)}`.toLocaleUpperCase(),\r\n      displayName: `${first} ${last}`,\r\n      email: \"\",\r\n    };\r\n    userDispatch({ type: \"updateCurUser\", user: newUser });\r\n    userDispatch({ type: \"setAuthStatus\", authenticated: true });\r\n    history.push({ pathname: \"/sheet/new\", state: { title: sheetTitle } });\r\n  }\r\n\r\n  function sheetNameStep() {\r\n    return (\r\n      <>\r\n        <div className='giantHeader'>Give your sheet a name:</div>\r\n        <TextField\r\n          className='giantTextField'\r\n          fullWidth\r\n          placeholder='Sheet name'\r\n          value={sheetTitle}\r\n          onChange={(e) => setSheetTitle(e.target.value)}\r\n          helperText={\r\n            validTitle\r\n              ? \"\"\r\n              : \"Title must be between 3-40 characters (select special characters are allowed).\"\r\n          }\r\n          inputProps={{\r\n            className: \"giantInput\",\r\n          }}\r\n          FormHelperTextProps={{\r\n            className: \"giantInputHelperText\",\r\n          }}\r\n        />\r\n        <FormControlLabel\r\n          className='termsAndConditions'\r\n          control={\r\n            <Checkbox\r\n              checked={agreeToTerms}\r\n              onClick={() => setAgreeToTerms(!agreeToTerms)}\r\n              color='primary'\r\n            />\r\n          }\r\n          label={\r\n            <>\r\n              I accept the SplitTheCost{\" \"}\r\n              <Link to='/tos' target='_blank'>\r\n                terms\r\n              </Link>\r\n              .\r\n            </>\r\n          }\r\n        />\r\n        <Button\r\n          className='continueButton'\r\n          disabled={!agreeToTerms}\r\n          onClick={handleTitleButton}\r\n        >\r\n          continue\r\n        </Button>\r\n      </>\r\n    );\r\n  }\r\n\r\n  function displayNameStep() {\r\n    return (\r\n      <>\r\n        <div className='giantHeader'>\r\n          Yup, we're basically done. What's your name?\r\n        </div>\r\n        <div>\r\n          <TextField\r\n            className='giantTextField halfWidthModalInput'\r\n            fullWidth\r\n            placeholder='First name'\r\n            value={firstName}\r\n            onChange={(e) => setFirstName(e.target.value)}\r\n            helperText={\r\n              validFirstName ? \"\" : \"Please enter a valid first name.\"\r\n            }\r\n            inputProps={{\r\n              className: \"giantInput\",\r\n            }}\r\n            FormHelperTextProps={{\r\n              className: \"giantInputHelperText\",\r\n            }}\r\n          />\r\n          <TextField\r\n            className='leftMarginLarge giantTextField halfWidthModalInput'\r\n            fullWidth\r\n            placeholder='Last name'\r\n            value={lastName}\r\n            onChange={(e) => setLastName(e.target.value)}\r\n            helperText={validLastName ? \"\" : \"Please enter a valid last name.\"}\r\n            inputProps={{\r\n              className: \"giantInput\",\r\n            }}\r\n            FormHelperTextProps={{\r\n              className: \"giantInputHelperText\",\r\n            }}\r\n          />\r\n        </div>\r\n        <div>\r\n          <Button\r\n            className='continueButton'\r\n            onClick={() => {\r\n              setStep(step - 1);\r\n            }}\r\n          >\r\n            go back\r\n          </Button>\r\n          <Button\r\n            className='leftMargin continueButton'\r\n            onClick={handleNameButton}\r\n          >\r\n            finish\r\n          </Button>\r\n        </div>\r\n      </>\r\n    );\r\n  }\r\n\r\n  function renderStep() {\r\n    if (step === CreateSheetStep.SheetName) return sheetNameStep();\r\n    if (step === CreateSheetStep.DisplayName) return displayNameStep();\r\n    return sheetNameStep();\r\n  }\r\n\r\n  return (\r\n    <motion.div\r\n      initial={{ x: 2000 }}\r\n      animate={{ x: 0 }}\r\n      transition={{ type: \"spring\", duration: 0.8 }}\r\n    >\r\n      <Grid className='createNewSheet' container spacing={0}>\r\n        <Grid item xs={1}></Grid>\r\n        <Grid className='createNewSheetItem' item xs={8}>\r\n          {renderStep()}\r\n        </Grid>\r\n      </Grid>\r\n      <div className='stepIndicator'>\r\n        <Link to='/'>\r\n          <IconButton size='small'>\r\n            <CloseRoundedIcon />\r\n          </IconButton>\r\n        </Link>\r\n        <span className='leftMarginSmall'>\r\n          Create a sheet (Step {step} of 2)\r\n        </span>\r\n      </div>\r\n    </motion.div>\r\n  );\r\n};\r\n","import * as React from \"react\";\r\nimport {\r\n  Button,\r\n  CircularProgress,\r\n  Dialog,\r\n  DialogActions,\r\n  DialogContent,\r\n  TextField,\r\n} from \"@material-ui/core\";\r\nimport { SheetContext } from \"../pages/SplitTheCost\";\r\nimport { useContext, useState } from \"react\";\r\nimport { UserChip } from \"../bits/UserChip\";\r\nimport { UserContext } from \"../../App\";\r\nimport { User } from \"../../models/models\";\r\nimport { ModalHeader } from \"./ModalHeader\";\r\nimport { handleKeyPress } from \"../../logic/logic\";\r\n\r\ninterface Props {\r\n  open: boolean;\r\n}\r\n\r\nexport const PasswordUserModal: React.FC<Props> = ({ open }) => {\r\n  const { sheetState } = useContext(SheetContext);\r\n  const { userState, userDispatch } = useContext(UserContext);\r\n\r\n  const [selectedUser, setSelectedUser] = useState<User>();\r\n\r\n  const [password, setPassword] = useState(\"\");\r\n  const [validPassword, setValidPassword] = useState(true);\r\n\r\n  function validatePassword() {\r\n    if (!password) {\r\n      setValidPassword(false);\r\n      return;\r\n    }\r\n\r\n    if (!sheetState.password) {\r\n      userDispatch({ type: \"setAuthStatus\", authenticated: true });\r\n      return;\r\n    }\r\n\r\n    const bcrypt = require(\"bcryptjs\");\r\n    bcrypt.compare(\r\n      password,\r\n      sheetState.password,\r\n      function (err: Error, res: boolean) {\r\n        if (!res) {\r\n          setValidPassword(false);\r\n          return;\r\n        }\r\n\r\n        userDispatch({ type: \"setAuthStatus\", authenticated: true });\r\n      }\r\n    );\r\n  }\r\n\r\n  function confirmUser() {\r\n    if (selectedUser) {\r\n      userDispatch({\r\n        type: \"updateCurUser\",\r\n        user: selectedUser!,\r\n      });\r\n    }\r\n  }\r\n\r\n  function handleEnter() {\r\n    if (!userState.authenticated) {\r\n      validatePassword();\r\n    } else {\r\n      confirmUser();\r\n    }\r\n  }\r\n\r\n  function renderPasswordPrompt(): JSX.Element {\r\n    return (\r\n      <>\r\n        <DialogContent>\r\n          <TextField\r\n            className='bottomMargin'\r\n            fullWidth\r\n            label='Password'\r\n            onChange={(e) => setPassword(e.target.value)}\r\n            error={!validPassword}\r\n            helperText={validPassword ? \"\" : \"This password is incorrect.\"}\r\n            InputProps={{\r\n              type: \"password\",\r\n            }}\r\n          />\r\n        </DialogContent>\r\n        <DialogActions className='modalActions'>\r\n          <Button\r\n            className='modalConfirmButton rightMarginSmall'\r\n            disabled={!password}\r\n            onClick={validatePassword}\r\n          >\r\n            Confirm\r\n          </Button>\r\n        </DialogActions>\r\n      </>\r\n    );\r\n  }\r\n\r\n  function renderUserSelection(): JSX.Element {\r\n    return (\r\n      <>\r\n        <DialogContent>\r\n          {!Object.keys(sheetState.users).length ? (\r\n            <div className='trueCenter'>\r\n              <CircularProgress />\r\n            </div>\r\n          ) : (\r\n            Object.entries(sheetState.users).map((pair) => {\r\n              const user = pair[1];\r\n              return (\r\n                <UserChip\r\n                  className={`bottomMargin rightMargin ${\r\n                    selectedUser?.id === user.id && \"selectedChip\"\r\n                  }`}\r\n                  user={user}\r\n                  userIdx={Object.keys(sheetState.users).indexOf(user.id)}\r\n                  onClick={setSelectedUser}\r\n                  key={user.id}\r\n                />\r\n              );\r\n            })\r\n          )}\r\n        </DialogContent>\r\n        <DialogActions className='modalActions'>\r\n          <Button\r\n            className='modalConfirmButton rightMarginSmall'\r\n            disabled={!selectedUser}\r\n            onClick={confirmUser}\r\n          >\r\n            Confirm\r\n          </Button>\r\n        </DialogActions>\r\n      </>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Dialog\r\n      fullWidth={userState.authenticated}\r\n      disableBackdropClick\r\n      maxWidth='sm'\r\n      open={open}\r\n      onKeyPress={(e) => handleKeyPress(e, \"enter\", handleEnter)}\r\n      PaperProps={{ className: \"modal\" }}\r\n    >\r\n      <ModalHeader\r\n        title={\r\n          userState.authenticated ? \"Who are You?\" : \"Enter Sheet Password\"\r\n        }\r\n      />\r\n      {userState.authenticated ? renderUserSelection() : renderPasswordPrompt()}\r\n    </Dialog>\r\n  );\r\n};\r\n","import React from \"react\";\r\n\r\nexport const ViewOnDesktop: React.FC = () => {\r\n  return (\r\n    <div className='errorPage'>\r\n      <span className='errorPageHeader'>\r\n        <b>coming soon...</b>\r\n      </span>\r\n      <span className='errorPageSubtitle'>\r\n        We're currently working on a mobile friendly version of splithecost - in\r\n        the meantime, please visit us on a computer!\r\n      </span>\r\n    </div>\r\n  );\r\n};\r\n","import React, { createContext, useContext, useEffect, useReducer } from \"react\";\r\nimport { SaveState, SheetState } from \"../../models/models\";\r\nimport { Entries } from \"../entries/Entries\";\r\nimport { Header } from \"../header/Header\";\r\nimport { UsersBar } from \"../users/UsersBar\";\r\nimport { SideDialog } from \"../dialog/SideDialog\";\r\nimport { AddItemFab } from \"../bits/AddItemFab\";\r\nimport { SheetAction, sheetReducer } from \"../../actions/sheetActions\";\r\nimport { UserContext } from \"../../App\";\r\nimport { db, sheetStateConverter } from \"../../firebase\";\r\nimport { useHistory, useLocation, useParams } from \"react-router-dom\";\r\nimport { PasswordUserModal } from \"../modals/PasswordUserModal\";\r\nimport { nanoid } from \"nanoid\";\r\nimport { ViewOnDesktop } from \"./ViewOnDesktop\";\r\nimport { useState } from \"react\";\r\n\r\nvar initialSheetState: SheetState = {\r\n  title: \"Loading Sheet...\",\r\n  timestamp: \"\",\r\n  lastAccessed: 0,\r\n  lastEdited: 0,\r\n  entries: [],\r\n  users: {},\r\n  numUsers: 0,\r\n  createdBy: \"\",\r\n  local: true,\r\n  readOnly: true,\r\n  id: \"\",\r\n};\r\n\r\nexport const SheetContext = createContext<{\r\n  sheetState: SheetState;\r\n  sheetDispatch: React.Dispatch<SheetAction>;\r\n}>({\r\n  sheetState: initialSheetState,\r\n  sheetDispatch: () => null,\r\n});\r\n\r\nexport const SplitTheCost: React.FC = () => {\r\n  const isMobile = window.innerWidth <= 1000;\r\n  const history = useHistory();\r\n  const location = useLocation<{ title: string }>();\r\n  const { sheetId } = useParams<{ sheetId: string }>();\r\n\r\n  const [sheetState, sheetDispatch] = useReducer(\r\n    sheetReducer,\r\n    initialSheetState\r\n  );\r\n  const { userState, userDispatch } = useContext(UserContext);\r\n\r\n  const [autosaveState, setAutosaveState] = useState(\r\n    sheetState.local ? SaveState.Unsaved : SaveState.Saved\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (!sheetId || sheetId === \"new\") {\r\n      generateNewSheetState();\r\n    } else {\r\n      fetchSheetState();\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    setAutosaveState(sheetState.local ? SaveState.Unsaved : SaveState.Saved);\r\n    const saveInterval = setInterval(() => {\r\n      autosaveSheet();\r\n    }, 10000);\r\n\r\n    return () => clearInterval(saveInterval);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [sheetState.local]);\r\n\r\n  async function autosaveSheet() {\r\n    if (!sheetState.local) {\r\n      sheetDispatch({\r\n        type: \"autosaveSheet\",\r\n        setAutosaveState: setAutosaveState,\r\n      });\r\n      await new Promise((r) => setTimeout(r, 1500));\r\n      setAutosaveState(SaveState.Saved);\r\n    }\r\n  }\r\n\r\n  function generateNewSheetState() {\r\n    if (!userState.curUser || !location.state.title) {\r\n      history.push(\"/create\");\r\n      return;\r\n    }\r\n\r\n    const newSheetState: SheetState = {\r\n      id: nanoid(10),\r\n      timestamp: new Date(Date.now()).toUTCString(),\r\n      lastAccessed: Date.now(),\r\n      lastEdited: Date.now(),\r\n      title: location.state.title,\r\n      entries: [],\r\n      users: { [userState.curUser.id]: userState.curUser },\r\n      numUsers: 1,\r\n      createdBy: userState.curUser.id,\r\n      local: true,\r\n      readOnly: false,\r\n    };\r\n\r\n    sheetDispatch({ type: \"updateSheetState\", sheetState: newSheetState });\r\n    sheetDispatch({ type: \"addEntry\", createdBy: userState.curUser.id });\r\n  }\r\n\r\n  async function fetchSheetState() {\r\n    const sheetSnapshot = await db\r\n      .collection(\"sheets\")\r\n      .withConverter(sheetStateConverter)\r\n      .doc(sheetId)\r\n      .get();\r\n    const fetchedSheetState = sheetSnapshot.data();\r\n    if (fetchedSheetState) {\r\n      sheetDispatch({\r\n        type: \"updateSheetState\",\r\n        sheetState: {\r\n          ...fetchedSheetState,\r\n          lastAccessed: Date.now(),\r\n          readOnly: false,\r\n        },\r\n      });\r\n      userDispatch({\r\n        type: \"setAuthStatus\",\r\n        authenticated: !fetchedSheetState.password,\r\n      });\r\n      return;\r\n    }\r\n\r\n    const customLinkSnapshot = await db\r\n      .collection(\"customLinks\")\r\n      .doc(sheetId)\r\n      .get();\r\n\r\n    const customLink = customLinkSnapshot.data();\r\n    if (customLink) {\r\n      const actualSheetId = customLink[\"sheetId\"];\r\n      const customSheetSnapshot = await db\r\n        .collection(\"sheets\")\r\n        .withConverter(sheetStateConverter)\r\n        .doc(actualSheetId)\r\n        .get();\r\n      const customFetchedSheetState = customSheetSnapshot.data();\r\n      if (customFetchedSheetState) {\r\n        sheetDispatch({\r\n          type: \"updateSheetState\",\r\n          sheetState: {\r\n            ...customFetchedSheetState,\r\n            lastAccessed: Date.now(),\r\n          },\r\n        });\r\n        userDispatch({\r\n          type: \"setAuthStatus\",\r\n          authenticated: !customFetchedSheetState.password,\r\n        });\r\n        return;\r\n      }\r\n    }\r\n\r\n    history.push({ pathname: \"/invalidsheet\", state: { sheetId: sheetId } });\r\n  }\r\n\r\n  function renderDeviceView(): JSX.Element {\r\n    if (isMobile) {\r\n      return <ViewOnDesktop />;\r\n    } else {\r\n      return (\r\n        <>\r\n          <Header saveState={autosaveState} />\r\n          <UsersBar />\r\n          <Entries />\r\n          {userState.authenticated && <SideDialog />}\r\n          {!sheetState.readOnly && userState.curUser && <AddItemFab />}\r\n          <PasswordUserModal open={!userState.curUser} />\r\n        </>\r\n      );\r\n    }\r\n  }\r\n\r\n  return (\r\n    <SheetContext.Provider\r\n      value={{ sheetState: sheetState, sheetDispatch: sheetDispatch }}\r\n    >\r\n      {renderDeviceView()}\r\n    </SheetContext.Provider>\r\n  );\r\n};\r\n","export default __webpack_public_path__ + \"static/media/homepage.d372b9ab.png\";","export default __webpack_public_path__ + \"static/media/blob.f540e9c0.svg\";","import React from \"react\";\r\nimport { Button, Grid } from \"@material-ui/core\";\r\nimport { Link } from \"react-router-dom\";\r\nimport homepage from \"../../assets/homepage.png\";\r\nimport blob from \"../../assets/blob.svg\";\r\nimport { ViewOnDesktop } from \"./ViewOnDesktop\";\r\n\r\nexport const HomePage: React.FC = () => {\r\n  const isMobile = window.innerWidth < 1000;\r\n\r\n  if (isMobile) {\r\n    return <ViewOnDesktop />;\r\n  } else {\r\n    return (\r\n      <>\r\n        <Grid className='homepage' container spacing={0} alignContent='center'>\r\n          <Grid item container xs={8} justify='center'>\r\n            <img id='homepageBlob' src={blob} alt='blob' />\r\n            <img id='homepageImg' src={homepage} alt='homepage' />\r\n          </Grid>\r\n          <Grid item container xs={4} alignItems='center' alignContent='center'>\r\n            <div id='homepageText'>\r\n              <span id='homepageTitle'>welcome to splitthecost.</span>\r\n              <span id='homepageSubtitle'>\r\n                shared expenses for trips/events made simple. no sign up\r\n                required!\r\n              </span>\r\n              <Link className='noTextDecoration' to='/create'>\r\n                <Button className='createNewButton'>create new sheet</Button>\r\n              </Link>\r\n            </div>\r\n          </Grid>\r\n        </Grid>\r\n      </>\r\n    );\r\n  }\r\n};\r\n","import { UserState, User } from \"../models/models\";\r\n\r\nexport type UpdateCurUserAction = {\r\n  type: \"updateCurUser\";\r\n  user: User;\r\n};\r\n\r\nexport type SetDarkModeAction = {\r\n  type: \"setDarkMode\";\r\n  darkMode: boolean;\r\n};\r\n\r\nexport type SetAuthStatusAction = {\r\n  type: \"setAuthStatus\";\r\n  authenticated: boolean;\r\n};\r\n\r\nexport type UserAction =\r\n  | UpdateCurUserAction\r\n  | SetDarkModeAction\r\n  | SetAuthStatusAction;\r\n\r\nexport function userReducer(state: UserState, action: UserAction) {\r\n  switch (action.type) {\r\n    case \"updateCurUser\":\r\n      return updateCurUser(state, action);\r\n    case \"setDarkMode\":\r\n      return setDarkMode(state, action);\r\n    case \"setAuthStatus\":\r\n      return setAuthStatus(state, action);\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\n// ----------------- APP USER ACTIONS -----------------\r\n\r\n// Update the current user.\r\nfunction updateCurUser(\r\n  state: UserState,\r\n  action: UpdateCurUserAction\r\n): UserState {\r\n  return { ...state, curUser: action.user };\r\n}\r\n\r\n// Remove an entry from the sheet.\r\nfunction setDarkMode(state: UserState, action: SetDarkModeAction): UserState {\r\n  return { ...state, darkMode: action.darkMode };\r\n}\r\n\r\n// Set the authentication status for the current sheet.\r\nfunction setAuthStatus(\r\n  state: UserState,\r\n  action: SetAuthStatusAction\r\n): UserState {\r\n  return { ...state, authenticated: action.authenticated };\r\n}\r\n","import { Button } from \"@material-ui/core\";\r\nimport React from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nexport const PageNotFound: React.FC = () => {\r\n  return (\r\n    <div className='errorPage'>\r\n      <span className='errorPageHeader'>\r\n        <b>404</b> - this page doesn't exist.\r\n      </span>\r\n\r\n      <Link className='noTextDecoration' to='/'>\r\n        <Button className='createNewButton'>home</Button>\r\n      </Link>\r\n    </div>\r\n  );\r\n};\r\n","import { Button } from \"@material-ui/core\";\r\nimport React from \"react\";\r\nimport { Link, useLocation } from \"react-router-dom\";\r\n\r\nexport const SheetNotFound: React.FC = () => {\r\n  const location = useLocation<{ sheetId: string }>();\r\n\r\n  return (\r\n    <div className='errorPage'>\r\n      <span className='errorPageHeader'>\r\n        sorry, we couldn't find a sheet with id \"\r\n        <b>{location.state?.sheetId}</b>\r\n        \".\r\n      </span>\r\n\r\n      <Link className='noTextDecoration' to='/create'>\r\n        <Button className='createNewButton'>create new sheet</Button>\r\n      </Link>\r\n    </div>\r\n  );\r\n};\r\n","import React from \"react\";\r\n\r\nexport const TermsOfService: React.FC = () => {\r\n  return (\r\n    <div id='tos'>\r\n      <h2>Terms of Service</h2>\r\n      <p>\r\n        SplitTheCost stores all data in <b>unencrypted plaintext</b> and is not\r\n        responsible for the loss or unauthorized release of any data. In other\r\n        words,{\" \"}\r\n        <b>don't use SplitTheCost for private or confidential information! </b>\r\n        SplitTheCost is not liable for any direct, indirect, incidental,\r\n        consequential, or special damages or losses resulting from authorized or\r\n        unauthorized use of or access to this platform.\r\n        <br />\r\n        <br />\r\n        That's about it! Have fun and enjoy to your heart's desire.\r\n      </p>\r\n    </div>\r\n  );\r\n};\r\n","import React, { createContext, useReducer } from \"react\";\r\nimport \"./main.css\";\r\nimport { SplitTheCost } from \"./components/pages/SplitTheCost\";\r\nimport { Route, HashRouter as Router, Switch } from \"react-router-dom\";\r\nimport { HomePage } from \"./components/pages/HomePage\";\r\nimport { UserState } from \"./models/models\";\r\nimport { UserAction, userReducer } from \"./actions/appUserActions\";\r\nimport { CreateNewSheet } from \"./components/pages/CreateNewSheet\";\r\nimport { PageNotFound } from \"./components/pages/PageNotFound\";\r\nimport { SheetNotFound } from \"./components/pages/SheetNotFound\";\r\nimport { TermsOfService } from \"./components/pages/TermsOfService\";\r\n\r\nconst initialUserState: UserState = {\r\n  curUser: undefined,\r\n  darkMode: false,\r\n  authenticated: false,\r\n};\r\n\r\nexport const UserContext = createContext<{\r\n  userState: UserState;\r\n  userDispatch: React.Dispatch<UserAction>;\r\n}>({\r\n  userState: initialUserState,\r\n  userDispatch: () => null,\r\n});\r\n\r\nfunction App() {\r\n  const [userState, userDispatch] = useReducer(userReducer, initialUserState);\r\n\r\n  return (\r\n    <Router>\r\n      <UserContext.Provider\r\n        value={{ userState: userState, userDispatch: userDispatch }}\r\n      >\r\n        <Switch>\r\n          <Route path='/' exact component={HomePage} />\r\n          <Route path='/create' exact component={CreateNewSheet} />\r\n          <Route path='/sheet/:sheetId' exact component={SplitTheCost} />\r\n          <Route path='/invalidsheet' exact component={SheetNotFound} />\r\n          <Route path='/tos' exact component={TermsOfService} />\r\n          <Route component={PageNotFound} />\r\n        </Switch>\r\n      </UserContext.Provider>\r\n    </Router>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./index.css\";\r\nimport App from \"./App\";\r\nimport reportWebVitals from \"./reportWebVitals\";\r\n\r\nReactDOM.render(\r\n  // <React.StrictMode>\r\n  <App />,\r\n  // </React.StrictMode>,\r\n  document.getElementById(\"root\")\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}